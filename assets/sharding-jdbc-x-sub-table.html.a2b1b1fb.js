import{_ as e}from"./_plugin-vue_export-helper.cdc0426e.js";import{o,c,a as n,b as t,d as p,e as s,r as i}from"./app.d912bdcd.js";const l={},u=p('<h1 id="springboot\u96C6\u6210shardingjdbc-sharding-jdbc\u7B80\u4ECB\u548C\u57FA\u4E8Emybatis\u7684\u5355\u5E93\u5206\u8868" tabindex="-1"><a class="header-anchor" href="#springboot\u96C6\u6210shardingjdbc-sharding-jdbc\u7B80\u4ECB\u548C\u57FA\u4E8Emybatis\u7684\u5355\u5E93\u5206\u8868" aria-hidden="true">#</a> SpringBoot\u96C6\u6210ShardingJDBC-Sharding-JDBC\u7B80\u4ECB\u548C\u57FA\u4E8EMyBatis\u7684\u5355\u5E93\u5206\u8868</h1><blockquote><p>\u672C\u6587\u4E3B\u8981\u4ECB\u7ECD\u5206\u8868\u5206\u5E93\uFF0C\u4EE5\u53CASpringBoot\u96C6\u6210\u57FA\u4E8EShardingJDBC+MyBatis\u7684\u5355\u5E93\u5206\u8868\u5B9E\u8DF5\u3002</p></blockquote><h2 id="_1-\u77E5\u8BC6\u51C6\u5907" tabindex="-1"><a class="header-anchor" href="#_1-\u77E5\u8BC6\u51C6\u5907" aria-hidden="true">#</a> 1. \u77E5\u8BC6\u51C6\u5907</h2><blockquote><p>\u4E3B\u8981\u7406\u89E3\u5206\u8868\u5206\u5E93\uFF0CSharding-JDBC\u8981\u89E3\u51B3\u4EC0\u4E48\u95EE\u9898\uFF0CSharding-JDBC\u53CAShardingSphere\u7684\u5173\u7CFB\u7B49\u3002</p></blockquote><h3 id="_1-1-\u4E3A\u4EC0\u4E48\u8981\u5206\u8868\u5206\u5E93" tabindex="-1"><a class="header-anchor" href="#_1-1-\u4E3A\u4EC0\u4E48\u8981\u5206\u8868\u5206\u5E93" aria-hidden="true">#</a> 1.1 \u4E3A\u4EC0\u4E48\u8981\u5206\u8868\u5206\u5E93\uFF1F</h3>',5),r={href:"https://pdai.tech/md/db/sql-mysql/sql-mysql-devide.html",target:"_blank",rel:"noopener noreferrer"},k=s("MySQL - \u5206\u8868\u5206\u5E93"),d=p(`<h3 id="_1-2-\u4EC0\u4E48\u662Fsharding-jdbc" tabindex="-1"><a class="header-anchor" href="#_1-2-\u4EC0\u4E48\u662Fsharding-jdbc" aria-hidden="true">#</a> 1.2 \u4EC0\u4E48\u662FSharding-JDBC\uFF1F</h3><blockquote><p>\u6765\u81EAShardingSphere\u5B98\u7F51</p></blockquote><p>Sharding-JDBC\u662FShardingSphere\u7684\u7B2C\u4E00\u4E2A\u4EA7\u54C1\uFF0C\u4E5F\u662FShardingSphere\u7684\u524D\u8EAB\u3002 \u5B83\u5B9A\u4F4D\u4E3A\u8F7B\u91CF\u7EA7Java\u6846\u67B6\uFF0C\u5728Java\u7684JDBC\u5C42\u63D0\u4F9B\u7684\u989D\u5916\u670D\u52A1\u3002\u5B83\u4F7F\u7528\u5BA2\u6237\u7AEF\u76F4\u8FDE\u6570\u636E\u5E93\uFF0C\u4EE5jar\u5305\u5F62\u5F0F\u63D0\u4F9B\u670D\u52A1\uFF0C\u65E0\u9700\u989D\u5916\u90E8\u7F72\u548C\u4F9D\u8D56\uFF0C\u53EF\u7406\u89E3\u4E3A\u589E\u5F3A\u7248\u7684JDBC\u9A71\u52A8\uFF0C\u5B8C\u5168\u517C\u5BB9JDBC\u548C\u5404\u79CDORM\u6846\u67B6\u3002</p><ul><li>\u9002\u7528\u4E8E\u4EFB\u4F55\u57FA\u4E8EJava\u7684ORM\u6846\u67B6\uFF0C\u5982\uFF1AJPA, Hibernate, Mybatis, Spring JDBC Template\u6216\u76F4\u63A5\u4F7F\u7528JDBC\u3002</li><li>\u57FA\u4E8E\u4EFB\u4F55\u7B2C\u4E09\u65B9\u7684\u6570\u636E\u5E93\u8FDE\u63A5\u6C60\uFF0C\u5982\uFF1ADBCP, C3P0, BoneCP, Druid, HikariCP\u7B49\u3002</li><li>\u652F\u6301\u4EFB\u610F\u5B9E\u73B0JDBC\u89C4\u8303\u7684\u6570\u636E\u5E93\u3002\u76EE\u524D\u652F\u6301MySQL\uFF0COracle\uFF0CSQLServer\u548CPostgreSQL\u3002</li></ul><p><img src="https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/image-20220717200857244.png" alt="image-20220717200857244" loading="lazy"></p><h3 id="_1-3-\u548Cshardingsphere\u662F\u4EC0\u4E48\u5173\u7CFB" tabindex="-1"><a class="header-anchor" href="#_1-3-\u548Cshardingsphere\u662F\u4EC0\u4E48\u5173\u7CFB" aria-hidden="true">#</a> 1.3 \u548CShardingSphere\u662F\u4EC0\u4E48\u5173\u7CFB\uFF1F</h3><blockquote><p>\u6765\u81EAShardingSphere\u5B98\u7F51</p></blockquote><p>ShardingSphere\u662F\u4E00\u5957\u5F00\u6E90\u7684\u5206\u5E03\u5F0F\u6570\u636E\u5E93\u4E2D\u95F4\u4EF6\u89E3\u51B3\u65B9\u6848\u7EC4\u6210\u7684\u751F\u6001\u5708\uFF0C\u5B83\u7531Sharding-JDBC\u3001Sharding-Proxy\u548CSharding-Sidecar\uFF08\u8BA1\u5212\u4E2D\uFF09\u8FD93\u6B3E\u76F8\u4E92\u72EC\u7ACB\u7684\u4EA7\u54C1\u7EC4\u6210\u3002 \u4ED6\u4EEC\u5747\u63D0\u4F9B\u6807\u51C6\u5316\u7684\u6570\u636E\u5206\u7247\u3001\u5206\u5E03\u5F0F\u4E8B\u52A1\u548C\u6570\u636E\u5E93\u6CBB\u7406\u529F\u80FD\uFF0C\u53EF\u9002\u7528\u4E8E\u5982Java\u540C\u6784\u3001\u5F02\u6784\u8BED\u8A00\u3001\u5BB9\u5668\u3001\u4E91\u539F\u751F\u7B49\u5404\u79CD\u591A\u6837\u5316\u7684\u5E94\u7528\u573A\u666F\u3002</p><p>ShardingSphere\u5B9A\u4F4D\u4E3A\u5173\u7CFB\u578B\u6570\u636E\u5E93\u4E2D\u95F4\u4EF6\uFF0C\u65E8\u5728\u5145\u5206\u5408\u7406\u5730\u5728\u5206\u5E03\u5F0F\u7684\u573A\u666F\u4E0B\u5229\u7528\u5173\u7CFB\u578B\u6570\u636E\u5E93\u7684\u8BA1\u7B97\u548C\u5B58\u50A8\u80FD\u529B\uFF0C\u800C\u5E76\u975E\u5B9E\u73B0\u4E00\u4E2A\u5168\u65B0\u7684\u5173\u7CFB\u578B\u6570\u636E\u5E93\u3002 \u5B83\u4E0ENoSQL\u548CNewSQL\u662F\u5E76\u5B58\u800C\u975E\u4E92\u65A5\u7684\u5173\u7CFB\u3002NoSQL\u548CNewSQL\u4F5C\u4E3A\u65B0\u6280\u672F\u63A2\u7D22\u7684\u524D\u6CBF\uFF0C\u653E\u773C\u672A\u6765\uFF0C\u62E5\u62B1\u53D8\u5316\uFF0C\u662F\u975E\u5E38\u503C\u5F97\u63A8\u8350\u7684\u3002\u53CD\u4E4B\uFF0C\u4E5F\u53EF\u4EE5\u7528\u53E6\u4E00\u79CD\u601D\u8DEF\u770B\u5F85\u95EE\u9898\uFF0C\u653E\u773C\u672A\u6765\uFF0C\u5173\u6CE8\u4E0D\u53D8\u7684\u4E1C\u897F\uFF0C\u8FDB\u800C\u6293\u4F4F\u4E8B\u7269\u672C\u8D28\u3002 \u5173\u7CFB\u578B\u6570\u636E\u5E93\u5F53\u4ECA\u4F9D\u7136\u5360\u6709\u5DE8\u5927\u5E02\u573A\uFF0C\u662F\u5404\u4E2A\u516C\u53F8\u6838\u5FC3\u4E1A\u52A1\u7684\u57FA\u77F3\uFF0C\u672A\u6765\u4E5F\u96BE\u4E8E\u64BC\u52A8\uFF0C\u6211\u4EEC\u76EE\u524D\u9636\u6BB5\u66F4\u52A0\u5173\u6CE8\u5728\u539F\u6709\u57FA\u7840\u4E0A\u7684\u589E\u91CF\uFF0C\u800C\u975E\u98A0\u8986\u3002</p><p><img src="https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/image-20220717201030865.png" alt="image-20220717201030865" loading="lazy"></p><p>\u5BF9\u5E94\u7684\u7248\u672C\u529F\u80FD</p><p><img src="https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/image-20220717201046865.png" alt="image-20220717201046865" loading="lazy"></p><h2 id="_2-\u7B80\u5355\u793A\u4F8B" tabindex="-1"><a class="header-anchor" href="#_2-\u7B80\u5355\u793A\u4F8B" aria-hidden="true">#</a> 2. \u7B80\u5355\u793A\u4F8B</h2><blockquote><p>\u8FD9\u91CC\u4E3B\u8981\u4ECB\u7ECDSpringBoot\u96C6\u6210\u57FA\u4E8EShardingJDBC\u7684<strong>\u5355\u5E93\u5206\u8868</strong>\u5B9E\u8DF5\uFF0C\u4E3B\u8981\u627F\u63A5\u4E4B\u524D\u7684\u76F8\u5173\u6587\u7AE0\u5728MyBatis\u7684\u6CE8\u89E3\u65B9\u5F0F\u7684\u57FA\u7840\u4E0A\u5B9E\u73B0\u7684\u3002</p></blockquote><h3 id="_2-1-\u51C6\u5907db\u548C\u4F9D\u8D56\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#_2-1-\u51C6\u5907db\u548C\u4F9D\u8D56\u914D\u7F6E" aria-hidden="true">#</a> 2.1 \u51C6\u5907DB\u548C\u4F9D\u8D56\u914D\u7F6E</h3><p>\u521B\u5EFAMySQL\u7684schema test_db_sharding, \u5BFC\u5165SQL \u6587\u4EF6\u5982\u4E0B</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- MySQL dump 10.13  Distrib 8.0.28, for macos11 (x86_64)</span>
<span class="token comment">--</span>
<span class="token comment">-- Host: localhost    Database: test_db_sharding</span>
<span class="token comment">-- ------------------------------------------------------</span>
<span class="token comment">-- Server version	8.0.22</span>

<span class="token comment">/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */</span><span class="token punctuation">;</span>
<span class="token comment">/*!50503 SET NAMES utf8 */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40103 SET TIME_ZONE=&#39;+00:00&#39; */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE=&#39;NO_AUTO_VALUE_ON_ZERO&#39; */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */</span><span class="token punctuation">;</span>

<span class="token comment">/*!40101 SET SQL_MODE=@OLD_SQL_MODE */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */</span><span class="token punctuation">;</span>

<span class="token comment">-- Dump completed on 2022-04-05 19:56:52</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5F15\u5165maven\u4F9D\u8D56, \u5305\u542Bmysql\u9A71\u52A8\uFF0Cmybatis\u548CpageHelper, \u4EE5\u53CAsharding-jdbc\u7684\u4F9D\u8D56\u3002</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>8.0.28<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.mybatis.spring.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.1.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.github.pagehelper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>pagehelper-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.2.10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.shardingsphere<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>sharding-jdbc-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.1.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u589E\u52A0yml\u914D\u7F6E</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">shardingsphere</span><span class="token punctuation">:</span>
    <span class="token key atrule">datasource</span><span class="token punctuation">:</span>
      <span class="token key atrule">names</span><span class="token punctuation">:</span> ds
      <span class="token key atrule">ds</span><span class="token punctuation">:</span>
        <span class="token key atrule">type</span><span class="token punctuation">:</span> com.zaxxer.hikari.HikariDataSource
        <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.cj.jdbc.Driver
        <span class="token key atrule">jdbc-url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>3306/test_db_sharding<span class="token punctuation">?</span>allowPublicKeyRetrieval=true<span class="token important">&amp;useSSL=false&amp;autoReconnect=true&amp;characterEncoding=utf8</span>
        <span class="token key atrule">username</span><span class="token punctuation">:</span> test
        <span class="token key atrule">password</span><span class="token punctuation">:</span> bfXa4Pt2lUUScy8jakXf
    <span class="token key atrule">sharding</span><span class="token punctuation">:</span>
      <span class="token key atrule">tables</span><span class="token punctuation">:</span>
        <span class="token key atrule">tb_user</span><span class="token punctuation">:</span>
          <span class="token key atrule">actual-data-nodes</span><span class="token punctuation">:</span> ds.tb_user_$<span class="token punctuation">-</span><span class="token punctuation">&gt;</span><span class="token punctuation">{</span>0..1<span class="token punctuation">}</span>
          <span class="token key atrule">table-strategy</span><span class="token punctuation">:</span>
            <span class="token key atrule">inline</span><span class="token punctuation">:</span>
              <span class="token key atrule">sharding-column</span><span class="token punctuation">:</span> id
              <span class="token key atrule">algorithm-expression</span><span class="token punctuation">:</span> tb_user_$<span class="token punctuation">-</span><span class="token punctuation">&gt;</span><span class="token punctuation">{</span>id % 2<span class="token punctuation">}</span>
          <span class="token key atrule">key-generator</span><span class="token punctuation">:</span>
            <span class="token key atrule">column</span><span class="token punctuation">:</span> id
            <span class="token key atrule">type</span><span class="token punctuation">:</span> SNOWFLAKE
            <span class="token key atrule">props</span><span class="token punctuation">:</span>
              <span class="token key atrule">worker</span><span class="token punctuation">:</span>
                <span class="token key atrule">id</span><span class="token punctuation">:</span> <span class="token number">123</span>
      <span class="token key atrule">binding-tables</span><span class="token punctuation">:</span> tb_user
      <span class="token key atrule">broadcast-tables</span><span class="token punctuation">:</span> t_address
<span class="token key atrule">mybatis</span><span class="token punctuation">:</span>
  <span class="token key atrule">type-aliases-package</span><span class="token punctuation">:</span> tech.pdai.springboot.shardingjdbc.mybatis.tables.entity
  <span class="token key atrule">configuration</span><span class="token punctuation">:</span>
    <span class="token key atrule">cache-enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">use-generated-keys</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">default-executor-type</span><span class="token punctuation">:</span> REUSE
    <span class="token key atrule">use-actual-param-name</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-2-dao" tabindex="-1"><a class="header-anchor" href="#_2-2-dao" aria-hidden="true">#</a> 2.2 DAO</h3><p>mapper/dao</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">tech<span class="token punctuation">.</span>pdai<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span>shardingjdbc<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>tables<span class="token punctuation">.</span>dao</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">tech<span class="token punctuation">.</span>pdai<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span>shardingjdbc<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>tables<span class="token punctuation">.</span>dao<span class="token punctuation">.</span>provider<span class="token punctuation">.</span></span><span class="token class-name">UserDaoProvider</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">tech<span class="token punctuation">.</span>pdai<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span>shardingjdbc<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>tables<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">User</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">tech<span class="token punctuation">.</span>pdai<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span>shardingjdbc<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>tables<span class="token punctuation">.</span>entity<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">UserQueryBean</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> pdai
 */</span>
<span class="token annotation punctuation">@Mapper</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IUserDao</span> <span class="token punctuation">{</span>

    <span class="token class-name">String</span> <span class="token constant">SELECT_USER_SQL</span> <span class="token operator">=</span> <span class="token string">&quot;select u.id, u.password, u.user_name, u.email, u.phone_number, u.description, u.create_time, u.update_time from tb_user u&quot;</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Results</span><span class="token punctuation">(</span>
            id <span class="token operator">=</span> <span class="token string">&quot;UserResult&quot;</span><span class="token punctuation">,</span>
            value <span class="token operator">=</span> <span class="token punctuation">{</span>
                    <span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>property <span class="token operator">=</span> <span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span> column <span class="token operator">=</span> <span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>property <span class="token operator">=</span> <span class="token string">&quot;userName&quot;</span><span class="token punctuation">,</span> column <span class="token operator">=</span> <span class="token string">&quot;user_name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>property <span class="token operator">=</span> <span class="token string">&quot;password&quot;</span><span class="token punctuation">,</span> column <span class="token operator">=</span> <span class="token string">&quot;password&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>property <span class="token operator">=</span> <span class="token string">&quot;email&quot;</span><span class="token punctuation">,</span> column <span class="token operator">=</span> <span class="token string">&quot;email&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>property <span class="token operator">=</span> <span class="token string">&quot;phoneNumber&quot;</span><span class="token punctuation">,</span> column <span class="token operator">=</span> <span class="token string">&quot;phone_number&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>property <span class="token operator">=</span> <span class="token string">&quot;description&quot;</span><span class="token punctuation">,</span> column <span class="token operator">=</span> <span class="token string">&quot;description&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>property <span class="token operator">=</span> <span class="token string">&quot;createTime&quot;</span><span class="token punctuation">,</span> column <span class="token operator">=</span> <span class="token string">&quot;create_time&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>property <span class="token operator">=</span> <span class="token string">&quot;updateTime&quot;</span><span class="token punctuation">,</span> column <span class="token operator">=</span> <span class="token string">&quot;update_time&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token constant">SELECT_USER_SQL</span><span class="token punctuation">,</span> <span class="token string">&quot; where id = #{id}&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token class-name">User</span> <span class="token function">findById</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ResultMap</span><span class="token punctuation">(</span><span class="token string">&quot;UserResult&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token constant">SELECT_USER_SQL</span><span class="token punctuation">)</span>
    <span class="token class-name">User</span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ResultMap</span><span class="token punctuation">(</span><span class="token string">&quot;UserResult&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;&lt;script&gt; &quot;</span><span class="token punctuation">,</span> <span class="token constant">SELECT_USER_SQL</span><span class="token punctuation">,</span> <span class="token string">&quot; where u.id != 0\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;\\t\\t&lt;if test=\\&quot;userName != null and userName != &#39;&#39;\\&quot;&gt;\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;AND u.user_name like concat(&#39;%&#39;, #{user_name}, &#39;%&#39;)\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;\\t\\t&lt;/if&gt;\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;\\t\\t&lt;if test=\\&quot;description != null and description != &#39;&#39;\\&quot;&gt;\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;AND u.description like concat(&#39;%&#39;, #{description}, &#39;%&#39;)\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;\\t\\t&lt;/if&gt;\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;\\t\\t&lt;if test=\\&quot;phoneNumber != null and phoneNumber != &#39;&#39;\\&quot;&gt;\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;AND u.phone_number like concat(&#39;%&#39;, #{phoneNumber}, &#39;%&#39;)\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;\\t\\t&lt;/if&gt;\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;\\t\\t&lt;if test=\\&quot;email != null and email != &#39;&#39;\\&quot;&gt;\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;AND u.email like concat(&#39;%&#39;, #{email}, &#39;%&#39;)\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;\\t\\t&lt;/if&gt;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot; &lt;/script&gt;&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">findList</span><span class="token punctuation">(</span><span class="token class-name">UserQueryBean</span> userQueryBean<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Delete</span><span class="token punctuation">(</span><span class="token string">&quot;delete from tb_user where id = #{id}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">int</span> <span class="token function">deleteById</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Delete</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;&lt;script&gt; &quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;delete from tb_user where id in\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;&lt;foreach collection=\\&quot;array\\&quot; item=\\&quot;id\\&quot; open=\\&quot;(\\&quot; separator=\\&quot;,\\&quot; close=\\&quot;)\\&quot;&gt;\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;#{id}\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;&lt;/foreach&gt;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot; &lt;/script&gt;&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">int</span> <span class="token function">deleteByIds</span><span class="token punctuation">(</span><span class="token class-name">Long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ids<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Update</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;&lt;script&gt; &quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;update tb_user\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot; &lt;set&gt;\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot; &lt;if test=\\&quot;userName != null and userName != &#39;&#39;\\&quot;&gt;user_name = #{userName},&lt;/if&gt;\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot; &lt;if test=\\&quot;email != null and email != &#39;&#39;\\&quot;&gt;email = #{email},&lt;/if&gt;\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot; &lt;if test=\\&quot;phoneNumber != null and phoneNumber != &#39;&#39;\\&quot;&gt;phone_number = #{phoneNumber},&lt;/if&gt;\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot; &lt;if test=\\&quot;description != null and description != &#39;&#39;\\&quot;&gt;description = #{description},&lt;/if&gt;\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot; update_time = sysdate()\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot; &lt;/set&gt;\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot; where id = #{id}&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot; &lt;/script&gt;&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">int</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;&lt;script&gt; &quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;insert into tb_user(\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot; &lt;if test=\\&quot;userName != null and userName != &#39;&#39;\\&quot;&gt;user_name,&lt;/if&gt;\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot; &lt;if test=\\&quot;password != null and password != &#39;&#39;\\&quot;&gt;password,&lt;/if&gt;\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot; &lt;if test=\\&quot;email != null and email != &#39;&#39;\\&quot;&gt;email,&lt;/if&gt;\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot; &lt;if test=\\&quot;phoneNumber != null and phoneNumber != &#39;&#39;\\&quot;&gt;phone_number,&lt;/if&gt;\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot; &lt;if test=\\&quot;description != null and description != &#39;&#39;\\&quot;&gt;description,&lt;/if&gt;\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot; create_time,\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot; update_time\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot; )values(\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot; &lt;if test=\\&quot;userName != null and userName != &#39;&#39;\\&quot;&gt;#{userName},&lt;/if&gt;\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot; &lt;if test=\\&quot;password != null and password != &#39;&#39;\\&quot;&gt;#{password},&lt;/if&gt;\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot; &lt;if test=\\&quot;email != null and email != &#39;&#39;\\&quot;&gt;#{email},&lt;/if&gt;\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot; &lt;if test=\\&quot;phoneNumber != null and phoneNumber != &#39;&#39;\\&quot;&gt;#{phoneNumber},&lt;/if&gt;\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot; &lt;if test=\\&quot;description != null and description != &#39;&#39;\\&quot;&gt;#{description},&lt;/if&gt;\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot; sysdate(),\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot; sysdate()\\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot; )&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot; &lt;/script&gt;&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Options</span><span class="token punctuation">(</span>useGeneratedKeys <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span> keyProperty <span class="token operator">=</span> <span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">int</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Update</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;update tb_user set password = #{password}, update_time = sysdate()&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot; where id = #{id}&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">int</span> <span class="token function">updatePassword</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@ResultMap</span><span class="token punctuation">(</span><span class="token string">&quot;UserResult&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@SelectProvider</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">UserDaoProvider</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token string">&quot;findById&quot;</span><span class="token punctuation">)</span>
    <span class="token class-name">User</span> <span class="token function">findById2</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-3-service" tabindex="-1"><a class="header-anchor" href="#_2-3-service" aria-hidden="true">#</a> 2.3 Service</h3><p>user service \u63A5\u53E3</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">tech<span class="token punctuation">.</span>pdai<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span>shardingjdbc<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>tables<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">tech<span class="token punctuation">.</span>pdai<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span>shardingjdbc<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>tables<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">User</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">tech<span class="token punctuation">.</span>pdai<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span>shardingjdbc<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>tables<span class="token punctuation">.</span>entity<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">UserQueryBean</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> pdai
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IUserService</span> <span class="token punctuation">{</span>

    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">findList</span><span class="token punctuation">(</span><span class="token class-name">UserQueryBean</span> userQueryBean<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">User</span> <span class="token function">findById</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> <span class="token function">deleteById</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> <span class="token function">deleteByIds</span><span class="token punctuation">(</span><span class="token class-name">Long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ids<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> <span class="token function">updatePassword</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">User</span> <span class="token function">findById2</span><span class="token punctuation">(</span><span class="token class-name">Long</span> userId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>service\u5B9E\u73B0\u7C7B</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">tech<span class="token punctuation">.</span>pdai<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span>shardingjdbc<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>tables<span class="token punctuation">.</span>service<span class="token punctuation">.</span>impl</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">tech<span class="token punctuation">.</span>pdai<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span>shardingjdbc<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>tables<span class="token punctuation">.</span>dao<span class="token punctuation">.</span></span><span class="token class-name">IUserDao</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">tech<span class="token punctuation">.</span>pdai<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span>shardingjdbc<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>tables<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">User</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">tech<span class="token punctuation">.</span>pdai<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span>shardingjdbc<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>tables<span class="token punctuation">.</span>entity<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">UserQueryBean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">tech<span class="token punctuation">.</span>pdai<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span>shardingjdbc<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>tables<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">IUserService</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserDoServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">IUserService</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * userDao.
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">IUserDao</span> userDao<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * init.
     *
     * <span class="token keyword">@param</span> <span class="token parameter">userDao2</span> user dao
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">UserDoServiceImpl</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">IUserDao</span> userDao2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>userDao <span class="token operator">=</span> userDao2<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">findList</span><span class="token punctuation">(</span><span class="token class-name">UserQueryBean</span> userQueryBean<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> userDao<span class="token punctuation">.</span><span class="token function">findList</span><span class="token punctuation">(</span>userQueryBean<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">findById</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> userDao<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">deleteById</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> userDao<span class="token punctuation">.</span><span class="token function">deleteById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">deleteByIds</span><span class="token punctuation">(</span><span class="token class-name">Long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ids<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> userDao<span class="token punctuation">.</span><span class="token function">deleteByIds</span><span class="token punctuation">(</span>ids<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> userDao<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> userDao<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">updatePassword</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> userDao<span class="token punctuation">.</span><span class="token function">updatePassword</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">findById2</span><span class="token punctuation">(</span><span class="token class-name">Long</span> userId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> userDao<span class="token punctuation">.</span><span class="token function">findById2</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-4-controller" tabindex="-1"><a class="header-anchor" href="#_2-4-controller" aria-hidden="true">#</a> 2.4 Controller</h3><p>user controller</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">tech<span class="token punctuation">.</span>pdai<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span>shardingjdbc<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>tables<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>


<span class="token keyword">import</span> <span class="token import"><span class="token namespace">tech<span class="token punctuation">.</span>pdai<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span>shardingjdbc<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>tables<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">User</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">tech<span class="token punctuation">.</span>pdai<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span>shardingjdbc<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>tables<span class="token punctuation">.</span>entity<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">UserQueryBean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">tech<span class="token punctuation">.</span>pdai<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span>shardingjdbc<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>tables<span class="token punctuation">.</span>entity<span class="token punctuation">.</span>response<span class="token punctuation">.</span></span><span class="token class-name">ResponseResult</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>swagger<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">ApiOperation</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">tech<span class="token punctuation">.</span>pdai<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span>shardingjdbc<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>tables<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">IUserService</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> pdai
 */</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/user&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">IUserService</span> userService<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * <span class="token keyword">@param</span> <span class="token parameter">user</span> user param
     * <span class="token keyword">@return</span> user
     */</span>
    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;Add/Edit User&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;add&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            userService<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            userService<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token class-name">ResponseResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>userService<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * <span class="token keyword">@return</span> user list
     */</span>
    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;Query User One&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;edit/{userId}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">edit</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;userId&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> userId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">ResponseResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>userService<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * <span class="token keyword">@return</span> user list 2
     */</span>
    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;Query User One 2&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;edit2/{userId}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">edit2</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;userId&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> userId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">ResponseResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>userService<span class="token punctuation">.</span><span class="token function">findById2</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * <span class="token keyword">@return</span> user list
     */</span>
    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;Query User List&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;list&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">list</span><span class="token punctuation">(</span><span class="token class-name">UserQueryBean</span> userQueryBean<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">ResponseResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>userService<span class="token punctuation">.</span><span class="token function">findList</span><span class="token punctuation">(</span>userQueryBean<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;Delete by id&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;delete&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token class-name">Long</span> userId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">ResponseResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>userService<span class="token punctuation">.</span><span class="token function">deleteById</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-5-\u7B80\u5355\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#_2-5-\u7B80\u5355\u6D4B\u8BD5" aria-hidden="true">#</a> 2.5 \u7B80\u5355\u6D4B\u8BD5</h3><p>\u8BBF\u95EE\u9875\u9762\uFF1A</p>`,34),v={href:"http://localhost:8080/doc.html",target:"_blank",rel:"noopener noreferrer"},m=s("http://localhost:8080/doc.html"),b=p(`<p>\u63D2\u5165\u6570\u636E</p><p><img src="https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/image-20220717201509884.png" alt="image-20220717201509884" loading="lazy"></p><h2 id="_3-\u8FDB\u4E00\u6B65\u7406\u89E3" tabindex="-1"><a class="header-anchor" href="#_3-\u8FDB\u4E00\u6B65\u7406\u89E3" aria-hidden="true">#</a> 3. \u8FDB\u4E00\u6B65\u7406\u89E3</h2><blockquote><p>\u901A\u8FC7\u51E0\u4E2A\u95EE\u9898\u8FDB\u4E00\u6B65\u7406\u89E3\u3002</p></blockquote><h3 id="_3-1-\u51E0\u4E2A\u5E38\u89C1\u7684\u9519\u8BEF" tabindex="-1"><a class="header-anchor" href="#_3-1-\u51E0\u4E2A\u5E38\u89C1\u7684\u9519\u8BEF" aria-hidden="true">#</a> 3.1 \u51E0\u4E2A\u5E38\u89C1\u7684\u9519\u8BEF</h3><p>\u5728\u4F7F\u7528sharding-jdbc\u4EE5\u53CA\u548C\u5176\u5B83\u7EC4\u4EF6\u96C6\u6210\uFF08\u6BD4\u5982mybatis\uFF0Cmybatis-plus\uFF0Cdruid\u7B49\uFF09\u9047\u5230\u7684\u95EE\u9898\u4F1A\u6BD4\u8F83\u591A\uFF0C\u8FD9\u91CC\u4E3E\u51E0\u4E2A\u5178\u578B\u7684\u62A5\u9519\u4F8B\u5B50\uFF1A</p><ul><li><strong>Sharding value must implements Comparable</strong>.</li></ul><p>\u7531\u4E8E\u6570\u636E\u5206\u7247\uFF0C\u539F\u6709\u7684\u6570\u636E\u5E93\u81EA\u52A8\u589E\u957FID\u8BBE\u7F6E\u4EE5\u53CAORM\u5C42\u76F8\u5173\u914D\u7F6E\u7B56\u7565\u90FD\u4E0D\u80FD\u518D\u4F7F\u7528\uFF0C\u6240\u4EE5\u9700\u8981\u53D6\u6D88\u6570\u636E\u5E93\u81EA\u589E\u957F\u4EE5\u53CAORM\u5C42@ID\u6216\u8005@TableID\u7B49\u6CE8\u89E3\u3002</p><p>key-generator \u7531\u5982\u4E0B\u914D\u7F6E\u66FF\u4EE3</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code>  <span class="token key atrule">key-generator</span><span class="token punctuation">:</span>
    <span class="token key atrule">column</span><span class="token punctuation">:</span> id
    <span class="token key atrule">type</span><span class="token punctuation">:</span> SNOWFLAKE
    <span class="token key atrule">props</span><span class="token punctuation">:</span>
      <span class="token key atrule">worker</span><span class="token punctuation">:</span>
        <span class="token key atrule">id</span><span class="token punctuation">:</span> <span class="token number">123</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>Data truncation: Out of range value for column &#39;id&#39;</strong></li></ul>`,11),g=s("\u6B63\u662F\u7531\u4E8E\u4E0A\u8FF0SNOWFLAKE\u96EA\u82B1\u7B97\u6CD5\uFF08\u76F8\u5173\u6587\u7AE0\u8BF7\u53C2\u8003"),h={href:"https://pdai.tech/md/algorithm/alg-domain-id-snowflake.html",target:"_blank",rel:"noopener noreferrer"},y=s("\u5206\u5E03\u5F0F\u7B97\u6CD5 - Snowflake\u7B97\u6CD5"),q=s("\uFF09\uFF0C \u76F8\u5173ID\u662F64\u4F4D\u7684long\u7C7B\u578B\uFF0C\u6240\u4EE5\u9700\u8981\u8BBE\u7F6E\u76F8\u5173\u5B57\u6BB5\u4F4DBIGINT\u7C7B\u578B\u3002"),_=n("ul",null,[n("li",null,[n("strong",null,"java.sql.SQLFeatureNotSupportedException: getObject with type")])],-1),f=n("p",null,"\u8FD9\u662F\u4E0EMybatis\u7B49\u5176\u5B83\u6846\u67B6\u96C6\u6210\u7684\u4E00\u4E2Abug\uFF1ALocalDateTimeTypeHandler\u672A\u80FD\u8FDB\u884C\u5173\u8054\u5904\u7406\uFF1B \u5B98\u65B9\u57285.0\u7248\u672C\u4FEE\u590D\u4E86\u8FD9\u4E2A\u95EE\u9898\uFF0C\u53EA\u662F\u5F53\u524Dsharding-jdbc-spring-boot-starter\u7684\u7248\u672C\u4F9D\u7136\u662F4.1.1\uFF0C\u6240\u4EE5\u4F9D\u7136\u6709\u95EE\u9898\u3002\u8FD9\u4E5F\u51F8\u663E\u51FA\u4E86\u56FD\u4EA7\u5F00\u6E90\uFF08\u5373\u4FBF\u662F\u8FDB\u5165Apache\u4E14\u5728\u4E0D\u65AD\u5B8C\u5584\uFF09\u6574\u4F53\u4E0A\u8FD8\u6709\u5F88\u957F\u7684\u8DEF\uFF08\u6587\u6863\uFF0C\u95ED\u73AF\uFF0CEcosystem...\u7B49\u7B49\uFF09\u8981\u8D70\u3002",-1),S={href:"https://github.com/apache/shardingsphere/pull/6202",target:"_blank",rel:"noopener noreferrer"},w=s("https://github.com/apache/shardingsphere/pull/6202"),E=n("h3",{id:"_3-2-\u6838\u5FC3\u4F5C\u8005\u91C7\u8BBF\u8C08sharding-jdbc",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#_3-2-\u6838\u5FC3\u4F5C\u8005\u91C7\u8BBF\u8C08sharding-jdbc","aria-hidden":"true"},"#"),s(" 3.2 \u6838\u5FC3\u4F5C\u8005\u91C7\u8BBF\u8C08Sharding-JDBC")],-1),I={href:"https://juejin.cn/post/6844903476393164813",target:"_blank",rel:"noopener noreferrer"},L=s("\u6DF1\u5EA6\u8BA4\u8BC6 Sharding-JDBC\uFF1A\u505A\u6700\u8F7B\u91CF\u7EA7\u7684\u6570\u636E\u5E93\u4E2D\u95F4\u5C42"),C=n("h2",{id:"\u53C2\u8003\u6587\u7AE0",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u53C2\u8003\u6587\u7AE0","aria-hidden":"true"},"#"),s(" \u53C2\u8003\u6587\u7AE0")],-1),D={href:"https://pdai.tech/md/spring/springboot/springboot-x-mysql-shardingjdbc.html",target:"_blank",rel:"noopener noreferrer"},O=n("strong",null,"SpringBoot\u96C6\u6210ShardingJDBC - Sharding-JDBC\u7B80\u4ECB\u548C\u57FA\u4E8EMyBatis\u7684\u5355\u5E93\u5206\u8868",-1);function N(U,R){const a=i("ExternalLinkIcon");return o(),c("div",null,[u,n("p",null,[n("a",r,[k,t(a)])]),d,n("p",null,[n("a",v,[m,t(a)])]),b,n("p",null,[g,n("a",h,[y,t(a)]),q]),_,f,n("p",null,[n("a",S,[w,t(a)])]),E,n("p",null,[n("a",I,[L,t(a)])]),C,n("p",null,[n("a",D,[O,t(a)])])])}const j=e(l,[["render",N],["__file","sharding-jdbc-x-sub-table.html.vue"]]);export{j as default};
