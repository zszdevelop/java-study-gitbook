import{_ as n,W as s,X as a,a0 as t}from"./framework-0cf5f349.js";const e={},p=t(`<h1 id="微信小程序-打开外部链接webview" tabindex="-1"><a class="header-anchor" href="#微信小程序-打开外部链接webview" aria-hidden="true">#</a> 微信小程序-打开外部链接webview</h1><h2 id="_1-简介" tabindex="-1"><a class="header-anchor" href="#_1-简介" aria-hidden="true">#</a> 1. 简介</h2><p>我们小程序经常有一些打开外部链接的需求，如活动页，或者是之前已经完成的功能不希望在小程序中重做。我们希望小程序中能直接打开这些页面。</p><h2 id="_2-步骤" tabindex="-1"><a class="header-anchor" href="#_2-步骤" aria-hidden="true">#</a> 2. 步骤</h2><h3 id="_2-1-新建webview页面" tabindex="-1"><a class="header-anchor" href="#_2-1-新建webview页面" aria-hidden="true">#</a> 2.1 新建webview页面</h3><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>web<span class="token operator">-</span>view <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">&quot;url&quot;</span> bindmessage<span class="token operator">=</span><span class="token string">&quot;getMessage&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>web<span class="token operator">-</span>view<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
	<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
		<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token punctuation">{</span>
				<span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;&#39;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>url <span class="token operator">=</span> options<span class="token punctuation">.</span>url<span class="token punctuation">;</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;webview要打开的页面：&quot;</span><span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>url<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>

	<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-2-调整到webview" tabindex="-1"><a class="header-anchor" href="#_2-2-调整到webview" aria-hidden="true">#</a> 2.2 调整到webview</h3><p>只有https: 和http: 开头的采用webview打开</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">toDetail</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&quot;https:&quot;</span><span class="token punctuation">)</span><span class="token operator">||</span>e<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&quot;http:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
					uni<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
						<span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;/pages/webview/webview?url=&#39;</span><span class="token operator">+</span>  e<span class="token punctuation">.</span>url
					<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&quot;/pages/menu/menu&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
					uni<span class="token punctuation">.</span><span class="token function">switchTab</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
						<span class="token literal-property property">url</span><span class="token operator">:</span>e<span class="token punctuation">.</span>url
					<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
					uni<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
						<span class="token literal-property property">url</span><span class="token operator">:</span> e<span class="token punctuation">.</span>url
					<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-2-1-打开受限" tabindex="-1"><a class="header-anchor" href="#_2-2-1-打开受限" aria-hidden="true">#</a> 2.2.1 打开受限</h4><p>提示打开受限，需要配置业务域名</p><figure><img src="https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/image-20220326065321127.png" alt="image-20220326065321127" tabindex="0" loading="lazy"><figcaption>image-20220326065321127</figcaption></figure><h3 id="_2-3-配置业务域名" tabindex="-1"><a class="header-anchor" href="#_2-3-配置业务域名" aria-hidden="true">#</a> 2.3 配置业务域名</h3><p>我们在小程序后台管理中配置业务域名</p><p>开发- 开发设置-业务域名中修改</p><figure><img src="https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/image-20220326065803516.png" alt="image-20220326065803516" tabindex="0" loading="lazy"><figcaption>image-20220326065803516</figcaption></figure><figure><img src="https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/image-20220326065855295.png" alt="image-20220326065855295" tabindex="0" loading="lazy"><figcaption>image-20220326065855295</figcaption></figure><h3 id="_2-4-校验文件使用" tabindex="-1"><a class="header-anchor" href="#_2-4-校验文件使用" aria-hidden="true">#</a> 2.4 校验文件使用</h3><p>当我们配置业务域名时，会提示我们需要配置校验文件。我们下载校验文件</p><p>文件名： 7Sn5OqKddU.txt 内容如下</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>c5c130153411e08718df45834cee9abc
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_2-4-1-方案一-nginx配置-推荐" tabindex="-1"><a class="header-anchor" href="#_2-4-1-方案一-nginx配置-推荐" aria-hidden="true">#</a> 2.4.1 方案一：nginx配置(推荐)</h4><p>nginx 直接返回文字</p><div class="language-nginx line-numbers-mode" data-ext="nginx"><pre class="language-nginx"><code> <span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
        
        <span class="token directive"><span class="token keyword">location</span> /7Sn5OqKddU.txt</span> <span class="token punctuation">{</span>
            <span class="token directive"><span class="token keyword">return</span> <span class="token number">200</span> <span class="token string">&#39;c5c130153411e08718df45834cee9abc&#39;</span></span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-4-2-代码写接口" tabindex="-1"><a class="header-anchor" href="#_2-4-2-代码写接口" aria-hidden="true">#</a> 2.4.2 代码写接口</h4><p>要在根域名下，所以不能有前缀</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>	<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/7Sn5OqKddU.txt&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ResponseBody</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">wxBizAuth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;c5c130153411e08718df45834cee9abc&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,27),i=[p];function o(c,l){return s(),a("div",null,i)}const r=n(e,[["render",o],["__file","wx-mp-opne-webview.html.vue"]]);export{r as default};
