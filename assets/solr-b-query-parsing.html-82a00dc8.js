import{_ as s,W as d,X as l,Y as t,Z as e,$ as o,a0 as a,D as n}from"./framework-0cf5f349.js";const i={},h=a('<h1 id="solr查询解析器" tabindex="-1"><a class="header-anchor" href="#solr查询解析器" aria-hidden="true">#</a> Solr查询解析器</h1><h2 id="_1-简介" tabindex="-1"><a class="header-anchor" href="#_1-简介" aria-hidden="true">#</a> 1. 简介</h2><p>查询解析器用于将查询语句（q参数）解析成搜索语法。</p><h2 id="_2-常用的三种解析器" tabindex="-1"><a class="header-anchor" href="#_2-常用的三种解析器" aria-hidden="true">#</a> 2. 常用的三种解析器</h2><h3 id="_2-1-默认解析器-lucene" tabindex="-1"><a class="header-anchor" href="#_2-1-默认解析器-lucene" aria-hidden="true">#</a> 2.1 默认解析器：lucene</h3><p>Solr在查询的时候，用到了QueryParser对用户输入做解析，solr默认使用的解析器是lucene，被称之为Standard Query Parser。Standard Query Parser支持原生的查询语法，使你可以方便地构造结构化查询语句。当然，它还有不好的，就是容错比较差，总是把错误抛出来，而不是像dismax一样消化掉。</p><h3 id="_2-2-dismax解析器" tabindex="-1"><a class="header-anchor" href="#_2-2-dismax解析器" aria-hidden="true">#</a> 2.2 DisMax解析器</h3><h4 id="_2-2-1-简介" tabindex="-1"><a class="header-anchor" href="#_2-2-1-简介" aria-hidden="true">#</a> 2.2.1 简介</h4><p>Dismax查询只是由子查询生成的文档的并集，并对由子查询生成的每个文档打分。 一般来说，DisMax查询解析器的接口更像是Google的接口，而不是标准的Solr请求处理程序的接口。 这种相似性使得DisMax成为许多消费者应用程序的适当的查询解析器。</p><p>说人话区别</p><ol><li>方便为每个域添加权重，影响评分</li><li>接口更想是google 的接口，而不是solr/lucene</li><li>很少抛出异常给用户</li></ol><h4 id="_2-2-2-dismax-参数" tabindex="-1"><a class="header-anchor" href="#_2-2-2-dismax-参数" aria-hidden="true">#</a> 2.2.2 DisMax 参数</h4><p>除了通用的查询参数，DisMax还有一些自有的查询参数，你可以在solrconfig.xml中配置这些参数，或者在查询的时候指定，这样会覆盖之前配置的值。</p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>q</td><td>查询参数q</td></tr><tr><td>q.alt</td><td>如果参数q没有指定，就使用standard query parser并代替参数q</td></tr><tr><td><strong>qf</strong></td><td><strong>Query Fields：在哪些字段上去检索数据。如果不指定的话，使用df</strong></td></tr><tr><td><strong>mm</strong></td><td><strong>Minimum Match：指定最小匹配因子</strong></td></tr><tr><td><strong>pf</strong></td><td><strong>Phrase Fields：增加文档的得分如果q参数值离的很近</strong></td></tr><tr><td>ps</td><td>Phrase Slop：指定q参数中两个词可以距离多远</td></tr><tr><td>qs</td><td>Query Phrase Slop：指定q参数中两个词可以距离多远，与qf搭配使用</td></tr><tr><td>tie</td><td>Tie Breaker：使用一个0到1之间的浮点数</td></tr><tr><td><strong>bq</strong></td><td><strong>Boost Query：指定一个额外因素来增加匹配到的文档的得分</strong></td></tr><tr><td><strong>bf</strong></td><td><strong>Boost Functions:指定boosts使用的函数</strong></td></tr></tbody></table><h4 id="_2-2-3-dismax-query-parser使用举例" tabindex="-1"><a class="header-anchor" href="#_2-2-3-dismax-query-parser使用举例" aria-hidden="true">#</a> 2.2.3 DisMax Query Parser使用举例</h4>',15),c={href:"http://localhost:8983/solr/select?q=video&fl=name+score",target:"_blank",rel:"noopener noreferrer"},p={href:"http://localhost:8983/solr/select?defType=dismax&q=video",target:"_blank",rel:"noopener noreferrer"},f={href:"http://localhost:8983/solr/select?defType=dismax&q=video&fl=*,score",target:"_blank",rel:"noopener noreferrer"},u={href:"http://localhost:8983/solr/select?defType=dismax&q=video&qf=features%5E20.0+text%5E0.3",target:"_blank",rel:"noopener noreferrer"},_={href:"http://localhost:8983/solr/select?defType=dismax&q=video&bq=cat:electronics%5E5.0",target:"_blank",rel:"noopener noreferrer"},x={href:"http://localhost:8983/solr/select?defType=dismax&q=video&qt=instock&fl=name,score,inStock",target:"_blank",rel:"noopener noreferrer"},m={href:"http://localhost:8983/solr/select?defType=dismax&q=belkin+ipod+gibberish",target:"_blank",rel:"noopener noreferrer"},b={href:"http://localhost:8983/solr/select?defType=dismax&q=belkin+ipod+gibberish&debugQuery=true",target:"_blank",rel:"noopener noreferrer"},g=a('<h3 id="_2-3-edismax" tabindex="-1"><a class="header-anchor" href="#_2-3-edismax" aria-hidden="true">#</a> 2.3 eDisMax</h3><p>Extended DisMax</p><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>mm.autoRelax</td><td>如果设置为true,可以使mm参数暂时失效：比如stopwords和fq可能会使查询结果为空</td></tr><tr><td>boost</td><td>对于匹配的文档，越多的字符串匹配将会取得更高的得分</td></tr><tr><td>lowercaseOperators</td><td>这个参数可以用来指示是否把or和and当做OR和AND处理</td></tr><tr><td>ps</td><td>短语查询时，默认的溢出量amount of slop，用来影响boosting</td></tr><tr><td>pf2</td><td>指定多值的字段可选的权重</td></tr><tr><td>ps2</td><td>与pf2搭配使用，没有指定的话，使用ps</td></tr><tr><td>pf3</td><td>指定多值的字段可选的权重</td></tr><tr><td>ps3</td><td>与pf3搭配使用，没有指定的话，使用ps</td></tr><tr><td>stopwords</td><td>布尔值，设置是否StopFilterFactory生效，设为false，则stopwords停词不起作用</td></tr><tr><td>uf</td><td>设置用户可以使用那些字段检索，默认是所有字段，也就是uf=<em>；设置为uf=title,就是只让查询title字段；设置为uf=</em>-title，就是禁止查询title字段；设置为uf=-*屏蔽所有字段的检索</td></tr></tbody></table><h2 id="参考文章" tabindex="-1"><a class="header-anchor" href="#参考文章" aria-hidden="true">#</a> 参考文章</h2>',4),q={href:"https://codeantenna.com/a/liB2jbkEqX",target:"_blank",rel:"noopener noreferrer"},y={href:"https://blog.csdn.net/boonya/article/details/55000047",target:"_blank",rel:"noopener noreferrer"},k={href:"https://www.w3cschool.cn/solr_doc/solr_doc-vpyf2gn1.html",target:"_blank",rel:"noopener noreferrer"};function v(T,S){const r=n("ExternalLinkIcon");return d(),l("div",null,[h,t("ul",null,[t("li",null,[t("p",null,[e('使用StandardRequestHandler查询"video" '),t("a",c,[e("http://localhost:8983/solr/select?q=video&fl=name+score"),o(r)])])]),t("li",null,[t("p",null,[e("已经配置了查询字段：text、features、name、id、manu、cat。而且匹配上name和cat会有更高的得分 "),t("a",p,[e("http://localhost:8983/solr/select?defType=dismax&q=video"),o(r)])])]),t("li",null,[t("p",null,[e("可以将score显示出来，看一下各个文档的得分 "),t("a",f,[e("http://localhost:8983/solr/select?defType=dismax&q=video&fl=*,score"),o(r)])])]),t("li",null,[t("p",null,[e("现在想设置features有更高的得分，而text有较低的得分 "),t("a",u,[e("http://localhost:8983/solr/select?defType=dismax&q=video&qf=features^20.0+text^0.3"),o(r)])])]),t("li",null,[t("p",null,[e("现在希望某一字段在满足某一情况下有更高的得分 "),t("a",_,[e("http://localhost:8983/solr/select?defType=dismax&q=video&bq=cat:electronics^5.0"),o(r)])])]),t("li",null,[t("p",null,[e("现在想使用有另外一个为instock的handler，它配置了一个过滤器：inStock:true "),t("a",x,[e("http://localhost:8983/solr/select?defType=dismax&q=video&qt=instock&fl=name,score,inStock"),o(r)])])]),t("li",null,[t("p",null,[e("如果查询短语的单词是一个或者两个，原则上返回的结果中必须包含全部单词，但是你的查询短语很长，solr允许有单词不匹配。你可以通过mm参数设置最多有多少单词不匹配。 "),t("a",m,[e("http://localhost:8983/solr/select?defType=dismax&q=belkin+ipod+gibberish"),o(r)])])]),t("li",null,[t("p",null,[e("可以通过调试功能验证你的想法。 "),t("a",b,[e("http://localhost:8983/solr/select?defType=dismax&q=belkin+ipod+gibberish&debugQuery=true"),o(r)])])])]),g,t("p",null,[t("a",q,[e("solr 查询解析器"),o(r)])]),t("p",null,[t("a",y,[e("Solr Dismax示例"),o(r)])]),t("p",null,[t("a",k,[e("Solr查询：DisMax查询解析器"),o(r)])])])}const M=s(i,[["render",v],["__file","solr-b-query-parsing.html.vue"]]);export{M as default};
