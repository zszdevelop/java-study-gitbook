(window.webpackJsonp=window.webpackJsonp||[]).push([[871],{1253:function(t,s,a){"use strict";a.r(s);var n=a(26),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"redisæ’è¡Œæ¦œåœºæ™¯-zset"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redisæ’è¡Œæ¦œåœºæ™¯-zset"}},[t._v("#")]),t._v(" Redisæ’è¡Œæ¦œåœºæ™¯ï¼ˆzsetï¼‰")]),t._v(" "),a("p",[t._v("åœ¨ä¸€äº›æ¸¸æˆå’Œæ´»åŠ¨ä¸­ï¼Œå½“æ¶‰åŠåˆ°ç¤¾äº¤å…ƒç´ çš„æ—¶å€™ï¼Œæ’è¡Œæ¦œå¯ä»¥è¯´æ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„éœ€æ±‚åœºæ™¯äº†ï¼Œå°±æˆ‘ä»¬é€šå¸¸è§åˆ°çš„æ’è¡Œæ¦œè€Œè¨€ï¼Œä¼šæä¾›ä»¥ä¸‹åŸºæœ¬åŠŸèƒ½")]),t._v(" "),a("ul",[a("li",[t._v("å…¨çƒæ¦œå•ï¼Œå¯¹æ‰€æœ‰ç”¨æˆ·æ ¹æ®ç§¯åˆ†è¿›è¡Œæ’åï¼Œå¹¶åœ¨æ¦œå•ä¸Šå±•ç¤ºå‰å¤šå°‘")]),t._v(" "),a("li",[t._v("ä¸ªäººæ’åï¼Œç”¨æˆ·æŸ¥è¯¢è‡ªå·±æ‰€åœ¨æ¦œå•çš„ä½ç½®ï¼Œå¹¶è·çŸ¥å‘¨è¾¹å°ä¼™ä¼´çš„ç§¯åˆ†ï¼Œæ–¹ä¾¿è‡ªå·±æ¯”è¾ƒå’Œè¶…è¶Š")]),t._v(" "),a("li",[t._v("å®æ—¶æ›´æ–°ï¼Œç”¨æˆ·çš„ç§¯åˆ†å®æ—¶æ›´æ”¹ï¼Œæ¦œå•ä¹Ÿéœ€è¦å®æ—¶æ›´æ–°")])]),t._v(" "),a("p",[t._v("ä¸Šé¢å¯ä»¥è¯´æ˜¯ä¸€ä¸ªæ’è¡Œæ¦œéœ€è¦å®ç°çš„å‡ ä¸ªåŸºæœ¬è¦ç´ äº†ï¼Œæ­£å¥½æˆ‘ä»¬åˆšè®²åˆ°äº†redisè¿™ä¸€èŠ‚ï¼Œæœ¬ç¯‡åˆ™å¼€å§‹å®æˆ˜ï¼Œè¯¦ç»†æè¿°å¦‚ä½•å€ŸåŠ©redisæ¥å®ç°ä¸€ä»½å…¨çƒæ’è¡Œæ¦œ")]),t._v(" "),a("h2",{attrs:{id:"_1-æ–¹æ¡ˆè®¾è®¡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-æ–¹æ¡ˆè®¾è®¡"}},[t._v("#")]),t._v(" 1. æ–¹æ¡ˆè®¾è®¡")]),t._v(" "),a("p",[t._v("åœ¨è¿›è¡Œæ–¹æ¡ˆè®¾è®¡ä¹‹å‰ï¼Œå…ˆæ¨¡æ‹Ÿä¸€ä¸ªçœŸå®çš„åº”ç”¨åœºæ™¯ï¼Œç„¶åè¿›è¡Œè¾…åŠ©è®¾è®¡ä¸å®ç°")]),t._v(" "),a("h3",{attrs:{id:"_1-1-ä¸šåŠ¡åœºæ™¯è¯´æ˜"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-ä¸šåŠ¡åœºæ™¯è¯´æ˜"}},[t._v("#")]),t._v(" 1.1 ä¸šåŠ¡åœºæ™¯è¯´æ˜")]),t._v(" "),a("p",[t._v("ä»¥å‰ä¸€æ®µæ—¶é—´ç‰¹åˆ«ğŸ”¥çš„è·³ä¸€è·³è¿™ä¸ªå°æ¸¸æˆè¿›è¡Œè¯´æ˜ï¼Œå‡è®¾æˆ‘ä»¬è¿™ä¸ªæ¸¸æˆç”¨æˆ·éå¸ƒå…¨çƒï¼Œå› æ­¤æˆ‘ä»¬è¦è®¾è®¡ä¸€ä¸ªå…¨çƒçš„æ¦œå•ï¼Œæ¯ä¸ªç©å®¶éƒ½ä¼šæ ¹æ®è‡ªå·±çš„æˆ˜ç»©åœ¨æ’è¡Œæ¦œä¸­è·å–ä¸€ä¸ªæ’åï¼Œæˆ‘ä»¬éœ€è¦æ”¯æŒå…¨çƒæ¦œå•çš„æŸ¥è¯¢ï¼Œè‡ªå·±æ’ä½çš„æŸ¥è¯¢è¿™ä¸¤ç§æœ€åŸºæœ¬çš„æŸ¥è¯¢åœºæ™¯ï¼›æ­¤å¤–å½“æˆ‘çš„åˆ†æ•°æ¯”ä¸Šä¸€æ¬¡çš„é«˜æ—¶ï¼Œæˆ‘éœ€è¦æ›´æ–°æˆ‘çš„ç§¯åˆ†ï¼Œé‡æ–°è·å¾—æˆ‘çš„æ’åï¼›")]),t._v(" "),a("p",[t._v("æ­¤å¤–ä¹Ÿä¼šæœ‰ä¸€äº›é«˜çº§çš„ç»Ÿè®¡ï¼Œæ¯”å¦‚å“ªä¸ªåˆ†æ®µçš„äººæ•°æœ€å¤šï¼Œä»€ä¹ˆåˆ†æ®µæ˜¯ç“¶é¢ˆç‚¹ï¼Œå†æ ¹æ®åœ°ç†ä½ç½®è®¡ç®—å¹³å‡åˆ†ç­‰ç­‰")]),t._v(" "),a("p",[t._v("æœ¬ç¯‡åšæ–‡ä¸»è¦å†…å®¹å°†æ”¾åœ¨æ’è¡Œæ¦œçš„è®¾è®¡ä¸å®ç°ä¸Šï¼›è‡³äºé«˜çº§çš„åŠŸèƒ½å®ç°ï¼Œåç»­æœ‰æœºä¼šå†è¯´")]),t._v(" "),a("h3",{attrs:{id:"_1-2-æ•°æ®ç»“æ„"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-æ•°æ®ç»“æ„"}},[t._v("#")]),t._v(" 1.2 æ•°æ®ç»“æ„")]),t._v(" "),a("p",[t._v("å› ä¸ºæ’è¡Œæ¦œçš„åŠŸèƒ½æ¯”è¾ƒç®€å•äº†ï¼Œä¹Ÿä¸éœ€è¦ä»€ä¹ˆå¤æ‚çš„ç»“æ„è®¾è®¡ï¼Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆå¤æ‚çš„äº¤äº’ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ç¡®è®¤çš„æ— éå°±æ˜¯æ•°æ®ç»“æ„ + å­˜å‚¨å•å…ƒ")]),t._v(" "),a("p",[a("strong",[t._v("å­˜å‚¨å•å…ƒ")])]),t._v(" "),a("p",[t._v("è¡¨ç¤ºæ’è¡Œæ¦œä¸­æ¯ä¸€ä½ä¸Šåº”è¯¥æŒæœ‰çš„ä¿¡æ¯ï¼Œä¸€ä¸ªæœ€ç®€å•çš„å¦‚ä¸‹")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç”¨æ¥è¡¨æ˜å…·ä½“çš„ç”¨æˆ·")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" userId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç”¨æˆ·åœ¨æ’è¡Œæ¦œä¸Šçš„æ’å")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" rank"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç”¨æˆ·çš„å†å²æœ€é«˜ç§¯åˆ†ï¼Œä¹Ÿå°±æ˜¯æ’è¡Œæ¦œä¸Šçš„ç§¯åˆ†")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" score"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[a("strong",[t._v("æ•°æ®ç»“æ„")])]),t._v(" "),a("p",[t._v("æ’è¡Œæ¦œï¼Œä¸€èˆ¬è€Œè¨€éƒ½æ˜¯è¿ç»­çš„ï¼Œå€Ÿæ­¤æˆ‘ä»¬å¯ä»¥è”æƒ³åˆ°ä¸€ä¸ªåˆé€‚çš„æ•°æ®ç»“æ„LinkedListï¼Œå¥½å¤„åœ¨äºæ’åå˜åŠ¨æ—¶ï¼Œä¸éœ€è¦æ•°ç»„çš„æ‹·è´")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/blogimage-master/img/image-20191007090440623.png",alt:"image-20191007090440623"}})]),t._v(" "),a("p",[t._v("ä¸Šå›¾æ¼”ç¤ºï¼Œå½“ä¸€ä¸ªç”¨æˆ·ç§¯åˆ†æ”¹å˜æ—¶ï¼Œéœ€è¦å‘å‰éå†æ‰¾åˆ°åˆé€‚çš„ä½ç½®ï¼Œæ’å…¥å¹¶è·å–æ–°çš„æ’å, åœ¨æ›´æ–°å’Œæ’å…¥æ—¶ï¼Œç›¸æ¯”è¾ƒäºArrayListè¦å¥½å¾ˆå¤šï¼Œä½†ä¾ç„¶æœ‰ä»¥ä¸‹å‡ ä¸ªç¼ºé™·")]),t._v(" "),a("p",[a("strong",[t._v("é—®é¢˜1ï¼šç”¨æˆ·å¦‚ä½•è·å–è‡ªå·±çš„æ’åï¼Ÿ")])]),t._v(" "),a("p",[t._v("ä½¿ç”¨"),a("code",[t._v("LinkedList")]),t._v("åœ¨æ›´æ–°æ’å…¥å’Œåˆ é™¤çš„å¸¦æ¥ä¼˜åŠ¿ä¹‹å¤–ï¼Œåœ¨éšæœºè·å–å…ƒç´ çš„æ”¯æŒä¼šå·®ä¸€ç‚¹ï¼Œæœ€å·®çš„æƒ…å†µå°±æ˜¯ä»å¤´åˆ°å°¾è¿›è¡Œæ‰«æ")]),t._v(" "),a("p",[a("strong",[t._v("é—®é¢˜2ï¼šå¹¶å‘æ”¯æŒçš„é—®é¢˜ï¼Ÿ")])]),t._v(" "),a("p",[t._v("å½“æœ‰å¤šä¸ªç”¨æˆ·åŒæ—¶æ›´æ–°scoreæ—¶ï¼Œå¹¶å‘çš„æ›´æ–°æ’åé—®é¢˜å°±æ¯”è¾ƒçªå‡ºäº†ï¼Œå½“ç„¶å¯ä»¥ä½¿ç”¨jdkä¸­ç±»ä¼¼å†™æ—¶æ‹·è´æ•°ç»„çš„æ–¹æ¡ˆ")]),t._v(" "),a("p",[t._v("ä¸Šé¢æ˜¯æˆ‘ä»¬è‡ªå·±æ¥å®ç°è¿™ä¸ªæ•°æ®ç»“æ„æ—¶ï¼Œä¼šé‡åˆ°çš„ä¸€äº›é—®é¢˜ï¼Œå½“ç„¶æˆ‘ä»¬çš„ä¸»é¢˜æ˜¯å€ŸåŠ©redisæ¥å®ç°æ’è¡Œæ¦œï¼Œä¸‹é¢åˆ™æ¥çœ‹ä¸‹ï¼Œåˆ©ç”¨rediså¯ä»¥æ€ä¹ˆç®€å•çš„æ”¯æŒæˆ‘ä»¬çš„éœ€æ±‚åœºæ™¯")]),t._v(" "),a("h3",{attrs:{id:"_1-3-redisä½¿ç”¨æ–¹æ¡ˆ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-redisä½¿ç”¨æ–¹æ¡ˆ"}},[t._v("#")]),t._v(" 1.3 redisä½¿ç”¨æ–¹æ¡ˆ")]),t._v(" "),a("p",[t._v("è¿™é‡Œä¸»è¦ä½¿ç”¨çš„æ˜¯redisçš„ZSETæ•°æ®ç»“æ„ï¼Œå¸¦æƒé‡çš„é›†åˆï¼Œä¸‹é¢åˆ†æä¸€ä¸‹å¯èƒ½æ€§")]),t._v(" "),a("ul",[a("li",[t._v("set: é›†åˆç¡®ä¿é‡Œé¢å…ƒç´ çš„å”¯ä¸€æ€§")]),t._v(" "),a("li",[t._v("æƒé‡ï¼šè¿™ä¸ªå¯ä»¥çœ‹åšæˆ‘ä»¬çš„scoreï¼Œè¿™æ ·æ¯ä¸ªå…ƒç´ éƒ½æœ‰ä¸€ä¸ªscoreï¼›")]),t._v(" "),a("li",[t._v("zsetï¼šæ ¹æ®scoreè¿›è¡Œæ’åºçš„é›†åˆ")])]),t._v(" "),a("p",[t._v("ä»zsetçš„ç‰¹æ€§æ¥çœ‹ï¼Œæˆ‘ä»¬æ¯ä¸ªç”¨æˆ·çš„ç§¯åˆ†ï¼Œä¸¢åˆ°zsetä¸­ï¼Œå°±æ˜¯ä¸€ä¸ªå¸¦æƒé‡çš„å…ƒç´ ï¼Œè€Œä¸”æ˜¯å·²ç»æ’å¥½åºçš„äº†ï¼Œåªéœ€è¦è·å–å…ƒç´ å¯¹åº”çš„indexï¼Œå°±æ˜¯æˆ‘ä»¬é¢„æœŸçš„æ’å")]),t._v(" "),a("h2",{attrs:{id:"_2-åŠŸèƒ½å®ç°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-åŠŸèƒ½å®ç°"}},[t._v("#")]),t._v(" 2. åŠŸèƒ½å®ç°")]),t._v(" "),a("p",[t._v("æˆ‘ä»¬ä¸»è¦æ˜¯å€ŸåŠ©zsetæä¾›çš„ä¸€äº›æ–¹æ³•æ¥å®ç°æ’è¡Œæ¦œçš„éœ€æ±‚ï¼Œä¸‹é¢çš„å…·ä½“æ–¹æ³•è®¾è®¡ä¸­ï¼Œä¹Ÿä¼šæœ‰ç›¸å…³è¯´æ˜")]),t._v(" "),a("h3",{attrs:{id:"_2-1-å‰æå‡†å¤‡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-å‰æå‡†å¤‡"}},[t._v("#")]),t._v(" 2.1 å‰æå‡†å¤‡")]),t._v(" "),a("p",[t._v("é¦–å…ˆå‡†å¤‡å¥½redisç¯å¢ƒï¼Œspringé¡¹ç›®æ­å»ºå¥½ï¼Œç„¶åé…ç½®å¥½redisTemplate")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Configuration")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RedisConfig")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Bean")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"redisTemplate"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RedisTemplate")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("redisTemplate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RedisConnectionFactory")]),t._v(" redisConnectionFactory"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RedisTemplate")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" redisTemplate "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RedisTemplate")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        redisTemplate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setConnectionFactory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("redisConnectionFactory"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä½¿ç”¨Jackson2JsonRedisSerialize æ›¿æ¢é»˜è®¤åºåˆ—åŒ–")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Jackson2JsonRedisSerializer")]),t._v(" jackson2JsonRedisSerializer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Jackson2JsonRedisSerializer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ObjectMapper")]),t._v(" objectMapper "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ObjectMapper")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        objectMapper"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setVisibility")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PropertyAccessor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ALL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JsonAutoDetect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Visibility")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ANY"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        objectMapper"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("enableDefaultTyping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ObjectMapper")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DefaultTyping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("NON_FINAL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        jackson2JsonRedisSerializer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setObjectMapper")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("objectMapper"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®¾ç½®valueçš„åºåˆ—åŒ–è§„åˆ™å’Œ keyçš„åºåˆ—åŒ–è§„åˆ™")]),t._v("\n        redisTemplate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setKeySerializer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("StringRedisSerializer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        redisTemplate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setValueSerializer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("jackson2JsonRedisSerializer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        redisTemplate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("afterPropertiesSet")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" redisTemplate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"_2-2-ç”¨æˆ·ä¸Šä¼ ç§¯åˆ†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-ç”¨æˆ·ä¸Šä¼ ç§¯åˆ†"}},[t._v("#")]),t._v(" 2.2 ç”¨æˆ·ä¸Šä¼ ç§¯åˆ†")]),t._v(" "),a("p",[t._v("ä¸Šä¼ ç”¨æˆ·ç§¯åˆ†ï¼Œç„¶è€Œzsetä¸­æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯å…¶æ’è¡Œæ˜¯æ ¹æ®scoreè¿›è¡Œå‡åºæ’åˆ—ï¼Œè¿™ä¸ªå°±å’Œæˆ‘ä»¬å®é™…çš„æƒ…å†µä¸å¤ªä¸€æ ·äº†ï¼›ä¸ºäº†å’Œå®é™…æƒ…å†µä¸€è‡´ï¼Œå¯ä»¥å°†scoreå–åï¼›å¦å¤–ä¸€ä¸ªå°±æ˜¯æ’è¡Œé»˜è®¤æ˜¯ä»0å¼€å§‹çš„ï¼Œè¿™ä¸ªä¸æˆ‘ä»¬çš„å®é™…ä¹Ÿä¸å¤ªä¸€æ ·ï¼Œéœ€è¦+1")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * æ›´æ–°ç”¨æˆ·ç§¯åˆ†ï¼Œå¹¶è·å–æœ€æ–°çš„ä¸ªäººæ‰€åœ¨æ’è¡Œæ¦œä¿¡æ¯\n *\n * @param userId\n * @param score\n * @return\n */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RankDO")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateRank")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" userId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Float")]),t._v(" score"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å› ä¸ºzseté»˜è®¤ç§¯åˆ†å°çš„åœ¨å‰é¢ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯¹scoreè¿›è¡Œå–åï¼Œè¿™æ ·ç”¨æˆ·çš„ç§¯åˆ†è¶Šå¤§ï¼Œå¯¹åº”çš„scoreè¶Šå°ï¼Œæ’åè¶Šé«˜")]),t._v("\n    redisUtil"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("zAdd")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("RANK_PREFIX"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("valueOf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("userId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("score"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" rank "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" redisUtil"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("zRank")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("RANK_PREFIX"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("valueOf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("userId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RankDO")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("userId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("rank "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" score"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"_2-3-è·å–ä¸ªäººæ’å"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-è·å–ä¸ªäººæ’å"}},[t._v("#")]),t._v(" 2.3 è·å–ä¸ªäººæ’å")]),t._v(" "),a("p",[t._v("è·å–ä¸ªäººæ’è¡Œä¿¡æ¯ï¼Œä¸»è¦å°±æ˜¯ä¸¤ä¸ªä¸€ä¸ªæ˜¯æ’åä¸€ä¸ªæ˜¯ç§¯åˆ†ï¼›éœ€è¦æ³¨æ„çš„æ˜¯å½“ç”¨æˆ·æ²¡æœ‰ç§¯åˆ†æ—¶ï¼ˆå³æ²¡æœ‰ä¸Šæ¦œæ—¶ï¼‰ï¼Œéœ€è¦é¢å¤–å¤„ç†")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * è·å–ç”¨æˆ·çš„æ’è¡Œæ¦œä½ç½®\n *\n * @param userId\n * @return\n */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RankDO")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getRank")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" userId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è·å–æ’è¡Œï¼Œ å› ä¸ºé»˜è®¤æ˜¯0ä¸ºå¼€å¤´ï¼Œå› æ­¤å®é™…çš„æ’åéœ€è¦+1")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" rank "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" redisUtil"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("zRank")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("RANK_PREFIX"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("valueOf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("userId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rank "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ²¡æœ‰æ’è¡Œæ—¶ï¼Œç›´æ¥è¿”å›ä¸€ä¸ªé»˜è®¤çš„")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RankDO")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1L")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" userId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0F")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è·å–ç§¯åˆ†")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Double")]),t._v(" score "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" redisUtil"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("zScore")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("RANK_PREFIX"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("valueOf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("userId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RankDO")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("userId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("rank "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Math")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("abs")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("score"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("floatValue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"_2-4-è·å–ä¸ªäººå‘¨è¾¹ç”¨æˆ·ç§¯åˆ†åŠæ’è¡Œä¿¡æ¯"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-è·å–ä¸ªäººå‘¨è¾¹ç”¨æˆ·ç§¯åˆ†åŠæ’è¡Œä¿¡æ¯"}},[t._v("#")]),t._v(" 2.4 è·å–ä¸ªäººå‘¨è¾¹ç”¨æˆ·ç§¯åˆ†åŠæ’è¡Œä¿¡æ¯")]),t._v(" "),a("p",[t._v("é¦–å…ˆè·å–ç”¨æˆ·çš„ä¸ªäººæ’åï¼Œç„¶åæŸ¥è¯¢å›ºå®šæ’åæ®µçš„æ•°æ®å³å¯")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * è·å–ç”¨æˆ·æ‰€åœ¨æ’è¡Œæ¦œçš„ä½ç½®ï¼Œä»¥åŠæ’è¡Œæ¦œä¸­å…¶å‰ånä¸ªç”¨æˆ·çš„æ’è¡Œä¿¡æ¯\n *\n * @param userId\n * @param n\n * @return\n */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RankDO")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getRankAroundUser")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" userId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// é¦–å…ˆæ˜¯è·å–ç”¨æˆ·å¯¹åº”çš„æ’å")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RankDO")]),t._v(" rank "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getRank")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("userId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rank"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getRank")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// fixme ç”¨æˆ·æ²¡æœ‰ä¸Šæ¦œæ—¶ï¼Œä¸è¿”å›")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Collections")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("emptyList")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å› ä¸ºå®é™…çš„æ’åæ˜¯ä»0å¼€å§‹çš„ï¼Œæ‰€ä»¥æŸ¥è¯¢å‘¨è¾¹æ’åæ—¶ï¼Œéœ€è¦å°†n-1")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Set")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ZSetOperations")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TypedTuple")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" result "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n            redisUtil"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("zRangeWithScores")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("RANK_PREFIX"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Math")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("max")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" rank"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getRank")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" n "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" rank"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getRank")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" n "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("buildRedisRankToBizDO")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" rank"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getRank")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RankDO")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("buildRedisRankToBizDO")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Set")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ZSetOperations")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TypedTuple")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" offset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RankDO")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" rankList "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ArrayList")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" rank "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" offset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ZSetOperations")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TypedTuple")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" sub "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" userId "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" sub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getValue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            rankList"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RankDO")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("parseLong")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("userId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("rank"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Math")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("abs")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getScore")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("floatValue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" rankList"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("çœ‹ä¸‹ä¸Šé¢çš„å®ç°ï¼Œè·å–ç”¨æˆ·æ’åä¹‹åï¼Œå°±å¯ä»¥è®¡ç®—è¦æŸ¥è¯¢çš„æ’åèŒƒå›´"),a("code",[t._v("[Math.max(0, rank.getRank() - n - 1), rank.getRank() + n - 1]")])]),t._v(" "),a("p",[t._v("å…¶æ¬¡éœ€è¦æ³¨æ„çš„å¦‚ä½•å°†è¿”å›çš„ç»“æœè¿›è¡Œå°è£…ï¼Œä¸Šé¢å†™äº†ä¸ªè½¬æ¢ç±»ï¼Œä¸»è¦èµ·å§‹æ’è¡Œæ¦œä¿¡æ¯")]),t._v(" "),a("h3",{attrs:{id:"_2-5-è·å–topnæ’è¡Œ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-è·å–topnæ’è¡Œ"}},[t._v("#")]),t._v(" 2.5 è·å–topnæ’è¡Œ")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * è·å–å‰nåçš„æ’è¡Œæ¦œæ•°æ®\n *\n * @param n\n * @return\n */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RankDO")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getTopNRanks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Set")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ZSetOperations")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TypedTuple")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" result "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" redisUtil"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("zRangeWithScores")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("RANK_PREFIX"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" n "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("buildRedisRankToBizDO")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h2",{attrs:{id:"_3-æµ‹è¯•"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-æµ‹è¯•"}},[t._v("#")]),t._v(" 3. æµ‹è¯•")]),t._v(" "),a("p",[t._v("é¦–å…ˆå‡†å¤‡ä¸€ä¸ªæµ‹è¯•è„šæœ¬ï¼Œæ‰¹é‡çš„æ’å…¥ä¸€ä¸‹ç§¯åˆ†ï¼Œç”¨äºåç»­çš„æŸ¥è¯¢æ›´æ–°ä½¿ç”¨")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RankInitTest")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Random")]),t._v(" random"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RestTemplate")]),t._v(" restTemplate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Before")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("init")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        random "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Random")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        restTemplate "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RestTemplate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("genUserId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" random"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextInt")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("double")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("genScore")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" random"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextDouble")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Test")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("testInitRank")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            restTemplate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getForObject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://localhost:8080/update?userId="')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("genUserId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"&score="')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("genScore")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"_4-å°ç»“"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-å°ç»“"}},[t._v("#")]),t._v(" 4. å°ç»“")]),t._v(" "),a("p",[t._v("ä¸Šé¢åˆ©ç”¨redisçš„zsetå®ç°äº†æ’è¡Œæ¦œçš„åŸºæœ¬åŠŸèƒ½ï¼Œä¸»è¦å€ŸåŠ©ä¸‹é¢ä¸‰ä¸ªæ–¹æ³•")]),t._v(" "),a("ul",[a("li",[t._v("range è·å–èŒƒå›´æ’è¡Œä¿¡æ¯")]),t._v(" "),a("li",[t._v("score è·å–å¯¹åº”çš„score")]),t._v(" "),a("li",[t._v("range è·å–å¯¹åº”çš„æ’å")])]),t._v(" "),a("p",[t._v("è™½ç„¶å®ç°äº†åŸºæœ¬åŠŸèƒ½ï¼Œä½†æ˜¯é—®é¢˜è¿˜æ˜¯æœ‰ä¸å°‘çš„")]),t._v(" "),a("ul",[a("li",[t._v("ä¸Šé¢çš„å®ç°ï¼Œredisçš„å¤åˆæ“ä½œï¼ŒåŸå­æ€§é—®é¢˜")]),t._v(" "),a("li",[t._v("ç”±åŸå­æ€§é—®é¢˜å¯¼è‡´å¹¶å‘å®‰å…¨é—®é¢˜")]),t._v(" "),a("li",[t._v("æ€§èƒ½æ€ä¹ˆæ ·éœ€è¦æµ‹è¯•")])]),t._v(" "),a("h3",{attrs:{id:"å‚è€ƒæ–‡ç« "}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å‚è€ƒæ–‡ç« "}},[t._v("#")]),t._v(" å‚è€ƒæ–‡ç« ")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://my.oschina.net/u/566591/blog/2993208",target:"_blank",rel:"noopener noreferrer"}},[t._v("SpringBootåº”ç”¨ç¯‡ä¹‹å€ŸåŠ©Rediså®ç°æ’è¡Œæ¦œåŠŸèƒ½"),a("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=e.exports}}]);