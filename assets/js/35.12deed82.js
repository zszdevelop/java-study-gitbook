(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{412:function(a,e,t){"use strict";t.r(e);var s=t(26),_=Object(s.a)({},(function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"java命令参数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#java命令参数"}},[a._v("#")]),a._v(" Java命令参数")]),a._v(" "),t("h2",{attrs:{id:"_1-简介"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-简介"}},[a._v("#")]),a._v(" 1. 简介")]),a._v(" "),t("p",[t("code",[a._v("java")]),a._v(" 命令用于启动 java 应用：它首先会启动 java 运行时环境（JRE），然后加载指定的类，调用类的 "),t("code",[a._v("main()")]),a._v(" 方法。"),t("code",[a._v("main()")]),a._v(" 方法必须定义为 "),t("code",[a._v("public")]),a._v(" 和 "),t("code",[a._v("static")]),a._v(" 的，并且不返回任何值，参数是 String 类型的数组，该方法的形式如下：")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("public static void main(String[] args)\n")])])]),t("p",[a._v("在通过 "),t("code",[a._v("java")]),a._v(" 命令启动应用时，有一系列的可选参数，使用时需根据应用场景选择合适的参数")]),a._v(" "),t("h2",{attrs:{id:"_2-语法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-语法"}},[a._v("#")]),a._v(" 2. 语法")]),a._v(" "),t("p",[t("code",[a._v("java")]),a._v(" 命令支持两种启动方式：")]),a._v(" "),t("ol",[t("li",[t("p",[a._v("一种是指定要执行的 java 类")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("java [options] classname [args]\n")])])])]),a._v(" "),t("li",[t("p",[a._v("另一种是指定要执行的 jar 包")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("java [options] -jar filename [args]\n")])])])])]),a._v(" "),t("p",[a._v("其中每一项的含义如下：")]),a._v(" "),t("ul",[t("li",[a._v("options 是可选项，选项之间使用空格分割")]),a._v(" "),t("li",[a._v("classname 是要加载的类的名字")]),a._v(" "),t("li",[a._v("filename 是要执行的 java 压缩文件（JAR）的名字，需要和 "),t("code",[a._v("-jar")]),a._v(" 搭配使用")]),a._v(" "),t("li",[a._v("args 是传递给 "),t("code",[a._v("main()")]),a._v(" 方法的参数，使用空格分割")])]),a._v(" "),t("h2",{attrs:{id:"_3-选项"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-选项"}},[a._v("#")]),a._v(" 3. 选项")]),a._v(" "),t("p",[t("code",[a._v("java")]),a._v(" 命令支持一系列选项，它们可以分为如下几类：")]),a._v(" "),t("ul",[t("li",[a._v("标准选项")]),a._v(" "),t("li",[a._v("非标准选项")]),a._v(" "),t("li",[a._v("运行时高级选项")]),a._v(" "),t("li",[a._v("JIT 编译器高级选项")]),a._v(" "),t("li",[a._v("可服务性高级选项")]),a._v(" "),t("li",[a._v("垃圾回收器高级选项")])]),a._v(" "),t("h3",{attrs:{id:"_3-1-如何定义选项分类"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-如何定义选项分类"}},[a._v("#")]),a._v(" 3.1 如何定义选项分类")]),a._v(" "),t("ul",[t("li",[t("p",[a._v("标准选项")]),a._v(" "),t("p",[a._v("所有 java 虚拟机（JVM）都要保证支持标准选项，这些选项用于通用类型的操作，例如检查 JRE 版本、设置 class path 等。")])]),a._v(" "),t("li",[t("p",[a._v("非标准选项")]),a._v(" "),t("p",[a._v("非标准选项以 "),t("code",[a._v("-X")]),a._v(" 开头，是适用于 java HotSpot 虚拟机的通用选项，其他虚拟机不保证支持，并且以后还可能会变化。")])]),a._v(" "),t("li",[t("p",[a._v("高级选项")]),a._v(" "),t("p",[a._v("高级选项以 "),t("code",[a._v("-XX")]),a._v(" 开头，是开发者选项，用于调节 Java HotSpot 虚拟机的特定功能，通常对系统有特定的要求，并且可能还需要访问系统配置参数的特权。并非所有的虚拟机都支持的这些选项，以后还可能会变化。")])])]),a._v(" "),t("p",[a._v("Boolean 型选项用于开启或关闭特定功能，这种类型的选项不需要参数。对于 "),t("code",[a._v("-XX")]),a._v(" 选项来说，"),t("code",[a._v("-XX:+OptionName")]),a._v(" 表示开启功能，"),t("code",[a._v("-XX:-OptionName")]),a._v(" 表示关闭功能。")]),a._v(" "),t("h2",{attrs:{id:"_4-标准选项"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-标准选项"}},[a._v("#")]),a._v(" 4. 标准选项")]),a._v(" "),t("h3",{attrs:{id:"_4-1-agentlib-libname-options"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-agentlib-libname-options"}},[a._v("#")]),a._v(" 4.1 -agentlib:libname[=options]")]),a._v(" "),t("p",[a._v("用于加载指定的本地代理库，选项（options）之间使用逗号（,）分隔。")]),a._v(" "),t("p",[a._v("例如指定 "),t("code",[a._v("-agentlib:foo")]),a._v(" 参数后，JVM 会尝试到 "),t("code",[a._v("LD_LIBRARY_PATH")]),a._v(" 系统变量指定的路径（OS X 系统下变量是 "),t("code",[a._v("DYLD_LIBRARY_PATH")]),a._v("）下加载 "),t("code",[a._v("libfoo.so")]),a._v(" 类库。")]),a._v(" "),t("p",[a._v("如下的示例展示了如何加载 HPROF（heap profiling tool）库，并且每隔 20 ms 获取一次 CPU 信息，栈深度为 3：")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("-agentlib:hprof=cpu=samples,interval=20,depth=3\n")])])]),t("p",[a._v("这一个示例展示了如何加载 JDWP（Java Debug Wire Protocol），并且在 8000 端口监听 socket 连接，在 main 类加载前暂停：")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("-agentlib:jdwp=transport=dt_socket,server=y,address=8000\n")])])]),t("p",[a._v("更多本地代理库相关的信息请参考")]),a._v(" "),t("ul",[t("li",[t("p",[t("code",[a._v("java.lang.instrument")]),a._v(" 包的说明")]),a._v(" "),t("p",[a._v("http://docs.oracle.com/javase/8/docs/api/java/lang/instrument/package-summary.html")])]),a._v(" "),t("li",[t("p",[a._v("JVM Tools Interface 手册中「本地代理命令行选项」部分")]),a._v(" "),t("p",[a._v("http://docs.oracle.com/javase/8/docs/platform/jvmti/jvmti.html#starting")])])]),a._v(" "),t("h3",{attrs:{id:"_4-2-agentpath-pathname-options"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-agentpath-pathname-options"}},[a._v("#")]),a._v(" 4.2 -agentpath:pathname[=options]")]),a._v(" "),t("p",[a._v("在指定的绝对路径下加载本地代理库，和 "),t("code",[a._v("-agentlib")]),a._v(" 的区别是使用的全路径和类库的文件名")]),a._v(" "),t("h3",{attrs:{id:"_4-3-client"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-client"}},[a._v("#")]),a._v(" 4.3 -client")]),a._v(" "),t("p",[a._v("选择 Java HotSpot Client 虚拟机。64 位的 JDK（Java SE Development Kit）会忽略该选项，并且使用 Server 虚拟机。")]),a._v(" "),t("h3",{attrs:{id:"_4-4-server"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-server"}},[a._v("#")]),a._v(" 4.4 -server")]),a._v(" "),t("p",[a._v("选择 Java HotSpot Server 虚拟机。64 位的 JDK 仅支持 Server 虚拟机，所以该选项是默认值。")]),a._v(" "),t("p",[a._v("要了解不同类型机器默认选择的 JVM，可查看如下页面")]),a._v(" "),t("p",[a._v("http://docs.oracle.com/javase/8/docs/technotes/guides/vm/server-class.html")]),a._v(" "),t("h3",{attrs:{id:"_4-5-dproperty-value"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-5-dproperty-value"}},[a._v("#")]),a._v(" 4.5 -Dproperty=value")]),a._v(" "),t("p",[a._v("用于设置系统属性（property）值。例如："),t("code",[a._v('-Dfoo="foo bar"')])]),a._v(" "),t("blockquote",[t("p",[a._v("-Dname=$AppName  -Duser.timezone=Asia/Shanghai")])]),a._v(" "),t("h3",{attrs:{id:"_4-6-d32"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-6-d32"}},[a._v("#")]),a._v(" 4.6 -d32")]),a._v(" "),t("p",[a._v("在 32 位环境下运行程序，如果未安装 32 位环境或者不支持，系统会报告一个错误。")]),a._v(" "),t("h3",{attrs:{id:"_4-7-d64"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-7-d64"}},[a._v("#")]),a._v(" 4.7 -d64")]),a._v(" "),t("p",[a._v("在 64 位环境下运行程序。"),t("code",[a._v("-server")]),a._v(" 选项会隐式地包含 "),t("code",[a._v("-d64")]),a._v(" 选项。")]),a._v(" "),t("h3",{attrs:{id:"_4-8-jar-filename"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-8-jar-filename"}},[a._v("#")]),a._v(" 4.8 -jar filename")]),a._v(" "),t("p",[a._v("执行封装在 JAR 文件中的程序。JAR 文件需包含 manifest，其中一行格式为 "),t("code",[a._v("Main-Class:classname")]),a._v("，指定了一个包含 "),t("code",[a._v("public static void main(String[] args)")]),a._v(" 方法的类，作为该程序的启动点。")]),a._v(" "),t("p",[a._v("当使用了 "),t("code",[a._v("-jar")]),a._v(" 选项时，所有的用户类都从 JAR 文件中读取，忽略其他的 class path 设置。")]),a._v(" "),t("h3",{attrs:{id:"_4-9-showversion"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-9-showversion"}},[a._v("#")]),a._v(" 4.9 -showversion")]),a._v(" "),t("p",[a._v("显示版本信息并且继续执行程序。")]),a._v(" "),t("h3",{attrs:{id:"_4-10-version"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-10-version"}},[a._v("#")]),a._v(" 4.10 -version")]),a._v(" "),t("p",[a._v("显示版本信息然后退出程序。")]),a._v(" "),t("h3",{attrs:{id:"_4-11-splash-imgname"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-11-splash-imgname"}},[a._v("#")]),a._v(" 4.11 -splash:imgname")]),a._v(" "),t("p",[a._v("显示指定的闪屏图片。例如：要在启动程序时显示 "),t("code",[a._v("image")]),a._v(" 目录下的 "),t("code",[a._v("splash.gif")]),a._v(" 图片，可使用如下参数：")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("-splash:images/splash.gif\n")])])]),t("h3",{attrs:{id:"_4-12-verbose-class"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-12-verbose-class"}},[a._v("#")]),a._v(" 4.12 -verbose:class")]),a._v(" "),t("p",[a._v("显示每一次加载类的信息。")]),a._v(" "),t("h3",{attrs:{id:"_4-13-verbose-gc"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-13-verbose-gc"}},[a._v("#")]),a._v(" 4.13 -verbose:gc")]),a._v(" "),t("p",[a._v("显示每一次垃圾回收（GC）事件的信息。")]),a._v(" "),t("h3",{attrs:{id:"_4-14-verbose-jni"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-14-verbose-jni"}},[a._v("#")]),a._v(" 4.14 -verbose:jni")]),a._v(" "),t("p",[a._v("显示使用的本地方法信息和其他的 JNI（Java Native Interface）活动信息。")]),a._v(" "),t("h2",{attrs:{id:"_5-非标准选项"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-非标准选项"}},[a._v("#")]),a._v(" 5. 非标准选项")]),a._v(" "),t("p",[a._v("这些是 Java HotSpot 虚拟机的通用目的选项。")]),a._v(" "),t("h3",{attrs:{id:"_5-1-x"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-x"}},[a._v("#")]),a._v(" 5.1 -X")]),a._v(" "),t("p",[a._v("显示所有适用于 "),t("code",[a._v("-X")]),a._v(" 选项的帮助信息。")]),a._v(" "),t("h3",{attrs:{id:"_5-2-xbatch"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-xbatch"}},[a._v("#")]),a._v(" 5.2 -Xbatch")]),a._v(" "),t("p",[a._v("禁用后台编译，该参数等价于 "),t("code",[a._v("-XX:-BackgroundCompilation")]),a._v("。默认情况下，JVM 使用一个后台任务进行编译，在编译完成前使用解释模式执行方法。加上该参数后将会在前台编译所有的方法。")]),a._v(" "),t("h3",{attrs:{id:"_5-3-xbootclasspath-path"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-xbootclasspath-path"}},[a._v("#")]),a._v(" 5.3 -Xbootclasspath:path")]),a._v(" "),t("p",[a._v("设置 boot class 的路径，"),t("code",[a._v("path")]),a._v(" 可以是目录、JAR 文件、ZIP 压缩包，中间使用 "),t("code",[a._v(":")]),a._v(" 分割。不要使用该选项覆盖 "),t("code",[a._v("rt.jar")]),a._v(" 里的类，因为这会违反「JRE binary code license」。另外 "),t("code",[a._v("-Xbootclasspath/a:path")]),a._v(" 用于添加路径到默认路径的后面，"),t("code",[a._v("-Xbootclasspath/p:path")]),a._v(" 用于添加路径到默认路径的前面。")]),a._v(" "),t("h3",{attrs:{id:"_5-4-xcheck-jni"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-4-xcheck-jni"}},[a._v("#")]),a._v(" 5.4 -Xcheck:jni")]),a._v(" "),t("p",[a._v("对 JNI（Java Native Interface）函数执行额外的检查。具体来讲，在处理 JNI 请求前，它会检查传递给 JNI 函数的参数和运行时环境数据。如果检查到任何的不合法数据，JVM 会抛出不可恢复的错误并结束执行。该参数会降低性能。")]),a._v(" "),t("h3",{attrs:{id:"_5-5-xcomp"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-5-xcomp"}},[a._v("#")]),a._v(" 5.5 -Xcomp")]),a._v(" "),t("p",[a._v("强制在方法的第一次调用时进行编译。默认情况下，Client 虚拟机（使用 -client 参数）会先执行 1000 次解释执行，Server 虚拟机（-server）是 10000 次，以便获取到足够的信息用于编译。还可以使用 "),t("code",[a._v("-XX:CompileThreshold")]),a._v(" 指定编译前解释执行的次数。")]),a._v(" "),t("h3",{attrs:{id:"_5-6-xint"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-6-xint"}},[a._v("#")]),a._v(" 5.6 -Xint")]),a._v(" "),t("p",[a._v("仅使用解释模式执行程序。所有的代码都在解释模式下执行，这将无法体验到 JIT（just in time）编译器带来的性能提升。")]),a._v(" "),t("h3",{attrs:{id:"_5-7-xinternalversion"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-7-xinternalversion"}},[a._v("#")]),a._v(" 5.7 -Xinternalversion")]),a._v(" "),t("p",[a._v("显示比 "),t("code",[a._v("-version")]),a._v(" 更详细的版本信息。")]),a._v(" "),t("h3",{attrs:{id:"_5-8-xloggc-filename"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-8-xloggc-filename"}},[a._v("#")]),a._v(" 5.8 -Xloggc:filename")]),a._v(" "),t("p",[a._v("重定向 GC 事件输出信息到指定的文件。该参数和 "),t("code",[a._v("-verbose:gc")]),a._v(" 输出的信息类似，如果同时指定则会覆盖后者。使用示例：")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("-Xloggc:garbage-collection.log\n")])])]),t("h3",{attrs:{id:"_5-9-xmaxjitcodesize-size"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-9-xmaxjitcodesize-size"}},[a._v("#")]),a._v(" 5.9 -Xmaxjitcodesize=size")]),a._v(" "),t("p",[a._v("指定最大的代码缓存，用于保存 JIT 编译后的代码，该选项和 "),t("code",[a._v("-XX:ReservedCodeCacheSize")]),a._v(" 相等。默认的大小是 240 MB。如果使用 "),t("code",[a._v("-XX:-TieredCompilation")]),a._v(" 禁用了分层编译，则默认大小是 48M。")]),a._v(" "),t("h3",{attrs:{id:"_5-10-xmixed"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-10-xmixed"}},[a._v("#")]),a._v(" 5.10 -Xmixed")]),a._v(" "),t("p",[a._v("使用混合模式执行。热点代码使用编译模式，其他使用解释模式。")]),a._v(" "),t("h3",{attrs:{id:"_5-11-xmnsize"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-11-xmnsize"}},[a._v("#")]),a._v(" 5.11 -Xmnsize")]),a._v(" "),t("p",[a._v("设置年轻代的初始容量和最大容量，默认单位是字节。如下是一些示例：")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("-Xmn256m\n-Xmn262144k\n-Xmn268435456\n")])])]),t("p",[a._v("此外，你也可以使用 "),t("code",[a._v("-XX:NewSize")]),a._v(" 指定初始容量，使用 "),t("code",[a._v("-XX:MaxNewSize")]),a._v(" 指定最大容量。")]),a._v(" "),t("h3",{attrs:{id:"_5-12-xmssize"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-12-xmssize"}},[a._v("#")]),a._v(" 5.12 -Xmssize")]),a._v(" "),t("p",[a._v("设置堆的初始容量，默认单位是字节。必须是 1024 的倍数且大于 1 MB。如下是一些示例：")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("-Xms6291456\n-Xms6144k\n-Xms6m\n")])])]),t("p",[a._v("如果未设置该选项，则初始堆大小为老年代和年轻代分批的容量之和。")]),a._v(" "),t("h3",{attrs:{id:"_5-13-xmxsize"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-13-xmxsize"}},[a._v("#")]),a._v(" 5.13 -Xmxsize")]),a._v(" "),t("p",[a._v("设置堆可分配的最大容量，默认单位是字节，该选项和 "),t("code",[a._v("-XX:MaxHeapSize")]),a._v(" 相等。必须是 1024 的倍数且大于 2 MB。对于服务器来说，通常将 "),t("code",[a._v("-Xms")]),a._v(" 和 "),t("code",[a._v("-Xmx")]),a._v(" 设置为相同值。如下是一些示例：")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("-Xmx83886080\n-Xmx81920k\n-Xmx80m\n")])])]),t("p",[a._v("关于参数优化请查看「"),t("a",{attrs:{href:"https://docs.oracle.com/javase/8/docs/technotes/guides/vm/gctuning/index.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("Java SE HotSpot Virtual Machine Garbage Collection Tuning Guide"),t("OutboundLink")],1),a._v("」。")]),a._v(" "),t("h3",{attrs:{id:"_5-14-xnoclassgc"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-14-xnoclassgc"}},[a._v("#")]),a._v(" 5.14 -Xnoclassgc")]),a._v(" "),t("p",[a._v("禁用类的 GC。这可以节省一些 GC 时间，减少应用程序被打断的次数。开启该参数后，GC 期间不会处理类对象，类对象会一直存活，这将导致更多的永久内存占用，因此需小心使用。")]),a._v(" "),t("h3",{attrs:{id:"_5-15-xprof"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-15-xprof"}},[a._v("#")]),a._v(" 5.15 -Xprof")]),a._v(" "),t("p",[a._v("分析正在执行的程序，把分析数据发送到标准输出。该参数可在开发时使用，不要用到生产环境。")]),a._v(" "),t("h3",{attrs:{id:"_5-16-xrs"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-16-xrs"}},[a._v("#")]),a._v(" 5.16 -Xrs")]),a._v(" "),t("p",[a._v("减少 JVM 对操作系统信号的使用。")]),a._v(" "),t("p",[a._v("使用 shutdown hook 可以在应用程序退出（包括 JVM 异常退出）时按顺序执行一些清理工作（比如关闭数据库连接）。JVM 通过捕获系统信号来实现异常退出时的 shutdown hook，它使用 "),t("code",[a._v("SIGHUP")]),a._v("、"),t("code",[a._v("SIGINT")]),a._v(" 和 "),t("code",[a._v("SIGTERM")]),a._v(" 来初始化正在运行的 shutdown hook。")]),a._v(" "),t("p",[a._v("JVM 使用了类似的机制实现了 dump 线程栈的功能，它使用的是 "),t("code",[a._v("SIGQUIT")]),a._v(" 信号。")]),a._v(" "),t("p",[a._v("嵌入到 JVM 的程序经常需要捕获 "),t("code",[a._v("SIGINT")]),a._v(" 或 "),t("code",[a._v("SIGTERM")]),a._v(" 之类的信号，这可能会干扰 JVM 信号处理的 handler，该选项可用于解决此类问题。")]),a._v(" "),t("p",[a._v("当使用该选项时，JVM 不会修改 "),t("code",[a._v("SIGINT")]),a._v("、"),t("code",[a._v("SIGHUP")]),a._v("、"),t("code",[a._v("SIGTERM")]),a._v(" 和 "),t("code",[a._v("SIGQUIT")]),a._v(" 信号的掩码（mask），也不会设置用于处理这些信号的 handler。因此使用该参数后：")]),a._v(" "),t("ul",[t("li",[t("code",[a._v("SIGQUIT")]),a._v(" 将不会导致线程 dump")]),a._v(" "),t("li",[a._v("用户代码负责触发 shutdown hook，例如在退出前调用 "),t("code",[a._v("System.exit()")])])]),a._v(" "),t("h3",{attrs:{id:"_5-17-xsssize"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-17-xsssize"}},[a._v("#")]),a._v(" 5.17 -Xsssize")]),a._v(" "),t("p",[a._v("设置线程栈的大小，默认单位为字节，该选项与 "),t("code",[a._v("-XX:ThreadStackSize")]),a._v(" 相等。如下是不同平台的默认值：")]),a._v(" "),t("ul",[t("li",[a._v("Linux/ARM (32-bit): 320 KB")]),a._v(" "),t("li",[a._v("Linux/i386 (32-bit): 320 KB")]),a._v(" "),t("li",[a._v("Linux/x64 (64-bit): 1024 KB")]),a._v(" "),t("li",[a._v("OS X (64-bit): 1024 KB")]),a._v(" "),t("li",[a._v("Oracle Solaris/i386 (32-bit): 320 KB")]),a._v(" "),t("li",[a._v("Oracle Solaris/x64 (64-bit): 1024 KB")])]),a._v(" "),t("p",[a._v("如下是将栈大小设置为 1024 KB 的示例：")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("-Xss1m\n-Xss1024k\n-Xss1048576\n")])])]),t("h2",{attrs:{id:"_6-运行时高级选项"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-运行时高级选项"}},[a._v("#")]),a._v(" 6. 运行时高级选项")]),a._v(" "),t("p",[a._v("这些选项用于控制 Java HotSpot 虚拟机运行时的行为。")]),a._v(" "),t("h3",{attrs:{id:"_6-1-xx-printflagsinitial"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-xx-printflagsinitial"}},[a._v("#")]),a._v(" 6.1 -XX:+PrintFlagsInitial")]),a._v(" "),t("p",[a._v("打印 JVM flag 参数的初始值。")]),a._v(" "),t("h3",{attrs:{id:"_6-2-xx-printcommandlineflags"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-xx-printcommandlineflags"}},[a._v("#")]),a._v(" 6.2 -XX:+PrintCommandLineFlags")]),a._v(" "),t("p",[a._v("打印出现在命令行中的 JVM flag 参数。")]),a._v(" "),t("h3",{attrs:{id:"_6-3-xx-disableattachmechanism"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-xx-disableattachmechanism"}},[a._v("#")]),a._v(" 6.3 -XX:+DisableAttachMechanism")]),a._v(" "),t("p",[a._v("启用该选项后会禁用 attach 到 JVM 的机制，使得无法使用 "),t("code",[a._v("jcmd")]),a._v("、 "),t("code",[a._v("jstack")]),a._v("、 "),t("code",[a._v("jmap")]),a._v(" 、"),t("code",[a._v("jinfo")]),a._v(" 等工具。")]),a._v(" "),t("h3",{attrs:{id:"_6-4-xx-maxdirectmemorysize-size"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-4-xx-maxdirectmemorysize-size"}},[a._v("#")]),a._v(" 6.4 -XX:MaxDirectMemorySize=size")]),a._v(" "),t("p",[a._v("设置 NIO 可分配的 direct-buffer 的最大容量，默认单位为字节。")]),a._v(" "),t("h3",{attrs:{id:"_6-5-xx-usebiasedlocking"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-5-xx-usebiasedlocking"}},[a._v("#")]),a._v(" 6.5 -XX:-UseBiasedLocking")]),a._v(" "),t("p",[a._v("禁用偏向锁。该选项默认开启（-XX:+UseBiasedLocking）。关于偏向锁的设置请参考「"),t("a",{attrs:{href:"http://www.oracle.com/technetwork/java/tuning-139912.html#section4.2.5",target:"_blank",rel:"noopener noreferrer"}},[a._v("Java Tuning White Paper"),t("OutboundLink")],1),a._v("」")]),a._v(" "),t("h3",{attrs:{id:"_6-6-xx-usecompressedoops"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-6-xx-usecompressedoops"}},[a._v("#")]),a._v(" 6.6 -XX:-UseCompressedOops")]),a._v(" "),t("p",[a._v("禁用压缩指针。该选项默认开启。压缩指针用于堆内存小于 32 GB 的情况。当开启压缩指针时，使用 32 位的偏移（代替 64 位的指针）表示对象引用。若要在堆大小超过 32 GB 时使用压缩指针，需使用 "),t("code",[a._v("-XX:ObjectAlignmentInBytes")]),a._v(" 选项。")]),a._v(" "),t("h2",{attrs:{id:"_7-jit-编译器高级选项"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-jit-编译器高级选项"}},[a._v("#")]),a._v(" 7. JIT 编译器高级选项")]),a._v(" "),t("p",[a._v("这些选项用于控制 JIT（just-in-time）编译器在 Java HotSpot 虚拟机中的表现。")]),a._v(" "),t("h3",{attrs:{id:"_7-1-xx-compileonly-methods"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-xx-compileonly-methods"}},[a._v("#")]),a._v(" 7.1 -XX:CompileOnly=methods")]),a._v(" "),t("p",[a._v("设置仅编译指定的方法。需使用全类名指定要编译的方法。例如只编译 "),t("code",[a._v("String")]),a._v(" 类的 "),t("code",[a._v("length()")]),a._v(" 方法和 "),t("code",[a._v("List")]),a._v(" 类的 "),t("code",[a._v("size()")]),a._v(" 方法，可使用如下配置：")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("-XX:CompileOnly=java/lang/String.length,java/util/List.size\n")])])]),t("p",[a._v("为方便使用，它同时还支持 "),t("code",[a._v("-XX:+PrintCompilation")]),a._v(" 和 "),t("code",[a._v("-XX:+LogCompilation")]),a._v(" 的输出格式，例如：")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("-XX:CompileOnly=java.lang.String::length,java.util.List::size\n")])])]),t("h3",{attrs:{id:"_7-2-xx-doescapeanalysis"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-xx-doescapeanalysis"}},[a._v("#")]),a._v(" 7.2 -XX:+DoEscapeAnalysis")]),a._v(" "),t("p",[a._v("启用逃逸分析。该选项默认开启。")]),a._v(" "),t("h3",{attrs:{id:"_7-3-xx-initialcodecachesize-size"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-3-xx-initialcodecachesize-size"}},[a._v("#")]),a._v(" 7.3 -XX:InitialCodeCacheSize=size")]),a._v(" "),t("p",[a._v("设置初始代码缓存大小。")]),a._v(" "),t("h3",{attrs:{id:"_7-4-xx-inline"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-4-xx-inline"}},[a._v("#")]),a._v(" 7.4 -XX:+Inline")]),a._v(" "),t("p",[a._v("启用方法内联。")]),a._v(" "),t("h3",{attrs:{id:"_7-5-xx-inlinesmallcode-size"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-5-xx-inlinesmallcode-size"}},[a._v("#")]),a._v(" 7.5 -XX:InlineSmallCode=size")]),a._v(" "),t("p",[a._v("针对已编译方法，设置应该进行内联的方法的最大大小。默认单位为字节。只有已编译的方法且大小小于该值的才会被内联。它的默认值为 1000 字节")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("-XX:InlineSmallCode=1000\n")])])]),t("h3",{attrs:{id:"_7-6-xx-maxinlinesize-size"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-6-xx-maxinlinesize-size"}},[a._v("#")]),a._v(" 7.6 -XX:MaxInlineSize=size")]),a._v(" "),t("p",[a._v("设置要内联的方法的最大字节码大小。默认单位为字节。它的默认值为 35 字节")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("-XX:MaxInlineSize=35\n")])])]),t("h2",{attrs:{id:"_8-可服务化高级选项"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-可服务化高级选项"}},[a._v("#")]),a._v(" 8. 可服务化高级选项")]),a._v(" "),t("p",[a._v("这些选项提供了收集系统信息和执行扩展调试的能力。")]),a._v(" "),t("h3",{attrs:{id:"_8-1-xx-heapdumponoutofmemory"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-1-xx-heapdumponoutofmemory"}},[a._v("#")]),a._v(" 8.1 -XX:+HeapDumpOnOutOfMemory")]),a._v(" "),t("p",[a._v("当 JVM 抛出 "),t("code",[a._v("java.lang.OutOfMemoryError")]),a._v(" 异常时，使用 HPROF（the heap profiler）将 java 堆 dump 到当前目录。该选项默认禁用。")]),a._v(" "),t("h3",{attrs:{id:"_8-2-xx-heapdumppath-path"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-2-xx-heapdumppath-path"}},[a._v("#")]),a._v(" 8.2 -XX:HeapDumpPath=path")]),a._v(" "),t("p",[a._v("与 "),t("code",[a._v("-XX:+HeapDumpOnOutOfMemoryError")]),a._v(" 结合起来使用，用来指定 dump 文件的路径和文件名。如下是一个示例，其中 "),t("code",[a._v("%p")]),a._v(" 表示当前进程的 ID")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("-XX:HeapDumpPath=./java_pid%p.hprof\n")])])]),t("h2",{attrs:{id:"_9-垃圾回收器高级选项"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-垃圾回收器高级选项"}},[a._v("#")]),a._v(" 9. 垃圾回收器高级选项")]),a._v(" "),t("p",[a._v("这些选项用来设置 Java HotSpot 使用的垃圾回收器。")]),a._v(" "),t("h3",{attrs:{id:"_9-1-xx-cmsinitiatingoccupancyfraction-percent"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-1-xx-cmsinitiatingoccupancyfraction-percent"}},[a._v("#")]),a._v(" 9.1 -XX:CMSInitiatingOccupancyFraction=percent")]),a._v(" "),t("p",[a._v("用于设置老年代使用比例到达多少（0 - 100）时执行 CMS 垃圾回收。默认值是 -1。任何负值都意味着使用 "),t("code",[a._v("-XX:CMSTriggerRatio")]),a._v(" 作为初始数值。如下表示设置为 20%")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("-XX:CMSInitiatingOccupancyFraction=20\n")])])]),t("h3",{attrs:{id:"_9-2-xx-cmstriggerratio-percent"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-2-xx-cmstriggerratio-percent"}},[a._v("#")]),a._v(" 9.2 -XX:CMSTriggerRatio=percent")]),a._v(" "),t("p",[a._v("设置一个百分比，表示当 "),t("code",[a._v("-XX:MinHeapFreeRatio")]),a._v(" 指定的值到达多少时执行 CMS 垃圾回收。默认设置为 80%。如下示例将占比设置为 75%")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("-XX:CMSTriggerRatio=75\n")])])]),t("h3",{attrs:{id:"_9-3-xx-concgcthreads-threads"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-3-xx-concgcthreads-threads"}},[a._v("#")]),a._v(" 9.3 -XX:ConcGCThreads=threads")]),a._v(" "),t("p",[a._v("设置并发 GC 使用的线程数。例如设置为 2")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("-XX:ConcGCThreads=2\n")])])]),t("h3",{attrs:{id:"_9-4-xx-disableexplicitgc"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-4-xx-disableexplicitgc"}},[a._v("#")]),a._v(" 9.4 -XX:+DisableExplicitGC")]),a._v(" "),t("p",[a._v("开启该选项会禁用对 "),t("code",[a._v("System.gc()")]),a._v(" 的处理。该选项默认禁用，表示会处理 "),t("code",[a._v("System.gc()")]),a._v(" 调用。若开启该选项，JVM 仍会在必要是执行 GC。")]),a._v(" "),t("h3",{attrs:{id:"_9-5-xx-g1heapregionsize-size"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-5-xx-g1heapregionsize-size"}},[a._v("#")]),a._v(" 9.5 -XX:G1HeapRegionSize=size")]),a._v(" "),t("p",[a._v("当使用 G1（garbage-first）收集器时，使用该选项设置 java 堆划分后的 region 大小。可设置为 1 MB 到 32 MB 之间。默认 region 大小依赖于堆的大小。如下示例将 region 设置为 16 MB")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("-XX:G1HeapRegionSize=16m\n")])])]),t("h3",{attrs:{id:"_9-6-xx-maxgcpausemillis-time"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-6-xx-maxgcpausemillis-time"}},[a._v("#")]),a._v(" 9.6 -XX:MaxGCPauseMillis=time")]),a._v(" "),t("p",[a._v("设置最大 GC 暂停时间（单位为毫秒），JVM 将尽最大努力实现它。如下表示设置为 500 ms")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("-XX:MaxGCPauseMillis=500\n")])])]),t("h3",{attrs:{id:"_9-7-xx-maxmetaspacesize-size"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-7-xx-maxmetaspacesize-size"}},[a._v("#")]),a._v(" 9.7 -XX:MaxMetaspaceSize=size")]),a._v(" "),t("p",[a._v("设置可分配给 class 元数据（metadata）的最大本地内存。")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("-XX:MaxMetaspaceSize=256m\n")])])]),t("h3",{attrs:{id:"_9-8-xx-maxnewsize-size"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-8-xx-maxnewsize-size"}},[a._v("#")]),a._v(" 9.8 -XX:MaxNewSize=size")]),a._v(" "),t("p",[a._v("设置最大的新生代大小。")]),a._v(" "),t("h3",{attrs:{id:"_9-9-xx-maxtenuringthreshold-threshold"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-9-xx-maxtenuringthreshold-threshold"}},[a._v("#")]),a._v(" 9.9 -XX:MaxTenuringThreshold=threshold")]),a._v(" "),t("p",[a._v("设置用于自适应 GC 进入老年代时的最大生存时间（经历多少次 GC）阈值。最大可设置为 15。parallel 收集器默认是 15，CMS 收集器默认是 6。")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("-XX:MaxTenuringThreshold=10\n")])])]),t("h3",{attrs:{id:"_9-10-xx-metaspacesize-size"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-10-xx-metaspacesize-size"}},[a._v("#")]),a._v(" 9.10 -XX:MetaspaceSize=size")]),a._v(" "),t("p",[a._v("设置 class 元数据第一次占用空间到达多少时触发 GC。垃圾回收器会根据 meta 空间的使用情况动态调整该阈值")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("-XX:MinHeapFreeRatio=25\n")])])]),t("h3",{attrs:{id:"_9-11-xx-newratio-ratio"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-11-xx-newratio-ratio"}},[a._v("#")]),a._v(" 9.11 -XX:NewRatio=ratio")]),a._v(" "),t("p",[a._v("设置年轻代和老年代的比值。默认值为 2。如下示例将 young/old 设置为 1")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("-XX:NewRatio=1\n")])])]),t("h3",{attrs:{id:"_9-12-xx-newsize-size"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-12-xx-newsize-size"}},[a._v("#")]),a._v(" 9.12 -XX:NewSize=size")]),a._v(" "),t("p",[a._v("设置年轻代的初始占用空间。")]),a._v(" "),t("h3",{attrs:{id:"_9-13-xx-survivorratio-ratio"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-13-xx-survivorratio-ratio"}},[a._v("#")]),a._v(" 9.13 -XX:SurvivorRatio=ratio")]),a._v(" "),t("p",[a._v("设置 eden 和 survivor 的比例。默认值为 8。如下示例将 eden/survivor 比例设置为 4")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("-XX:SurvivorRatio=4\n")])])]),t("h3",{attrs:{id:"_9-14-xx-printgc"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-14-xx-printgc"}},[a._v("#")]),a._v(" 9.14 -XX:+PrintGC")]),a._v(" "),t("p",[a._v("每次 GC 时打印相关信息。该选项默认禁用。")]),a._v(" "),t("h3",{attrs:{id:"_9-15-xx-printgcdetails"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-15-xx-printgcdetails"}},[a._v("#")]),a._v(" 9.15 -XX:+PrintGCDetails")]),a._v(" "),t("p",[a._v("每次 GC 时打印相关详情信息。该选项默认禁用。")]),a._v(" "),t("h3",{attrs:{id:"_9-16-xx-tlabsize-size"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-16-xx-tlabsize-size"}},[a._v("#")]),a._v(" 9.16 -XX:TLABSize=size")]),a._v(" "),t("p",[a._v("设置单个 TLAB（a thread-local allocation buffer）的初始大小。如果设置为 0，JVM 会自动选择初始大小。")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("-XX:TLABSize=512k\n")])])]),t("h3",{attrs:{id:"_9-17-设置垃圾收集器类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-17-设置垃圾收集器类型"}},[a._v("#")]),a._v(" 9.17 设置垃圾收集器类型")]),a._v(" "),t("h4",{attrs:{id:"_9-17-1-xx-useconcmarksweepgc"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-17-1-xx-useconcmarksweepgc"}},[a._v("#")]),a._v(" 9.17.1 -XX:+UseConcMarkSweepGC")]),a._v(" "),t("p",[a._v("使用 CMS 作为老年代的垃圾收集器，同时会自动设置 "),t("code",[a._v("-XX:+UseParNewGC")]),a._v(" 选项，将 ParNewGC 设置为新生代的垃圾收集器。")]),a._v(" "),t("h4",{attrs:{id:"_9-17-2-xx-useg1gc"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-17-2-xx-useg1gc"}},[a._v("#")]),a._v(" 9.17.2 -XX:+UseG1GC")]),a._v(" "),t("p",[a._v("使用 G1（garbage-first）垃圾收集器。")]),a._v(" "),t("h4",{attrs:{id:"_9-17-3-xx-useparallelgc"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-17-3-xx-useparallelgc"}},[a._v("#")]),a._v(" 9.17.3 -XX:+UseParallelGC")]),a._v(" "),t("p",[a._v("使用 ParallelGC（parallel scavenge garbage collector）垃圾收集器。默认会设置 "),t("code",[a._v("-XX:+UseParallelOldGC")]),a._v("。")]),a._v(" "),t("h4",{attrs:{id:"_9-17-4-xx-useparalleloldgc"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-17-4-xx-useparalleloldgc"}},[a._v("#")]),a._v(" 9.17.4 -XX:+UseParallelOldGC")]),a._v(" "),t("p",[a._v("使用 ParallelOldGC 垃圾收集器处理 full GC。默认会设置 "),t("code",[a._v("-XX:+UseParallelGC")]),a._v("。")]),a._v(" "),t("h4",{attrs:{id:"_9-17-5-xx-useparnewgc"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-17-5-xx-useparnewgc"}},[a._v("#")]),a._v(" 9.17.5 -XX:+UseParNewGC")]),a._v(" "),t("p",[a._v("使用 ParNewGC（parallel threads for collection）作为新生代的垃圾收集器。当设置 "),t("code",[a._v("-XX:+UseConcMarkSweepGC")]),a._v(" 时会自动启用。")]),a._v(" "),t("h4",{attrs:{id:"_9-17-6-xx-useserialgc"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-17-6-xx-useserialgc"}},[a._v("#")]),a._v(" 9.17.6 -XX:+UseSerialGC")]),a._v(" "),t("p",[a._v("使用 SerialGC（serial garbage collector）垃圾收集器")]),a._v(" "),t("h3",{attrs:{id:"_9-18-xx-usetlab"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-18-xx-usetlab"}},[a._v("#")]),a._v(" 9.18 -XX:+UseTLAB")]),a._v(" "),t("p",[a._v("在年轻代启用 TLAB（thread-local allocation blocks）。默认开启。")]),a._v(" "),t("h2",{attrs:{id:"_10-性能调节示例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_10-性能调节示例"}},[a._v("#")]),a._v(" 10. 性能调节示例")]),a._v(" "),t("h3",{attrs:{id:"_10-1-高吞吐量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_10-1-高吞吐量"}},[a._v("#")]),a._v(" 10.1 高吞吐量")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("java -d64 -server -XX:+AggressiveOpts -XX:+UseLargePages -Xmn10g  -Xms26g -Xmx26g\n")])])]),t("h3",{attrs:{id:"_10-2-低延迟"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_10-2-低延迟"}},[a._v("#")]),a._v(" 10.2  低延迟")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("java -d64 -XX:+UseG1GC -Xms26g Xmx26g -XX:MaxGCPauseMillis=500 -XX:+PrintGCTimeStamp\n")])])]),t("h2",{attrs:{id:"_11-我常用的参数配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_11-我常用的参数配置"}},[a._v("#")]),a._v(" 11. 我常用的参数配置")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# JVM参数")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("JVM_OPTS")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"-Dname='),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$AppName")]),a._v('  -Duser.timezone=Asia/Shanghai -Xms512M -Xmx512M -XX:PermSize=256M -XX:MaxPermSize=512M -XX:+HeapDumpOnOutOfMemoryError -XX:+PrintGCDateStamps  -XX:+PrintGCDetails -XX:NewRatio=1 -XX:SurvivorRatio=30 -XX:+UseParallelGC -XX:+UseParallelOldGC"')]),a._v("\n")])])]),t("p",[a._v("主要设置堆大小和方法区（jdk1.8后元空间）大小，配置具体使用什么gc垃圾收集器，打印gc日志")]),a._v(" "),t("ul",[t("li",[t("p",[a._v("标准选项")]),a._v(" "),t("ul",[t("li",[t("p",[a._v("-Dproperty=value")]),a._v(" "),t("p",[a._v("用于设置系统属性（property）值。例如："),t("code",[a._v('-Dfoo="foo bar"')])]),a._v(" "),t("ul",[t("li",[a._v("-Dname=$AppName")]),a._v(" "),t("li",[a._v("-Duser.timezone=Asia/Shanghai")])])])])]),a._v(" "),t("li",[t("p",[a._v("非标准选型")]),a._v(" "),t("ul",[t("li",[t("p",[a._v("-Xmssize")]),a._v(" "),t("p",[a._v("设置堆的初始容量，默认单位是字节。必须是 1024 的倍数且大于 1 MB。")]),a._v(" "),t("ul",[t("li",[a._v("-Xms512M")])])]),a._v(" "),t("li",[t("p",[a._v("-Xmxsize")]),a._v(" "),t("p",[a._v("设置堆可分配的最大容量，默认单位是字节，该选项和 "),t("code",[a._v("-XX:MaxHeapSize")]),a._v(" 相等。必须是 1024 的倍数且大于 2 MB。对于服务器来说，通常将 "),t("code",[a._v("-Xms")]),a._v(" 和 "),t("code",[a._v("-Xmx")]),a._v(" 设置为相同值。")]),a._v(" "),t("ul",[t("li",[a._v("-Xmx512M")])])])])]),a._v(" "),t("li",[t("p",[a._v("垃圾回收器高级选项")]),a._v(" "),t("ul",[t("li",[t("p",[t("s",[a._v("-XX:PermSize (jdk8 已废弃)")])]),a._v(" "),t("p",[t("s",[a._v("JVM中设置永久代"),t("strong",[a._v("最小")]),a._v("空间大小的参数")])]),a._v(" "),t("ul",[t("li",[t("s",[a._v("-XX:PermSize=256M")])])])]),a._v(" "),t("li",[t("p",[t("s",[a._v("-XX:MaxPermSize(jdk8 已废弃)")])]),a._v(" "),t("p",[t("s",[a._v("JVM中设置永久代"),t("strong",[a._v("最大")]),a._v("空间大小的参数")])]),a._v(" "),t("ul",[t("li",[t("s",[a._v("-XX:MaxPermSize=512M")])])])]),a._v(" "),t("li",[t("p",[a._v("-XX:MetaspaceSize（jdk8 新增）")]),a._v(" "),t("p",[a._v("设置 Metaspace 的初始（和最小大小）")]),a._v(" "),t("ul",[t("li",[a._v("一般不配置，则 Metaspace 将根据运行时的应用程序需求动态地重新调整大小")])])]),a._v(" "),t("li",[t("p",[a._v("-XX:MaxMetaspaceSize")]),a._v(" "),t("p",[a._v("设置 Metaspace 的最大大小")]),a._v(" "),t("ul",[t("li",[a._v("一般不配置，默认unlimited，这意味着它只受系统内存的限制")])])]),a._v(" "),t("li",[t("p",[a._v("-XX:+PrintGC")]),a._v(" "),t("p",[a._v("每次 GC 时打印相关信息。该选项默认禁用。")]),a._v(" "),t("ul",[t("li",[a._v("-XX:+PrintGCDateStamps")])])]),a._v(" "),t("li",[t("p",[a._v("-XX:+PrintGCDetails")]),a._v(" "),t("p",[a._v("每次 GC 时打印相关详情信息。该选项默认禁用。")]),a._v(" "),t("ul",[t("li",[a._v("-XX:+PrintGCDetails")])])]),a._v(" "),t("li",[t("p",[a._v("-XX:NewRatio=ratio")]),a._v(" "),t("p",[a._v("设置年轻代和老年代的比值。默认值为 2")]),a._v(" "),t("ul",[t("li",[a._v("-XX:NewRatio=1")])])]),a._v(" "),t("li",[t("p",[a._v("-XX:SurvivorRatio=ratio")]),a._v(" "),t("p",[a._v("设置 eden 和 survivor 的比例。默认值为 8。也就是Eden:S0:S1=8:1:1。")]),a._v(" "),t("ul",[t("li",[a._v("XX:SurvivorRatio=30")])])]),a._v(" "),t("li",[t("p",[a._v("-XX:+UseParallelGC")]),a._v(" "),t("p",[a._v("使用 ParallelGC（parallel scavenge garbage collector）垃圾收集器。。默认会设置 "),t("code",[a._v("-XX:+UseParallelOldGC")]),a._v("。")]),a._v(" "),t("ul",[t("li",[a._v("-XX:+UseParallelGC")])])]),a._v(" "),t("li",[t("p",[a._v("-XX:+UseParallelOldGC")]),a._v(" "),t("p",[a._v("使用 ParallelOldGC 垃圾收集器处理 full GC。默认会设置 "),t("code",[a._v("-XX:+UseParallelGC")]),a._v("。")]),a._v(" "),t("ul",[t("li",[a._v("-XX:+UseParallelOldGC")])])])])]),a._v(" "),t("li",[t("p",[a._v("可服务化高级选项")]),a._v(" "),t("ul",[t("li",[t("p",[a._v("-XX:+HeapDumpOnOutOfMemory")]),a._v(" "),t("p",[a._v("当 JVM 抛出 "),t("code",[a._v("java.lang.OutOfMemoryError")]),a._v(" 异常时，使用 HPROF（the heap profiler）将 java 堆 dump 到当前目录。该选项默认禁用。")]),a._v(" "),t("ul",[t("li",[a._v("-XX:+HeapDumpOnOutOfMemoryError")])])])])])]),a._v(" "),t("h2",{attrs:{id:"参考文章"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[a._v("#")]),a._v(" 参考文章")]),a._v(" "),t("p",[t("a",{attrs:{href:"https://gorden5566.com/post/1024.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("java 命令参数详解"),t("OutboundLink")],1)])])}),[],!1,null,null,null);e.default=_.exports}}]);