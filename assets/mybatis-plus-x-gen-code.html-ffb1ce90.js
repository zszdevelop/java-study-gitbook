import{_ as e,W as o,X as c,Y as n,Z as a,$ as t,a0 as p,D as l}from"./framework-0cf5f349.js";const i={},u=p('<h1 id="springboot集成mysql-mybatis-plus代码自动生成" tabindex="-1"><a class="header-anchor" href="#springboot集成mysql-mybatis-plus代码自动生成" aria-hidden="true">#</a> SpringBoot集成MySQL-MyBatis-Plus代码自动生成</h1><blockquote><p>本文主要介绍 MyBatis-Plus代码自动生成，以及产生此类代码生成工具的背景和此类工具的基本实现原理。</p></blockquote><h2 id="_1-知识准备" tabindex="-1"><a class="header-anchor" href="#_1-知识准备" aria-hidden="true">#</a> 1. 知识准备</h2><blockquote><p>需要了解MyBatis和MyBatis-Plus基础，并了解产生此类代码生成工具的背景和基本原理。</p></blockquote><h3 id="_1-1-mybatis-plus相关" tabindex="-1"><a class="header-anchor" href="#_1-1-mybatis-plus相关" aria-hidden="true">#</a> 1.1 MyBatis-Plus相关</h3>',5),k={href:"https://pdai.tech/md/spring/springboot/springboot-x-mysql-mybatis-plus.html",target:"_blank",rel:"noopener noreferrer"},r=p(`<h3 id="_1-2-为什么会产生此类代码生成工具" tabindex="-1"><a class="header-anchor" href="#_1-2-为什么会产生此类代码生成工具" aria-hidden="true">#</a> 1.2 为什么会产生此类代码生成工具？</h3><p>由于CRUD的工作占了普通开发很多工作，而这些工作是重复的，所以出现了此类的代码生成工具。这些工具通过模板引擎来生成代码，常见于三方集成工具，IDE插件等等。</p><h3 id="_1-3-什么是模板引擎" tabindex="-1"><a class="header-anchor" href="#_1-3-什么是模板引擎" aria-hidden="true">#</a> 1.3 什么是模板引擎？</h3><p>模板引擎可以在代码生成过程中减少大量机械重复工作，大大提高开发效率，良好的设计使得代码重用，后期维护都降低成本。一个好的模板引擎的使用要考虑的方面无外乎：功能是否强大，使用是否简单，整合性、扩展性与灵活性，性能。</p><p>比如：</p><ul><li>Velocity</li><li>FreeMarker</li><li>Thymeleaf</li><li>...</li></ul><figure><img src="https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/image-20220717165115488.png" alt="image-20220717165115488" tabindex="0" loading="lazy"><figcaption>image-20220717165115488</figcaption></figure><h2 id="_2-简单示例" tabindex="-1"><a class="header-anchor" href="#_2-简单示例" aria-hidden="true">#</a> 2. 简单示例</h2><blockquote><p>这里展示通过MyBatis-Plus生成代码实现的</p></blockquote><h3 id="_2-1-准备db" tabindex="-1"><a class="header-anchor" href="#_2-1-准备db" aria-hidden="true">#</a> 2.1 准备DB</h3><p>创建MySQL的schema test_db, 导入SQL 文件如下</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- MySQL dump 10.13  Distrib 5.7.12, for Win64 (x86_64)</span>
<span class="token comment">--</span>
<span class="token comment">-- Host: localhost    Database: test_db</span>
<span class="token comment">-- ------------------------------------------------------</span>
<span class="token comment">-- Server version	5.7.17-log</span>

<span class="token comment">/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40101 SET NAMES utf8 */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40103 SET TIME_ZONE=&#39;+00:00&#39; */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE=&#39;NO_AUTO_VALUE_ON_ZERO&#39; */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */</span><span class="token punctuation">;</span>

<span class="token comment">--</span>
<span class="token comment">-- Table structure for table \`tb_role\`</span>
<span class="token comment">--</span>

<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">\`</span>tb_role<span class="token punctuation">\`</span></span><span class="token punctuation">;</span>
<span class="token comment">/*!40101 SET @saved_cs_client     = @@character_set_client */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40101 SET character_set_client = utf8 */</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">\`</span>tb_role<span class="token punctuation">\`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">\`</span>id<span class="token punctuation">\`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">\`</span>name<span class="token punctuation">\`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">\`</span>role_key<span class="token punctuation">\`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">\`</span>description<span class="token punctuation">\`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">\`</span>create_time<span class="token punctuation">\`</span></span> <span class="token keyword">datetime</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">\`</span>update_time<span class="token punctuation">\`</span></span> <span class="token keyword">datetime</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">\`</span>id<span class="token punctuation">\`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span>
<span class="token comment">/*!40101 SET character_set_client = @saved_cs_client */</span><span class="token punctuation">;</span>

<span class="token comment">--</span>
<span class="token comment">-- Dumping data for table \`tb_role\`</span>
<span class="token comment">--</span>

<span class="token keyword">LOCK</span> <span class="token keyword">TABLES</span> <span class="token identifier"><span class="token punctuation">\`</span>tb_role<span class="token punctuation">\`</span></span> <span class="token keyword">WRITE</span><span class="token punctuation">;</span>
<span class="token comment">/*!40000 ALTER TABLE \`tb_role\` DISABLE KEYS */</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">\`</span>tb_role<span class="token punctuation">\`</span></span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&#39;admin&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;admin&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;admin&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;2021-09-08 17:09:15&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;2021-09-08 17:09:15&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*!40000 ALTER TABLE \`tb_role\` ENABLE KEYS */</span><span class="token punctuation">;</span>
<span class="token keyword">UNLOCK</span> <span class="token keyword">TABLES</span><span class="token punctuation">;</span>

<span class="token comment">--</span>
<span class="token comment">-- Table structure for table \`tb_user\`</span>
<span class="token comment">--</span>

<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">\`</span>tb_user<span class="token punctuation">\`</span></span><span class="token punctuation">;</span>
<span class="token comment">/*!40101 SET @saved_cs_client     = @@character_set_client */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40101 SET character_set_client = utf8 */</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">\`</span>tb_user<span class="token punctuation">\`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">\`</span>id<span class="token punctuation">\`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">\`</span>user_name<span class="token punctuation">\`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">\`</span>password<span class="token punctuation">\`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">\`</span>email<span class="token punctuation">\`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">\`</span>phone_number<span class="token punctuation">\`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">\`</span>description<span class="token punctuation">\`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">\`</span>create_time<span class="token punctuation">\`</span></span> <span class="token keyword">datetime</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">\`</span>update_time<span class="token punctuation">\`</span></span> <span class="token keyword">datetime</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">\`</span>id<span class="token punctuation">\`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span>
<span class="token comment">/*!40101 SET character_set_client = @saved_cs_client */</span><span class="token punctuation">;</span>

<span class="token comment">--</span>
<span class="token comment">-- Dumping data for table \`tb_user\`</span>
<span class="token comment">--</span>

<span class="token keyword">LOCK</span> <span class="token keyword">TABLES</span> <span class="token identifier"><span class="token punctuation">\`</span>tb_user<span class="token punctuation">\`</span></span> <span class="token keyword">WRITE</span><span class="token punctuation">;</span>
<span class="token comment">/*!40000 ALTER TABLE \`tb_user\` DISABLE KEYS */</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">\`</span>tb_user<span class="token punctuation">\`</span></span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&#39;pdai&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;dfasdf&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;suzhou.daipeng@gmail.com&#39;</span><span class="token punctuation">,</span><span class="token number">1212121213</span><span class="token punctuation">,</span><span class="token string">&#39;afsdfsaf&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;2021-09-08 17:09:15&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;2021-09-08 17:09:15&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*!40000 ALTER TABLE \`tb_user\` ENABLE KEYS */</span><span class="token punctuation">;</span>
<span class="token keyword">UNLOCK</span> <span class="token keyword">TABLES</span><span class="token punctuation">;</span>

<span class="token comment">--</span>
<span class="token comment">-- Table structure for table \`tb_user_role\`</span>
<span class="token comment">--</span>

<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">\`</span>tb_user_role<span class="token punctuation">\`</span></span><span class="token punctuation">;</span>
<span class="token comment">/*!40101 SET @saved_cs_client     = @@character_set_client */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40101 SET character_set_client = utf8 */</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">\`</span>tb_user_role<span class="token punctuation">\`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">\`</span>user_id<span class="token punctuation">\`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">\`</span>role_id<span class="token punctuation">\`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span>
<span class="token comment">/*!40101 SET character_set_client = @saved_cs_client */</span><span class="token punctuation">;</span>

<span class="token comment">--</span>
<span class="token comment">-- Dumping data for table \`tb_user_role\`</span>
<span class="token comment">--</span>

<span class="token keyword">LOCK</span> <span class="token keyword">TABLES</span> <span class="token identifier"><span class="token punctuation">\`</span>tb_user_role<span class="token punctuation">\`</span></span> <span class="token keyword">WRITE</span><span class="token punctuation">;</span>
<span class="token comment">/*!40000 ALTER TABLE \`tb_user_role\` DISABLE KEYS */</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">\`</span>tb_user_role<span class="token punctuation">\`</span></span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*!40000 ALTER TABLE \`tb_user_role\` ENABLE KEYS */</span><span class="token punctuation">;</span>
<span class="token keyword">UNLOCK</span> <span class="token keyword">TABLES</span><span class="token punctuation">;</span>
<span class="token comment">/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */</span><span class="token punctuation">;</span>

<span class="token comment">/*!40101 SET SQL_MODE=@OLD_SQL_MODE */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */</span><span class="token punctuation">;</span>
<span class="token comment">/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */</span><span class="token punctuation">;</span>

<span class="token comment">-- Dump completed on 2021-09-08 17:12:11</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-2-添加pom依赖" tabindex="-1"><a class="header-anchor" href="#_2-2-添加pom依赖" aria-hidden="true">#</a> 2.2 添加POM依赖</h3><p>包括mybatis-plus-generator和默认的模板引擎velocity依赖的velocity-engine-core。</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.baomidou<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis-plus-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.5.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.baomidou<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis-plus-generator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.5.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.velocity<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>velocity-engine-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-3-代码生成配置" tabindex="-1"><a class="header-anchor" href="#_2-3-代码生成配置" aria-hidden="true">#</a> 2.3 代码生成配置</h3>`,16),d={href:"https://baomidou.com/pages/d357af/",target:"_blank",rel:"noopener noreferrer"},m=p(`<div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>generator<span class="token punctuation">.</span></span><span class="token class-name">FastAutoGenerator</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * This class is for xxxx.
 *
 * <span class="token keyword">@author</span> pdai
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestGenCode</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">FastAutoGenerator</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">&quot;jdbc:mysql://localhost:3306/test_db?useSSL=false&amp;autoReconnect=true&amp;characterEncoding=utf8&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;bfXa4Pt2lUUScy8jakXf&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">globalConfig</span><span class="token punctuation">(</span>builder <span class="token operator">-&gt;</span>
                        builder<span class="token punctuation">.</span><span class="token function">author</span><span class="token punctuation">(</span><span class="token string">&quot;pdai&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 设置作者</span>
                                <span class="token punctuation">.</span><span class="token function">enableSwagger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 开启 swagger 模式</span>
                <span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">packageConfig</span><span class="token punctuation">(</span>builder <span class="token operator">-&gt;</span>
                        builder<span class="token punctuation">.</span><span class="token function">parent</span><span class="token punctuation">(</span><span class="token string">&quot;tech.pdai.springboot.mysql8.mybatisplus.anno&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 设置父包名</span>
                                <span class="token punctuation">.</span><span class="token function">moduleName</span><span class="token punctuation">(</span><span class="token string">&quot;gencode&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 设置父包模块名</span>
                <span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">strategyConfig</span><span class="token punctuation">(</span>builder <span class="token operator">-&gt;</span>
                        builder<span class="token punctuation">.</span><span class="token function">addInclude</span><span class="token punctuation">(</span><span class="token string">&quot;tb_user&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;tb_role&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;tb_user_role&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-4-生成代码" tabindex="-1"><a class="header-anchor" href="#_2-4-生成代码" aria-hidden="true">#</a> 2.4 生成代码</h3><figure><img src="https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/image-20220717165251409.png" alt="image-20220717165251409" tabindex="0" loading="lazy"><figcaption>image-20220717165251409</figcaption></figure><h2 id="_3-进一步理解" tabindex="-1"><a class="header-anchor" href="#_3-进一步理解" aria-hidden="true">#</a> 3. 进一步理解</h2><blockquote><p>主要了解MyBatis-Plus生成代码的原理。</p></blockquote><h3 id="_3-1-代码生成的基本原理" tabindex="-1"><a class="header-anchor" href="#_3-1-代码生成的基本原理" aria-hidden="true">#</a> 3.1 代码生成的基本原理</h3><blockquote><p>其实代码生成是非常简单的，有了模板引擎的介绍，我们再看下MyBatis-Plus的代码生成工具是如何生成代码的。</p></blockquote><p>配置的装载, FastAutoGenerator本质上就是通过builder注入各种配置，并将它交给代码生成主类：AutoGenerator</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">new</span> <span class="token class-name">AutoGenerator</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dataSourceConfigBuilder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment">// 全局配置</span>
        <span class="token punctuation">.</span><span class="token function">global</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>globalConfigBuilder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment">// 包配置</span>
        <span class="token punctuation">.</span><span class="token function">packageInfo</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>packageConfigBuilder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment">// 策略配置</span>
        <span class="token punctuation">.</span><span class="token function">strategy</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>strategyConfigBuilder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment">// 注入配置</span>
        <span class="token punctuation">.</span><span class="token function">injection</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>injectionConfigBuilder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment">// 模板配置</span>
        <span class="token punctuation">.</span><span class="token function">template</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>templateConfigBuilder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment">// 执行</span>
        <span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>templateEngine<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>AutoGenerator中execute方法，包括初始化配置和模板引擎（默认是Velocity），然后将配置交给模板引擎初始化执行文件输出</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
  * 生成代码
  *
  * <span class="token keyword">@param</span> <span class="token parameter">templateEngine</span> 模板引擎
  */</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token class-name">AbstractTemplateEngine</span> templateEngine<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;==========================准备生成文件...==========================&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 初始化配置</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">==</span> config<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConfigBuilder</span><span class="token punctuation">(</span>packageInfo<span class="token punctuation">,</span> dataSource<span class="token punctuation">,</span> strategy<span class="token punctuation">,</span> template<span class="token punctuation">,</span> globalConfig<span class="token punctuation">,</span> injection<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">==</span> templateEngine<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 为了兼容之前逻辑，采用 Velocity 引擎 【 默认 】</span>
        templateEngine <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VelocityTemplateEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    templateEngine<span class="token punctuation">.</span><span class="token function">setConfigBuilder</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 模板引擎初始化执行文件输出</span>
    templateEngine<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">batchOutput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;==========================文件生成完成！！！==========================&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>模板引擎中batchOuput方法中，包含获取表的信息并根据模板来生成类文件。</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
  * 批量输出 java xml 文件
  */</span>
<span class="token annotation punctuation">@NotNull</span>
<span class="token keyword">public</span> <span class="token class-name">AbstractTemplateEngine</span> <span class="token function">batchOutput</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token class-name">ConfigBuilder</span> config <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getConfigBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TableInfo</span><span class="token punctuation">&gt;</span></span> tableInfoList <span class="token operator">=</span> config<span class="token punctuation">.</span><span class="token function">getTableInfoList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        tableInfoList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>tableInfo <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> objectMap <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getObjectMap</span><span class="token punctuation">(</span>config<span class="token punctuation">,</span> tableInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">ofNullable</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span><span class="token function">getInjectionConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ifPresent</span><span class="token punctuation">(</span>t <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                t<span class="token punctuation">.</span><span class="token function">beforeOutputFile</span><span class="token punctuation">(</span>tableInfo<span class="token punctuation">,</span> objectMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 输出自定义文件</span>
                <span class="token function">outputCustomFile</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">getCustomFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> tableInfo<span class="token punctuation">,</span> objectMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// entity</span>
            <span class="token function">outputEntity</span><span class="token punctuation">(</span>tableInfo<span class="token punctuation">,</span> objectMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// mapper and xml</span>
            <span class="token function">outputMapper</span><span class="token punctuation">(</span>tableInfo<span class="token punctuation">,</span> objectMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// service</span>
            <span class="token function">outputService</span><span class="token punctuation">(</span>tableInfo<span class="token punctuation">,</span> objectMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// controller</span>
            <span class="token function">outputController</span><span class="token punctuation">(</span>tableInfo<span class="token punctuation">,</span> objectMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;无法创建文件，请检查配置信息！&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>获取表的列表，由ConfigBuilder完成</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TableInfo</span><span class="token punctuation">&gt;</span></span> <span class="token function">getTableInfoList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tableInfoList<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// TODO 暂时不开放自定义</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TableInfo</span><span class="token punctuation">&gt;</span></span> tableInfos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IDatabaseQuery<span class="token punctuation">.</span>DefaultDatabaseQuery</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">queryTables</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>tableInfos<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tableInfoList<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>tableInfos<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> tableInfoList<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后获取上述单个表（tableInfo)的具体信息（objectMap)</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
  * 渲染对象 MAP 信息
  *
  * <span class="token keyword">@param</span> <span class="token parameter">config</span>    配置信息
  * <span class="token keyword">@param</span> <span class="token parameter">tableInfo</span> 表信息对象
  * <span class="token keyword">@return</span> ignore
  */</span>
<span class="token annotation punctuation">@NotNull</span>
<span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">getObjectMap</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NotNull</span> <span class="token class-name">ConfigBuilder</span> config<span class="token punctuation">,</span> <span class="token annotation punctuation">@NotNull</span> <span class="token class-name">TableInfo</span> tableInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">StrategyConfig</span> strategyConfig <span class="token operator">=</span> config<span class="token punctuation">.</span><span class="token function">getStrategyConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> controllerData <span class="token operator">=</span> strategyConfig<span class="token punctuation">.</span><span class="token function">controller</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">renderData</span><span class="token punctuation">(</span>tableInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> objectMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>controllerData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> mapperData <span class="token operator">=</span> strategyConfig<span class="token punctuation">.</span><span class="token function">mapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">renderData</span><span class="token punctuation">(</span>tableInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    objectMap<span class="token punctuation">.</span><span class="token function">putAll</span><span class="token punctuation">(</span>mapperData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> serviceData <span class="token operator">=</span> strategyConfig<span class="token punctuation">.</span><span class="token function">service</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">renderData</span><span class="token punctuation">(</span>tableInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    objectMap<span class="token punctuation">.</span><span class="token function">putAll</span><span class="token punctuation">(</span>serviceData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> entityData <span class="token operator">=</span> strategyConfig<span class="token punctuation">.</span><span class="token function">entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">renderData</span><span class="token punctuation">(</span>tableInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    objectMap<span class="token punctuation">.</span><span class="token function">putAll</span><span class="token punctuation">(</span>entityData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    objectMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;config&quot;</span><span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">;</span>
    objectMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;package&quot;</span><span class="token punctuation">,</span> config<span class="token punctuation">.</span><span class="token function">getPackageConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPackageInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">GlobalConfig</span> globalConfig <span class="token operator">=</span> config<span class="token punctuation">.</span><span class="token function">getGlobalConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    objectMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;author&quot;</span><span class="token punctuation">,</span> globalConfig<span class="token punctuation">.</span><span class="token function">getAuthor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    objectMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;kotlin&quot;</span><span class="token punctuation">,</span> globalConfig<span class="token punctuation">.</span><span class="token function">isKotlin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    objectMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;swagger&quot;</span><span class="token punctuation">,</span> globalConfig<span class="token punctuation">.</span><span class="token function">isSwagger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    objectMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;date&quot;</span><span class="token punctuation">,</span> globalConfig<span class="token punctuation">.</span><span class="token function">getCommentDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 启用 schema 处理逻辑</span>
    <span class="token class-name">String</span> schemaName <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>strategyConfig<span class="token punctuation">.</span><span class="token function">isEnableSchema</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 存在 schemaName 设置拼接 . 组合表名</span>
        schemaName <span class="token operator">=</span> config<span class="token punctuation">.</span><span class="token function">getDataSourceConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSchemaName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isNotBlank</span><span class="token punctuation">(</span>schemaName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            schemaName <span class="token operator">+=</span> <span class="token string">&quot;.&quot;</span><span class="token punctuation">;</span>
            tableInfo<span class="token punctuation">.</span><span class="token function">setConvert</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    objectMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;schemaName&quot;</span><span class="token punctuation">,</span> schemaName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    objectMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;table&quot;</span><span class="token punctuation">,</span> tableInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    objectMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;entity&quot;</span><span class="token punctuation">,</span> tableInfo<span class="token punctuation">.</span><span class="token function">getEntityName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> objectMap<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>根据TableInfo和objectMap输出类文件，以输出Entity实体类为例</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
  * 输出实体文件
  *
  * <span class="token keyword">@param</span> <span class="token parameter">tableInfo</span> 表信息
  * <span class="token keyword">@param</span> <span class="token parameter">objectMap</span> 渲染数据
  * <span class="token keyword">@since</span> 3.5.0
  */</span>
<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">outputEntity</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NotNull</span> <span class="token class-name">TableInfo</span> tableInfo<span class="token punctuation">,</span> <span class="token annotation punctuation">@NotNull</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> objectMap<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> entityName <span class="token operator">=</span> tableInfo<span class="token punctuation">.</span><span class="token function">getEntityName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> entityPath <span class="token operator">=</span> <span class="token function">getPathInfo</span><span class="token punctuation">(</span><span class="token class-name">OutputFile</span><span class="token punctuation">.</span>entity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isNotBlank</span><span class="token punctuation">(</span>entityName<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isNotBlank</span><span class="token punctuation">(</span>entityPath<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">getTemplateFilePath</span><span class="token punctuation">(</span>template <span class="token operator">-&gt;</span> template<span class="token punctuation">.</span><span class="token function">getEntity</span><span class="token punctuation">(</span><span class="token function">getConfigBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getGlobalConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isKotlin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ifPresent</span><span class="token punctuation">(</span><span class="token punctuation">(</span>entity<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> entityFile <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token punctuation">(</span>entityPath <span class="token operator">+</span> <span class="token class-name">File</span><span class="token punctuation">.</span>separator <span class="token operator">+</span> <span class="token string">&quot;%s&quot;</span> <span class="token operator">+</span> <span class="token function">suffixJavaOrKt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> entityName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">outputFile</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>entityFile<span class="token punctuation">)</span><span class="token punctuation">,</span> objectMap<span class="token punctuation">,</span> entity<span class="token punctuation">,</span> <span class="token function">getConfigBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getStrategyConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isFileOverride</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在outputFile中来确定生成文件的名字和路径</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
  * 输出文件
  *
  * <span class="token keyword">@param</span> <span class="token parameter">file</span>         文件
  * <span class="token keyword">@param</span> <span class="token parameter">objectMap</span>    渲染信息
  * <span class="token keyword">@param</span> <span class="token parameter">templatePath</span> 模板路径
  * <span class="token keyword">@param</span> <span class="token parameter">fileOverride</span> 是否覆盖已有文件
  * <span class="token keyword">@since</span> 3.5.2
  */</span>
<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">outputFile</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NotNull</span> <span class="token class-name">File</span> file<span class="token punctuation">,</span> <span class="token annotation punctuation">@NotNull</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> objectMap<span class="token punctuation">,</span> <span class="token annotation punctuation">@NotNull</span> <span class="token class-name">String</span> templatePath<span class="token punctuation">,</span> <span class="token keyword">boolean</span> fileOverride<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isCreate</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> fileOverride<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// 全局判断【默认】</span>
            <span class="token keyword">boolean</span> exist <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>exist<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">File</span> parentFile <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">getParentFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">FileUtils</span><span class="token punctuation">.</span><span class="token function">forceMkdir</span><span class="token punctuation">(</span>parentFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token function">writer</span><span class="token punctuation">(</span>objectMap<span class="token punctuation">,</span> templatePath<span class="token punctuation">,</span> file<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> exception<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>exception<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>最后通过writer方法生成文件</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
  * 将模板转化成为文件
  *
  * <span class="token keyword">@param</span> <span class="token parameter">objectMap</span>    渲染对象 MAP 信息
  * <span class="token keyword">@param</span> <span class="token parameter">templatePath</span> 模板文件
  * <span class="token keyword">@param</span> <span class="token parameter">outputFile</span>   文件生成的目录
  * <span class="token keyword">@throws</span> <span class="token reference"><span class="token class-name">Exception</span></span> 异常
  * <span class="token keyword">@since</span> 3.5.0
  */</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">writer</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NotNull</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> objectMap<span class="token punctuation">,</span> <span class="token annotation punctuation">@NotNull</span> <span class="token class-name">String</span> templatePath<span class="token punctuation">,</span> <span class="token annotation punctuation">@NotNull</span> <span class="token class-name">File</span> outputFile<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">writer</span><span class="token punctuation">(</span>objectMap<span class="token punctuation">,</span> templatePath<span class="token punctuation">,</span> outputFile<span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;模板:&quot;</span> <span class="token operator">+</span> templatePath <span class="token operator">+</span> <span class="token string">&quot;;  文件:&quot;</span> <span class="token operator">+</span> outputFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>本质上就是调用模板引擎来生成</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">writer</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NotNull</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> objectMap<span class="token punctuation">,</span> <span class="token annotation punctuation">@NotNull</span> <span class="token class-name">String</span> templatePath<span class="token punctuation">,</span> <span class="token annotation punctuation">@NotNull</span> <span class="token class-name">File</span> outputFile<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">Template</span> template <span class="token operator">=</span> velocityEngine<span class="token punctuation">.</span><span class="token function">getTemplate</span><span class="token punctuation">(</span>templatePath<span class="token punctuation">,</span> <span class="token class-name">ConstVal</span><span class="token punctuation">.</span><span class="token constant">UTF8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">FileOutputStream</span> fos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>outputFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token class-name">OutputStreamWriter</span> ow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OutputStreamWriter</span><span class="token punctuation">(</span>fos<span class="token punctuation">,</span> <span class="token class-name">ConstVal</span><span class="token punctuation">.</span><span class="token constant">UTF8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token class-name">BufferedWriter</span> writer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedWriter</span><span class="token punctuation">(</span>ow<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            template<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">VelocityContext</span><span class="token punctuation">(</span>objectMap<span class="token punctuation">)</span><span class="token punctuation">,</span> writer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>比如Entity，velocityEngine.getTemplate会获取如下entity.vm模板生成Entity的类文件。</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> $<span class="token punctuation">{</span><span class="token class-name"><span class="token namespace">package<span class="token punctuation">.</span></span>Entity</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

#<span class="token function">foreach</span><span class="token punctuation">(</span>$pkg in $<span class="token punctuation">{</span>table<span class="token punctuation">.</span>importPackages<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">import</span> $<span class="token punctuation">{</span>pkg<span class="token punctuation">}</span><span class="token punctuation">;</span>
#end
#<span class="token keyword">if</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>swagger<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>swagger<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">ApiModel</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>swagger<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">ApiModelProperty</span></span><span class="token punctuation">;</span>
#end

<span class="token doc-comment comment">/**
 * <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>
 * $!<span class="token punctuation">{</span>table.comment<span class="token punctuation">}</span>
 * <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
 *
 * <span class="token keyword">@author</span> $<span class="token punctuation">{</span>author<span class="token punctuation">}</span>
 * <span class="token keyword">@since</span> $<span class="token punctuation">{</span>date<span class="token punctuation">}</span>
 */</span>
#<span class="token keyword">if</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>table<span class="token punctuation">.</span>convert<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@TableName</span><span class="token punctuation">(</span><span class="token string">&quot;\${schemaName}\${table.name}&quot;</span><span class="token punctuation">)</span>
#end
#<span class="token keyword">if</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>swagger<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ApiModel</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;\${entity}对象&quot;</span><span class="token punctuation">,</span> description <span class="token operator">=</span> <span class="token string">&quot;$!{table.comment}&quot;</span><span class="token punctuation">)</span>
#end
#<span class="token keyword">if</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>superEntityClass<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> $<span class="token punctuation">{</span>entity<span class="token punctuation">}</span> <span class="token operator">:</span> $<span class="token punctuation">{</span>superEntityClass<span class="token punctuation">}</span>#<span class="token keyword">if</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>activeRecord<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">&lt;</span>$<span class="token punctuation">{</span>entity<span class="token punctuation">}</span><span class="token operator">&gt;</span>#<span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
#<span class="token function">elseif</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>activeRecord<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> $<span class="token punctuation">{</span>entity<span class="token punctuation">}</span> <span class="token operator">:</span> <span class="token class-name">Model</span><span class="token operator">&lt;</span>$<span class="token punctuation">{</span>entity<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
#<span class="token function">elseif</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>entitySerialVersionUID<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> $<span class="token punctuation">{</span>entity<span class="token punctuation">}</span> <span class="token operator">:</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>
#<span class="token keyword">else</span>
<span class="token keyword">class</span> $<span class="token punctuation">{</span>entity<span class="token punctuation">}</span> <span class="token punctuation">{</span>
#end

## <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>  <span class="token constant">BEGIN</span> 字段循环遍历  <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
#<span class="token function">foreach</span><span class="token punctuation">(</span>$field in $<span class="token punctuation">{</span>table<span class="token punctuation">.</span>fields<span class="token punctuation">}</span><span class="token punctuation">)</span>
#<span class="token keyword">if</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>field<span class="token punctuation">.</span>keyFlag<span class="token punctuation">}</span><span class="token punctuation">)</span>
#<span class="token function">set</span><span class="token punctuation">(</span>$keyPropertyName<span class="token operator">=</span>$<span class="token punctuation">{</span>field<span class="token punctuation">.</span>propertyName<span class="token punctuation">}</span><span class="token punctuation">)</span>
#end
#<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">&quot;$!field.comment&quot;</span> <span class="token operator">!=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
    #<span class="token keyword">if</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>swagger<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;\${field.comment}&quot;</span><span class="token punctuation">)</span>
    #<span class="token keyword">else</span>
    <span class="token doc-comment comment">/**
     * $<span class="token punctuation">{</span>field.comment<span class="token punctuation">}</span>
     */</span>
    #end
#end
#<span class="token keyword">if</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>field<span class="token punctuation">.</span>keyFlag<span class="token punctuation">}</span><span class="token punctuation">)</span>
## 主键
#<span class="token keyword">if</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>field<span class="token punctuation">.</span>keyIdentityFlag<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@TableId</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;\${field.annotationColumnName}&quot;</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token class-name">IdType</span><span class="token punctuation">.</span><span class="token constant">AUTO</span><span class="token punctuation">)</span>
#<span class="token function">elseif</span><span class="token punctuation">(</span><span class="token operator">!</span>$<span class="token keyword">null</span><span class="token punctuation">.</span><span class="token function">isNull</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>idType<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token string">&quot;$!idType&quot;</span> <span class="token operator">!=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@TableId</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;\${field.annotationColumnName}&quot;</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token class-name">IdType</span><span class="token punctuation">.</span>$<span class="token punctuation">{</span>idType<span class="token punctuation">}</span><span class="token punctuation">)</span>
#<span class="token function">elseif</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>field<span class="token punctuation">.</span>convert<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@TableId</span><span class="token punctuation">(</span><span class="token string">&quot;\${field.annotationColumnName}&quot;</span><span class="token punctuation">)</span>
#end
## 普通字段
#<span class="token function">elseif</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>field<span class="token punctuation">.</span>fill<span class="token punctuation">}</span><span class="token punctuation">)</span>
## <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>   存在字段填充设置   <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
#<span class="token keyword">if</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>field<span class="token punctuation">.</span>convert<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;\${field.annotationColumnName}&quot;</span><span class="token punctuation">,</span> fill <span class="token operator">=</span> <span class="token class-name">FieldFill</span><span class="token punctuation">.</span>$<span class="token punctuation">{</span>field<span class="token punctuation">.</span>fill<span class="token punctuation">}</span><span class="token punctuation">)</span>
#<span class="token keyword">else</span>
    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span>fill <span class="token operator">=</span> <span class="token class-name">FieldFill</span><span class="token punctuation">.</span>$<span class="token punctuation">{</span>field<span class="token punctuation">.</span>fill<span class="token punctuation">}</span><span class="token punctuation">)</span>
#end
#<span class="token function">elseif</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>field<span class="token punctuation">.</span>convert<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@TableField</span><span class="token punctuation">(</span><span class="token string">&quot;\${field.annotationColumnName}&quot;</span><span class="token punctuation">)</span>
#end
## 乐观锁注解
#<span class="token keyword">if</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>field<span class="token punctuation">.</span>versionField<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Version</span>
#end
## 逻辑删除注解
#<span class="token keyword">if</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>field<span class="token punctuation">.</span>logicDeleteField<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@TableLogic</span>
#end
    #<span class="token keyword">if</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>field<span class="token punctuation">.</span>propertyType<span class="token punctuation">}</span> <span class="token operator">==</span> <span class="token string">&quot;Integer&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">var</span> $<span class="token punctuation">{</span>field<span class="token punctuation">.</span>propertyName<span class="token punctuation">}</span><span class="token operator">:</span> <span class="token class-name">Int</span><span class="token operator">?</span> <span class="token operator">=</span> <span class="token keyword">null</span>
    #<span class="token keyword">else</span>
    <span class="token keyword">var</span> $<span class="token punctuation">{</span>field<span class="token punctuation">.</span>propertyName<span class="token punctuation">}</span><span class="token operator">:</span> $<span class="token punctuation">{</span>field<span class="token punctuation">.</span>propertyType<span class="token punctuation">}</span><span class="token operator">?</span> <span class="token operator">=</span> <span class="token keyword">null</span>
    #end

#end
## <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>  <span class="token constant">END</span> 字段循环遍历  <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
#<span class="token keyword">if</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>entityColumnConstant<span class="token punctuation">}</span><span class="token punctuation">)</span>
    companion object <span class="token punctuation">{</span>
#<span class="token function">foreach</span><span class="token punctuation">(</span>$field in $<span class="token punctuation">{</span>table<span class="token punctuation">.</span>fields<span class="token punctuation">}</span><span class="token punctuation">)</span>

        <span class="token keyword">const</span> val $<span class="token punctuation">{</span>field<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token operator">:</span> <span class="token class-name">String</span> <span class="token operator">=</span> <span class="token string">&quot;\${field.name}&quot;</span>

#end
    <span class="token punctuation">}</span>

#end
#<span class="token keyword">if</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>activeRecord<span class="token punctuation">}</span><span class="token punctuation">)</span>
    override fun <span class="token function">pkVal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Serializable</span><span class="token operator">?</span> <span class="token punctuation">{</span>
#<span class="token keyword">if</span><span class="token punctuation">(</span>$<span class="token punctuation">{</span>keyPropertyName<span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> $<span class="token punctuation">{</span>keyPropertyName<span class="token punctuation">}</span>
#<span class="token keyword">else</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span>
#end
    <span class="token punctuation">}</span>

#end
    override fun <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">String</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;\${entity}{&quot;</span> <span class="token operator">+</span>
#<span class="token function">foreach</span><span class="token punctuation">(</span>$field in $<span class="token punctuation">{</span>table<span class="token punctuation">.</span>fields<span class="token punctuation">}</span><span class="token punctuation">)</span>
#<span class="token keyword">if</span><span class="token punctuation">(</span>$<span class="token operator">!</span><span class="token punctuation">{</span>foreach<span class="token punctuation">.</span>index<span class="token punctuation">}</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token string">&quot;\${field.propertyName}=&quot;</span> <span class="token operator">+</span> $<span class="token punctuation">{</span>field<span class="token punctuation">.</span>propertyName<span class="token punctuation">}</span> <span class="token operator">+</span>
#<span class="token keyword">else</span>
        <span class="token string">&quot;, \${field.propertyName}=&quot;</span> <span class="token operator">+</span> $<span class="token punctuation">{</span>field<span class="token punctuation">.</span>propertyName<span class="token punctuation">}</span> <span class="token operator">+</span>
#end
#end
        <span class="token string">&quot;}&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>同理生成mapper, service, controller等文件。是不是很简单？</p><h3 id="_3-2-如何看mybatis-plus生成代码的功能" tabindex="-1"><a class="header-anchor" href="#_3-2-如何看mybatis-plus生成代码的功能" aria-hidden="true">#</a> 3.2 如何看MyBatis-Plus生成代码的功能？</h3><blockquote><p>简单而言，对于初学者好像能生成代码作用很大，实际情况是很鸡肋！</p></blockquote><ul><li>从上面的源码我们可以看出，生成类只适合单表结构，表的关联无法处理；</li><li>对于单表的CRUD类，如果可以自动化生成，必然是可以很好的抽象的，而BaseMapper, BaseServiceImpl的封装已经足够了；</li><li>通常真正可以通过一体化集成前端代码的生成，才有一定的意义；</li><li>当然少部分情况快速提供接口的可以考虑，不过其实也省不了什么时间。</li></ul><h2 id="参考文章" tabindex="-1"><a class="header-anchor" href="#参考文章" aria-hidden="true">#</a> 参考文章</h2>`,32),v={href:"https://pdai.tech/md/spring/springboot/springboot-x-mysql-mybatis-plus-gen.html",target:"_blank",rel:"noopener noreferrer"},b=n("strong",null,"SpringBoot集成MySQL - MyBatis-Plus代码自动生成",-1);function g(f,y){const s=l("ExternalLinkIcon");return o(),c("div",null,[u,n("p",null,[n("a",k,[a("SpringBoot集成MySQL - MyBatis-Plus方式"),t(s)])]),r,n("blockquote",null,[n("p",null,[a("mybatis-plus-generator 3.5.1 及其以上版本，对历史版本不兼容！3.5.1 以下的请参考"),n("a",d,[a("这里"),t(s)])])]),m,n("p",null,[n("a",v,[b,t(s)])])])}const E=e(i,[["render",g],["__file","mybatis-plus-x-gen-code.html.vue"]]);export{E as default};
