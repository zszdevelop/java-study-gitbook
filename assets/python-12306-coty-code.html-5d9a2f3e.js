import{_ as p,W as o,X as c,Y as n,Z as s,$ as t,a0 as e,D as i}from"./framework-0cf5f349.js";const l={},r=e('<h1 id="python爬取12306城市编码转换" tabindex="-1"><a class="header-anchor" href="#python爬取12306城市编码转换" aria-hidden="true">#</a> python爬取12306城市编码转换</h1><h2 id="_1-背景" tabindex="-1"><a class="header-anchor" href="#_1-背景" aria-hidden="true">#</a> 1. 背景</h2><p>在做项目的时候，遇到铁路城市编码问题。其中：BJP为北京站编码；TJP为天津站编码。</p><p>我们在信息查询-&gt;正晚点-&gt;可以看到station_name.js返回了城市编码信息</p><figure><img src="https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/blogimage-master/img/image-20210202094628947.png" alt="image-20210202094628947" tabindex="0" loading="lazy"><figcaption>image-20210202094628947</figcaption></figure>',5),u=n("strong",null,"请求地址",-1),d={href:"https://kyfw.12306.cn/otn/resources/js/framework/station_name.js",target:"_blank",rel:"noopener noreferrer"},k=e(`<figure><img src="https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/blogimage-master/img/image-20210202095058660.png" alt="image-20210202095058660" tabindex="0" loading="lazy"><figcaption>image-20210202095058660</figcaption></figure><h2 id="_2-爬虫" tabindex="-1"><a class="header-anchor" href="#_2-爬虫" aria-hidden="true">#</a> 2. 爬虫</h2><p>爬虫目的： 从如上链接获取城市对应的三字码</p><ol><li>获取链接内容</li><li>去掉前20个无用字符</li><li>以|分隔，每5个是一组城市</li><li>取每组第二三个，返回dict</li></ol><p>代码如下：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> requests

<span class="token comment"># 由于火车站使用三字码，所以我们需要先获取站点对应的三字码</span>
code_data <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;https://kyfw.12306.cn/otn/resources/js/framework/station_name.js&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>code_data<span class="token punctuation">.</span>text<span class="token punctuation">)</span>

<span class="token comment"># 处理获得的字符串，返回字典类型</span>
<span class="token keyword">def</span> <span class="token function">zip_dic</span><span class="token punctuation">(</span>code_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 去除前20个字符</span>
    code_data <span class="token operator">=</span> code_data<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
    <span class="token comment"># print(code_data)</span>
    <span class="token comment"># 以竖线划分字符，每5个是一组城市信息，每组第二三个是城市编码和城市名称</span>
    list_code <span class="token operator">=</span> code_data<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot;|&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>list_code<span class="token punctuation">)</span>
    a<span class="token operator">=</span><span class="token number">1</span>
    b<span class="token operator">=</span><span class="token number">2</span>
    t1<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    t2<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>a <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>list_code<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        t1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>list_code<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">)</span>
        t2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>list_code<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">)</span>
        a <span class="token operator">=</span> a<span class="token operator">+</span><span class="token number">5</span>
        b <span class="token operator">=</span> b<span class="token operator">+</span><span class="token number">5</span>
    dic <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span>t1<span class="token punctuation">,</span>t2<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> dic

code_dic <span class="token operator">=</span> zip_dic<span class="token punctuation">(</span>code_data<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>code_dic<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-附录" tabindex="-1"><a class="header-anchor" href="#_3-附录" aria-hidden="true">#</a> 3. 附录</h2><p>城市编码和城市转换json文件</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">{</span>
	<span class="token string-property property">&quot;北京北&quot;</span><span class="token operator">:</span> <span class="token string">&quot;VAP&quot;</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;北京东&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BOP&quot;</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;北京&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BJP&quot;</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;北京南&quot;</span><span class="token operator">:</span> <span class="token string">&quot;VNP&quot;</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;北京西&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BXP&quot;</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;广州南&quot;</span><span class="token operator">:</span> <span class="token string">&quot;IZQ&quot;</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;重庆北&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CUW&quot;</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;重庆&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CQW&quot;</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;重庆南&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CRW&quot;</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;重庆西&quot;</span><span class="token operator">:</span> <span class="token string">&quot;CXW&quot;</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;广州东&quot;</span><span class="token operator">:</span> <span class="token string">&quot;GGQ&quot;</span><span class="token punctuation">,</span>
	<span class="token operator">...</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,9),v={href:"https://pan.baidu.com/s/1QYZnGQP7BadfvccHZq6ASA",target:"_blank",rel:"noopener noreferrer"},m=n("h2",{id:"参考文章",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#参考文章","aria-hidden":"true"},"#"),s(" 参考文章")],-1),b={href:"https://blog.csdn.net/kcyxws/article/details/105823767",target:"_blank",rel:"noopener noreferrer"};function g(h,_){const a=i("ExternalLinkIcon");return o(),c("div",null,[r,n("p",null,[u,s("："),n("a",d,[s("https://kyfw.12306.cn/otn/resources/js/framework/station_name.js"),t(a)])]),k,n("p",null,[s("链接："),n("a",v,[s("https://pan.baidu.com/s/1QYZnGQP7BadfvccHZq6ASA"),t(a)]),s(" 提取码：v8cf 复制这段内容后打开百度网盘手机App，操作更方便哦")]),m,n("p",null,[n("a",b,[s("python爬虫：获取12306网站火车站对应三字码"),t(a)])])])}const y=p(l,[["render",g],["__file","python-12306-coty-code.html.vue"]]);export{y as default};
