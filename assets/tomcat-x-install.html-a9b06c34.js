import{_ as c,W as l,X as o,Y as s,Z as n,$ as e,a0 as t,D as p}from"./framework-0cf5f349.js";const i={},r=t('<h1 id="tomcat安装" tabindex="-1"><a class="header-anchor" href="#tomcat安装" aria-hidden="true">#</a> Tomcat安装</h1><h2 id="_1-简介" tabindex="-1"><a class="header-anchor" href="#_1-简介" aria-hidden="true">#</a> 1. 简介</h2><p>企业使用较多的是Tomcat8</p><h2 id="_2-tomcat下载" tabindex="-1"><a class="header-anchor" href="#_2-tomcat下载" aria-hidden="true">#</a> 2. Tomcat下载</h2>',4),u={href:"https://tomcat.apache.org/download-80.cgi",target:"_blank",rel:"noopener noreferrer"},d=t(`<p>Tomcat主要有三个安装版本</p><ul><li><p>tar.gz：Linux环境下的压缩包，免安装</p></li><li><p>Windows.zip：Windows压缩包，免安装，解压即用，同时注意根据自己电脑是64位系统还是32位系统下载对应的压缩包</p></li><li><p>Windows Service Installer：Windows安装包，32位和64位版本的Windows系统都适用</p></li></ul><figure><img src="https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/blogimage-master/image-20210728212527098.png" alt="image-20210728212527098" tabindex="0" loading="lazy"><figcaption>image-20210728212527098</figcaption></figure><h2 id="_3-安装tomcat" tabindex="-1"><a class="header-anchor" href="#_3-安装tomcat" aria-hidden="true">#</a> 3.安装Tomcat</h2><ol><li><p>将下载好的<code>apache-tomcat-8.5.47.tar.gz</code>放到指定目录，我这里放到<code>/usr/local/tomcat</code>，如下图所示</p><figure><img src="https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/blogimage-master/image-20210728212849291.png" alt="image-20210728212849291" tabindex="0" loading="lazy"><figcaption>image-20210728212849291</figcaption></figure></li><li><p>进入<code>/usr/local/tomcat</code>目录，解压Tomcat压缩包</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 进入/usr/local/tomcat目录</span>
<span class="token builtin class-name">cd</span> /usr/local/tomcat
<span class="token comment"># 解压Tomcat压缩包</span>
<span class="token function">tar</span> <span class="token parameter variable">-zxvf</span>  apache-tomcat-8.5.69.tar.gz 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>启动Tomcat</p><p>进入Tomcat的bin目录，启动Tomcat</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 进入Tomcat的bin目录，启动Tomcat</span>
<span class="token builtin class-name">cd</span> apache-tomcat-8.5.69/bin/

<span class="token comment"># 启动Tomcat</span>
./startup.sh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>查看Tomcat是否启动成功</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 查看Tomcat是否启动成功执行</span>
<span class="token function">ps</span> <span class="token parameter variable">-ef</span> <span class="token operator">|</span> <span class="token function">grep</span> tomcat
<span class="token comment"># 如果输出如下，说明Tomcat安装成功</span>
root     <span class="token number">15254</span>     <span class="token number">1</span>  <span class="token number">9</span> <span class="token number">21</span>:30 pts/1    00:00:03 /usr/local/java/jdk1.8.0_181/jre/bin/java <span class="token parameter variable">-Djava.util.logging.config.file</span><span class="token operator">=</span>/usr/local/tomcat/apache-tomcat-8.5.69/conf/log
root     <span class="token number">15982</span> <span class="token number">13726</span>  <span class="token number">0</span> <span class="token number">21</span>:31 pts/1    00:00:00 <span class="token function">grep</span> <span class="token parameter variable">--color</span><span class="token operator">=</span>auto tomcat

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>使用浏览器访问Tomcat</p><p>使用浏览器访问Tomcat，地址Linux的ip:8080，我这里的ip端口是<code>http://ip:8080/</code>，如下图说明在Linux（CentOS7）环境安装启动Tomcat成功</p><p><strong>注意：开放8080端口或者关闭防火墙</strong></p><figure><img src="https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/blogimage-master/image-20210728214559556.png" alt="image-20210728214559556" tabindex="0" loading="lazy"><figcaption>image-20210728214559556</figcaption></figure></li></ol><p><strong>附加：开放8080端口或者关闭防火墙，如果是阿里云只能在阿里云控制台配置开放端口</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 开启8080端口</span>
firewall-cmd <span class="token parameter variable">--zone</span><span class="token operator">=</span>public --add-port<span class="token operator">=</span><span class="token number">8080</span>/tcp <span class="token parameter variable">--permanent</span>

<span class="token comment"># 查询端口号8080是否开启</span>
firewall-cmd --query-port<span class="token operator">=</span><span class="token number">8080</span>/tcp

<span class="token comment"># 重启防火墙</span>
firewall-cmd <span class="token parameter variable">--reload</span>

<span class="token comment"># 查看开放端口列表</span>
firewall-cmd --list-port

<span class="token comment"># 命令含义</span>
<span class="token parameter variable">--zone</span> <span class="token comment">#作用域</span>
--add-port<span class="token operator">=</span><span class="token number">8080</span>/tcp <span class="token comment">#添加端口，格式为：端口/通讯协议</span>
<span class="token parameter variable">--permanent</span> <span class="token comment">#永久生效，没有此参数重启后失效</span>

<span class="token comment"># 关闭防火墙</span>
systemctl stop firewalld.service <span class="token comment">#停止firewall</span>
systemctl disable firewalld.service <span class="token comment">#禁止firewall开机启动</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-设置tomcat为开机启动项" tabindex="-1"><a class="header-anchor" href="#_4-设置tomcat为开机启动项" aria-hidden="true">#</a> 4. 设置Tomcat为开机启动项</h2><p>按照上面的方式启动Tomcat，如果我们的虚拟机或者服务器关闭了，重启服务器后Tomcat是关闭的，但是我们希望虚拟机或者服务器重启后，Tomcat可以自己启动，所以我们需要设置Tomcat为开机启动项</p><p>创建setenv.sh文件，为Tomcat添加启动参数</p><p>catalina.sh在执行的时候会调用同级路径下的setenv.sh来设置额外的环境变量，因此在/usr/local/tomcat/apache-tomcat-8.5.69/bin路径下创建setenv.sh文件，内容如下：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 设置Tomcat的PID文件</span>
<span class="token assign-left variable">CATALINA_PID</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$CATALINA_BASE</span>/tomcat.pid&quot;</span>
<span class="token comment"># 添加JVM选项</span>
<span class="token assign-left variable">JAVA_OPTS</span><span class="token operator">=</span><span class="token string">&quot;-server -XX:PermSize=256M -XX:MaxPermSize=1024m -Xms512M -Xmx1024M -XX:MaxNewSize=256m&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在<code>/usr/local/tomcat/apache-tomcat-8.5.69/bin/catalina.sh</code>文件开头添加<code>JAVA_HOME</code>和<code>JRE_HOME</code>，其中<code>/usr/local/jdk1.8.0_152</code>为jdk的安装目录</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token builtin class-name">export</span> <span class="token assign-left variable">JAVA_HOME</span><span class="token operator">=</span>/usr/local/jdk1.8.0_152
<span class="token builtin class-name">export</span> <span class="token assign-left variable">JRE_HOME</span><span class="token operator">=</span>/usr/local/jdk1.8.0_152/jre
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>如果在catalina.sh不配置JAVA_HOME和JRE_HOME就会报如下的错误</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@JourWon ~<span class="token punctuation">]</span><span class="token comment"># systemctl status tomcat</span>
● tomcat.service - Tomcat
   Loaded: loaded <span class="token punctuation">(</span>/usr/lib/systemd/system/tomcat.service<span class="token punctuation">;</span> enabled<span class="token punctuation">;</span> vendor preset: disabled<span class="token punctuation">)</span>
   Active: failed <span class="token punctuation">(</span>Result: exit-code<span class="token punctuation">)</span> since Mon <span class="token number">2019</span>-10-21 <span class="token number">19</span>:54:54 CST<span class="token punctuation">;</span> 6s ago
  Process: <span class="token number">8746</span> <span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/usr/local/tomcat/apache-tomcat-8.5.47/bin/startup.sh <span class="token punctuation">(</span>code<span class="token operator">=</span>exited, <span class="token assign-left variable">status</span><span class="token operator">=</span><span class="token number">1</span>/FAILURE<span class="token punctuation">)</span>

Oct <span class="token number">21</span> <span class="token number">19</span>:54:54 JourWon systemd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>: Starting Tomcat<span class="token punctuation">..</span>.
Oct <span class="token number">21</span> <span class="token number">19</span>:54:54 JourWon startup.sh<span class="token punctuation">[</span><span class="token number">8746</span><span class="token punctuation">]</span>: Neither the JAVA_HOME nor the JRE_<span class="token punctuation">..</span>.d
Oct <span class="token number">21</span> <span class="token number">19</span>:54:54 JourWon startup.sh<span class="token punctuation">[</span><span class="token number">8746</span><span class="token punctuation">]</span>: At least one of these environment <span class="token punctuation">..</span>.m
Oct <span class="token number">21</span> <span class="token number">19</span>:54:54 JourWon systemd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>: tomcat.service: control process exited,<span class="token punctuation">..</span>.<span class="token operator">=</span><span class="token number">1</span>
Oct <span class="token number">21</span> <span class="token number">19</span>:54:54 JourWon systemd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>: Failed to start Tomcat.
Oct <span class="token number">21</span> <span class="token number">19</span>:54:54 JourWon systemd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>: Unit tomcat.service entered failed state.
Oct <span class="token number">21</span> <span class="token number">19</span>:54:54 JourWon systemd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>: tomcat.service failed.
Hint: Some lines were ellipsized, use <span class="token parameter variable">-l</span> to show <span class="token keyword">in</span> full.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在/usr/lib/systemd/system路径下添加tomcat.service文件，内容如下：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>
<span class="token assign-left variable">Description</span><span class="token operator">=</span>Tomcat
<span class="token assign-left variable">After</span><span class="token operator">=</span>network.target remote-fs.target nss-lookup.target

<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>
<span class="token assign-left variable">Type</span><span class="token operator">=</span>forking
<span class="token assign-left variable">TimeoutSec</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token assign-left variable">PIDFile</span><span class="token operator">=</span>/usr/local/tomcat/apache-tomcat-8.5.47/tomcat.pid
<span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/usr/local/tomcat/apache-tomcat-8.5.47/bin/startup.sh
<span class="token assign-left variable">ExecReload</span><span class="token operator">=</span>/bin/kill <span class="token parameter variable">-s</span> HUP <span class="token variable">$MAINPID</span>
<span class="token assign-left variable">ExecStop</span><span class="token operator">=</span>/bin/kill <span class="token parameter variable">-s</span> QUIT <span class="token variable">$MAINPID</span>
<span class="token assign-left variable">PrivateTmp</span><span class="token operator">=</span>true

<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>
<span class="token assign-left variable">WantedBy</span><span class="token operator">=</span>multi-user.target
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>此外service文件修改后需要调用<code>systemctl daemon-reload</code>命令重新加载。</p><p>配置<code>TimeoutSec=0</code>的目的是让开机启动不处理tomcat启动超时，保证tomcat耗时过长时不会被系统terminating，如果不配置可能出现下面的情况</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>Oct <span class="token number">21</span> <span class="token number">20</span>:26:37 JourWon startup.sh<span class="token punctuation">[</span><span class="token number">1634</span><span class="token punctuation">]</span>: Existing PID <span class="token function">file</span> found during start.
Oct <span class="token number">21</span> <span class="token number">20</span>:26:37 JourWon startup.sh<span class="token punctuation">[</span><span class="token number">1634</span><span class="token punctuation">]</span>: Removing/clearing stale PID file.
Oct <span class="token number">21</span> <span class="token number">20</span>:26:37 JourWon startup.sh<span class="token punctuation">[</span><span class="token number">1634</span><span class="token punctuation">]</span>: Tomcat started.
Oct <span class="token number">21</span> <span class="token number">20</span>:26:37 JourWon systemd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>: PID <span class="token function">file</span> /usr/local/tomcat/apache-tomcat-8.5.47/tomcat.pid not readable <span class="token punctuation">(</span>yet?<span class="token punctuation">)</span> after start.
Oct <span class="token number">21</span> <span class="token number">20</span>:26:38 JourWon polkitd<span class="token punctuation">[</span><span class="token number">464</span><span class="token punctuation">]</span>: Unregistered Authentication Agent <span class="token keyword">for</span> unix-process:1628:19013 <span class="token punctuation">(</span>system bus name :1.23, object path /org/freedesktop/PolicyKit1/AuthenticationAgent, loca
Oct <span class="token number">21</span> <span class="token number">20</span>:28:07 JourWon systemd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>: tomcat.service start operation timed out. Terminating.
Oct <span class="token number">21</span> <span class="token number">20</span>:28:07 JourWon systemd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>: Failed to start Tomcat.

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>把Tomcat加入开机自启动</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>systemctl <span class="token builtin class-name">enable</span> tomcat.service
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>重启服务器</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">reboot</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>再次连接后，查看服务状态</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>systemctl status tomcat
● tomcat.service - Tomcat
   Loaded: loaded <span class="token punctuation">(</span>/usr/lib/systemd/system/tomcat.service<span class="token punctuation">;</span> enabled<span class="token punctuation">;</span> vendor preset: disabled<span class="token punctuation">)</span>
   Active: activating <span class="token punctuation">(</span>start<span class="token punctuation">)</span> since Mon <span class="token number">2019</span>-10-21 <span class="token number">20</span>:12:19 CST<span class="token punctuation">;</span> 8s ago
  Process: <span class="token number">9244</span> <span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/usr/local/tomcat/apache-tomcat-8.5.47/bin/startup.sh <span class="token punctuation">(</span>code<span class="token operator">=</span>exited, <span class="token assign-left variable">status</span><span class="token operator">=</span><span class="token number">0</span>/SUCCESS<span class="token punctuation">)</span>
   CGroup: /system.slice/tomcat.service
           └─9255 /usr/local/jdk1.8.0_152/jre/bin/java <span class="token parameter variable">-Djava.util.logging.config.file</span><span class="token operator">=</span>/usr/local/tomcat/apache-tomcat-8.5.47/conf/logging.properties <span class="token parameter variable">-Djava.util.logging.manager</span><span class="token operator">=</span>org.apac<span class="token punctuation">..</span>.

Oct <span class="token number">21</span> <span class="token number">20</span>:12:19 JourWon systemd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>: Starting Tomcat<span class="token punctuation">..</span>.
Oct <span class="token number">21</span> <span class="token number">20</span>:12:19 JourWon startup.sh<span class="token punctuation">[</span><span class="token number">9244</span><span class="token punctuation">]</span>: Existing PID <span class="token function">file</span> found during start.
Oct <span class="token number">21</span> <span class="token number">20</span>:12:19 JourWon startup.sh<span class="token punctuation">[</span><span class="token number">9244</span><span class="token punctuation">]</span>: Removing/clearing stale PID file.
Oct <span class="token number">21</span> <span class="token number">20</span>:12:19 JourWon startup.sh<span class="token punctuation">[</span><span class="token number">9244</span><span class="token punctuation">]</span>: Tomcat started.
Oct <span class="token number">21</span> <span class="token number">20</span>:12:19 JourWon systemd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>: PID <span class="token function">file</span> /usr/local/tomcat/apache-tomcat-8.5.47/tomcat.pid not readable <span class="token punctuation">(</span>yet?<span class="token punctuation">)</span> after start.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>查看开机启动列表命令</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>systemctl list-unit-files <span class="token operator">|</span> <span class="token function">grep</span> enabled
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>查看Tomcat是否设置为开机启动项，如果显示为enabled，说明设置成功</p><p>参数说明</p><ul><li>static：表示该服务与其他服务相关联,不能单独设置该服务的启动状态</li><li>disabled：表示禁止开机启动</li><li>enabled：表示允许开机启动</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>systemctl list-unit-files <span class="token operator">|</span> <span class="token function">grep</span> tomcat
tomcat.service                                enabled
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="参考文章" tabindex="-1"><a class="header-anchor" href="#参考文章" aria-hidden="true">#</a> 参考文章</h2>`,34),m={href:"https://thinkwon.blog.csdn.net/article/details/102717537",target:"_blank",rel:"noopener noreferrer"};function b(v,k){const a=p("ExternalLinkIcon");return l(),o("div",null,[r,s("p",null,[s("a",u,[n("Tomcat8下载"),e(a)])]),d,s("p",null,[s("a",m,[n("Linux(CentOS7)安装Tomcat与设置Tomcat为开机启动项"),e(a)])])])}const h=c(i,[["render",b],["__file","tomcat-x-install.html.vue"]]);export{h as default};
