<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.59" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://zszdevelop.github.io/java-study-gitbook/java-study-gitbook/db/redis/db-redis-x-performance.html"><meta property="og:site_name" content="Javaå­¦ä¹ ç¬”è®°"><meta property="og:title" content="Redisè¿›é˜¶ - æ€§èƒ½è°ƒä¼˜ï¼šRedisæ€§èƒ½è°ƒä¼˜è¯¦è§£"><meta property="og:description" content="Redis çš„æ€§èƒ½é—®é¢˜ï¼Œæ¶‰åŠåˆ°çš„çŸ¥è¯†ç‚¹éå¸¸å¹¿ï¼Œå‡ ä¹æ¶µç›–äº† CPUã€å†…å­˜ã€ç½‘ç»œã€ç”šè‡³ç£ç›˜çš„æ–¹æ–¹é¢é¢ï¼›åŒæ—¶è¿˜éœ€è¦å¯¹ä¸Šæ–‡ä¸­ä¸€äº›åŸºç¡€æˆ–åº•å±‚æœ‰è¯¦ç»†çš„äº†è§£ã€‚ 1. å‰è¨€ Redis ä½œä¸ºä¼˜ç§€çš„å†…å­˜æ•°æ®åº“ï¼Œå…¶æ‹¥æœ‰éå¸¸é«˜çš„æ€§èƒ½ï¼Œå•ä¸ªå®ä¾‹çš„ OPS èƒ½å¤Ÿè¾¾åˆ° 10W å·¦å³ã€‚ä½†ä¹Ÿæ­£å› æ­¤å¦‚æ­¤ï¼Œå½“æˆ‘ä»¬åœ¨ä½¿ç”¨ Redis æ—¶ï¼Œå¦‚æœå‘ç°æ“ä½œå»¶è¿Ÿå˜å¤§çš„æƒ…å†µï¼Œå°±ä¼šä¸æˆ‘ä»¬çš„é¢„æœŸä¸ç¬¦ã€‚ ..."><meta property="og:type" content="article"><meta property="og:updated_time" content="2023-02-20T13:42:31.000Z"><meta property="og:locale" content="zh-CN"><meta property="article:modified_time" content="2023-02-20T13:42:31.000Z"><script>
          var _hmt = _hmt || [];
          (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?78dc0e0b4e3aedf643d6621778307a6f";
            var s = document.getElementsByTagName("script")[0]; 
            s.parentNode.insertBefore(hm, s);
          })();
      </script><title>Redisè¿›é˜¶ - æ€§èƒ½è°ƒä¼˜ï¼šRedisæ€§èƒ½è°ƒä¼˜è¯¦è§£ | Javaå­¦ä¹ ç¬”è®°</title><meta name="description" content="Redis çš„æ€§èƒ½é—®é¢˜ï¼Œæ¶‰åŠåˆ°çš„çŸ¥è¯†ç‚¹éå¸¸å¹¿ï¼Œå‡ ä¹æ¶µç›–äº† CPUã€å†…å­˜ã€ç½‘ç»œã€ç”šè‡³ç£ç›˜çš„æ–¹æ–¹é¢é¢ï¼›åŒæ—¶è¿˜éœ€è¦å¯¹ä¸Šæ–‡ä¸­ä¸€äº›åŸºç¡€æˆ–åº•å±‚æœ‰è¯¦ç»†çš„äº†è§£ã€‚ 1. å‰è¨€ Redis ä½œä¸ºä¼˜ç§€çš„å†…å­˜æ•°æ®åº“ï¼Œå…¶æ‹¥æœ‰éå¸¸é«˜çš„æ€§èƒ½ï¼Œå•ä¸ªå®ä¾‹çš„ OPS èƒ½å¤Ÿè¾¾åˆ° 10W å·¦å³ã€‚ä½†ä¹Ÿæ­£å› æ­¤å¦‚æ­¤ï¼Œå½“æˆ‘ä»¬åœ¨ä½¿ç”¨ Redis æ—¶ï¼Œå¦‚æœå‘ç°æ“ä½œå»¶è¿Ÿå˜å¤§çš„æƒ…å†µï¼Œå°±ä¼šä¸æˆ‘ä»¬çš„é¢„æœŸä¸ç¬¦ã€‚ ...">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/java-study-gitbook/assets/style-f9854aed.css" as="style"><link rel="stylesheet" href="/java-study-gitbook/assets/style-f9854aed.css">
    <link rel="modulepreload" href="/java-study-gitbook/assets/app-d7a104d1.js"><link rel="modulepreload" href="/java-study-gitbook/assets/framework-0cf5f349.js"><link rel="modulepreload" href="/java-study-gitbook/assets/db-redis-x-performance.html-a3a5d6cd.js"><link rel="modulepreload" href="/java-study-gitbook/assets/db-redis-x-performance.html-9d309122.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/java-study-gitbook/" class="brand"><img class="logo" src="/java-study-gitbook/logo.svg" alt="Javaå­¦ä¹ ç¬”è®°"><!----><span class="site-name hide-in-pad">Javaå­¦ä¹ ç¬”è®°</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Java"><span class="title"><span class="icon iconfont icon-creative"></span>Java</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/java-study-gitbook/java/base/Java-basis-oop.html" class="nav-link" aria-label="JavaåŸºç¡€"><!---->JavaåŸºç¡€<!----></a></li><li class="dropdown-item"><a href="/java-study-gitbook/java/io/java-io-overview.html" class="nav-link" aria-label="Java IO"><!---->Java IO<!----></a></li><li class="dropdown-item"><a href="/java-study-gitbook/java/collection/java-collection-overview.html" class="nav-link" aria-label="Javaé›†åˆ"><!---->Javaé›†åˆ<!----></a></li><li class="dropdown-item"><a href="/java-study-gitbook/java/thread/java-thread-x-theorty.html" class="nav-link" aria-label="Javaå¹¶å‘"><!---->Javaå¹¶å‘<!----></a></li><li class="dropdown-item"><a href="/java-study-gitbook/java/java8/java8-lambda.html" class="nav-link" aria-label="Java8"><!---->Java8<!----></a></li><li class="dropdown-item"><a href="/java-study-gitbook/java/jvm/jvm-overview.html" class="nav-link" aria-label="JVM"><!---->JVM<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="æ•°æ®åº“"><span class="title"><span class="icon iconfont icon-creative"></span>æ•°æ®åº“</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/java-study-gitbook/db/sql/sql-x-basic.html" class="nav-link" aria-label="æ•°æ®åº“åŸºç¡€/SQLåŸºç¡€"><!---->æ•°æ®åº“åŸºç¡€/SQLåŸºç¡€<!----></a></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Sqlæ•°æ®åº“</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java-study-gitbook/db/mysql/sql-mysql-overview.html" class="nav-link" aria-label="Mysql"><!---->Mysql<!----></a></li><li class="dropdown-subitem"><a href="/java-study-gitbook/db/oracle/oracle-b-sequence.html" class="nav-link" aria-label="Oracle"><!---->Oracle<!----></a></li><li class="dropdown-subitem"><a href="/java-study-gitbook/db/dm/dm-operation-console.html" class="nav-link" aria-label="è¾¾æ¢¦"><!---->è¾¾æ¢¦<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>NoSqlæ•°æ®åº“</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java-study-gitbook/db/redis/db-redis-introduce.html" class="nav-link" aria-label="Redis"><!---->Redis<!----></a></li><li class="dropdown-subitem"><a href="/java-study-gitbook/db/mongodb/mongo-x-basic.html" class="nav-link" aria-label="MongoDB"><!---->MongoDB<!----></a></li><li class="dropdown-subitem"><a href="/java-study-gitbook/db/es/elasticsearch-x-introduce-1.html" class="nav-link" aria-label="Elasticsearch"><!---->Elasticsearch<!----></a></li><li class="dropdown-subitem"><a href="/java-study-gitbook/db/neo4j/neo4j-x-tutorial.html" class="nav-link" aria-label="Neo4J"><!---->Neo4J<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="æ¡†æ¶|ä¾èµ–"><span class="title"><span class="icon iconfont icon-creative"></span>æ¡†æ¶|ä¾èµ–</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Spring</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java-study-gitbook/dependencies/spring/spring-overview.html" class="nav-link" aria-label="Spring"><!---->Spring<!----></a></li><li class="dropdown-subitem"><a href="/java-study-gitbook/dependencies/spring-boot/springboot-x-overview.html" class="nav-link" aria-label="SpringBoot"><!---->SpringBoot<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>ORM</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java-study-gitbook/dependencies/mybatis/mybatis-y-arch.html" class="nav-link" aria-label="Mybatis"><!---->Mybatis<!----></a></li><li class="dropdown-subitem"><a href="/java-study-gitbook/dependencies/mybatis-plus/mybatis-plus-x-gen-code.html" class="nav-link" aria-label="Mybatis-Plus"><!---->Mybatis-Plus<!----></a></li></ul></li><li class="dropdown-item"><a href="/java-study-gitbook/dependencies/office/office-x-aspose.html" class="nav-link" aria-label="Officeæ–‡æ¡£æ“ä½œ"><!---->Officeæ–‡æ¡£æ“ä½œ<!----></a></li><li class="dropdown-item"><a href="/java-study-gitbook/dependencies/cas/cas-x-overview.html" class="nav-link" aria-label="CASå•ç‚¹ç™»å½•"><!---->CASå•ç‚¹ç™»å½•<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="å¼€å‘|æµ‹è¯•"><span class="title"><span class="icon iconfont icon-creative"></span>å¼€å‘|æµ‹è¯•</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/java-study-gitbook/develop/devlibrary/dev-lib-lombok.html" class="nav-link" aria-label="å¼€å‘-å¸¸ç”¨ç±»åº“"><span class="icon iconfont icon-creative"></span>å¼€å‘-å¸¸ç”¨ç±»åº“<!----></a></li><li class="dropdown-item"><a href="/java-study-gitbook/develop/security/dev-security-x-injection.html" class="nav-link" aria-label="å¼€å‘-å®‰å…¨"><span class="icon iconfont icon-creative"></span>å¼€å‘-å®‰å…¨<!----></a></li><li class="dropdown-item"><a href="/java-study-gitbook/develop/optimization/optimization-x-interface-optimization.html" class="nav-link" aria-label="å¼€å‘ - ä¼˜åŒ–"><span class="icon iconfont icon-creative"></span>å¼€å‘ - ä¼˜åŒ–<!----></a></li><li class="dropdown-item"><a href="/java-study-gitbook/develop/style/dev-qt-code-style.html" class="nav-link" aria-label="å¼€å‘ - è§„èŒƒ/é£æ ¼"><span class="icon iconfont icon-creative"></span>å¼€å‘ - è§„èŒƒ/é£æ ¼<!----></a></li><li class="dropdown-item"><a href="/java-study-gitbook/develop/test/ut-overview" class="nav-link" aria-label="æµ‹è¯•"><span class="icon iconfont icon-creative"></span>æµ‹è¯•<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="è½¯ä»¶|éƒ¨ç½²"><span class="title"><span class="icon iconfont icon-creative"></span>è½¯ä»¶|éƒ¨ç½²</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/java-study-gitbook/deploy/docker/docker-basic-overview.html" class="nav-link" aria-label="Docker"><span class="icon iconfont icon-creative"></span>Docker<!----></a></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>æ¶ˆæ¯é˜Ÿåˆ—</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java-study-gitbook/deploy/mq/mq-a-overview.html" class="nav-link" aria-label="æ¶ˆæ¯é˜Ÿåˆ—"><!---->æ¶ˆæ¯é˜Ÿåˆ—<!----></a></li><li class="dropdown-subitem"><a href="/java-study-gitbook/deploy/mq-rabbitmq/rabbitmq-x-overview.html" class="nav-link" aria-label="RabbitMQ"><!---->RabbitMQ<!----></a></li><li class="dropdown-subitem"><a href="/java-study-gitbook/deploy/mq-kafka/kafka-x-overview.html" class="nav-link" aria-label="Kafka"><!---->Kafka<!----></a></li></ul></li><li class="dropdown-item"><a href="/java-study-gitbook/deploy/skywalking/skywalking-x-principle.html" class="nav-link" aria-label="Skywalking"><span class="icon iconfont icon-creative"></span>Skywalking<!----></a></li><li class="dropdown-item"><a href="/java-study-gitbook/deploy/linux/linux-j-monitor-overview.html" class="nav-link" aria-label="Linux"><span class="icon iconfont icon-creative"></span>Linux<!----></a></li><li class="dropdown-item"><a href="/java-study-gitbook/deploy/jenkins/jenkins-overview.html" class="nav-link" aria-label="Jenkins"><span class="icon iconfont icon-creative"></span>Jenkins<!----></a></li><li class="dropdown-item"><a href="/java-study-gitbook/deploy/nginx/nginx-x-overview.html" class="nav-link" aria-label="Nginx"><span class="icon iconfont icon-creative"></span>Nginx<!----></a></li><li class="dropdown-item"><a href="/java-study-gitbook/deploy/deploy/docker-basic-overview" class="nav-link" aria-label="éƒ¨ç½²"><span class="icon iconfont icon-creative"></span>éƒ¨ç½²<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="æ¶æ„|ç³»ç»Ÿ"><span class="title"><span class="icon iconfont icon-creative"></span>æ¶æ„|ç³»ç»Ÿ</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/java-study-gitbook/arch/base/arch-basic.html" class="nav-link" aria-label="æ¶æ„åŸºç¡€"><span class="icon iconfont icon-creative"></span>æ¶æ„åŸºç¡€<!----></a></li><li class="dropdown-item"><a href="/java-study-gitbook/arch/distributed/arch-id.html" class="nav-link" aria-label="åˆ†å¸ƒå¼ç³»ç»Ÿ"><span class="icon iconfont icon-creative"></span>åˆ†å¸ƒå¼ç³»ç»Ÿ<!----></a></li><li class="dropdown-item"><a href="/java-study-gitbook/arch/microservices/ms-overview.html" class="nav-link" aria-label="å¾®æœåŠ¡"><span class="icon iconfont icon-creative"></span>å¾®æœåŠ¡<!----></a></li><li class="dropdown-item"><a href="/java-study-gitbook/arch/minio/minio-concept.html" class="nav-link" aria-label="å¯¹è±¡å­˜å‚¨-Minio"><span class="icon iconfont icon-creative"></span>å¯¹è±¡å­˜å‚¨-Minio<!----></a></li><li class="dropdown-item"><a href="/java-study-gitbook/arch/manage-system/manage-system-technical-selection.html" class="nav-link" aria-label="åå°ç®¡ç†ç³»ç»Ÿ"><span class="icon iconfont icon-creative"></span>åå°ç®¡ç†ç³»ç»Ÿ<!----></a></li><li class="dropdown-item"><a href="/java-study-gitbook/arch/mall/mall-sku.html" class="nav-link" aria-label="å•†åŸè®¾è®¡"><span class="icon iconfont icon-creative"></span>å•†åŸè®¾è®¡<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="è¯­è¨€|å¹³å°"><span class="title"><span class="icon iconfont icon-creative"></span>è¯­è¨€|å¹³å°</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/java-study-gitbook/language/frontend-layout/flex-layout-overview.html" class="nav-link" aria-label="å‰ç«¯"><span class="icon iconfont icon-creative"></span>å‰ç«¯<!----></a></li><li class="dropdown-item"><a href="/java-study-gitbook/language/python/python-advantage.html" class="nav-link" aria-label="python"><span class="icon iconfont icon-creative"></span>python<!----></a></li><li class="dropdown-item"><a href="/java-study-gitbook/language/weixin/wx-package-Optimization.html" class="nav-link" aria-label="å¾®ä¿¡"><span class="icon iconfont icon-creative"></span>å¾®ä¿¡<!----></a></li><li class="dropdown-item"><a href="/java-study-gitbook/language/ai/knowledge-graph-build.html" class="nav-link" aria-label="AIäººå·¥æ™ºèƒ½"><span class="icon iconfont icon-creative"></span>AIäººå·¥æ™ºèƒ½<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="æ‚é¡¹|æ€è€ƒ"><span class="title"><span class="icon iconfont icon-creative"></span>æ‚é¡¹|æ€è€ƒ</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/java-study-gitbook/think/deepImpression/redis-bigdata-slow-problem.html" class="nav-link" aria-label="å°è±¡æ·±åˆ»bug"><span class="icon iconfont icon-creative"></span>å°è±¡æ·±åˆ»bug<!----></a></li><li class="dropdown-item"><a href="/java-study-gitbook/think/optimization/optimization-x-frequent-operation-db.html" class="nav-link" aria-label="ä¼˜åŒ–"><span class="icon iconfont icon-creative"></span>ä¼˜åŒ–<!----></a></li><li class="dropdown-item"><a href="/java-study-gitbook/think/misc/misc-x-middleware.html" class="nav-link" aria-label="æ‚é¡¹"><span class="icon iconfont icon-creative"></span>æ‚é¡¹<!----></a></li></ul></button></div></div></nav><!--[--><!----><!--]--></div><div class="navbar-right"><!--[--><!----><!--]--><!----><div class="nav-item"><a class="repo-link" href="https://github.com/zszdevelop/java-study-gitbook" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><div id="docsearch-container"></div><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">SQLåŸºç¡€</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">Mysql</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">Oracle</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">è¾¾æ¢¦</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><!----><span class="title">Redis</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/java-study-gitbook/db/redis/db-redis-introduce.html" class="nav-link sidebar-link sidebar-page" aria-label="Rediså…¥é—¨ - Redisæ¦‚å¿µå’ŒåŸºç¡€"><!---->Rediså…¥é—¨ - Redisæ¦‚å¿µå’ŒåŸºç¡€<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/db-redis-data-types.html" class="nav-link sidebar-link sidebar-page" aria-label="Rediså…¥é—¨ - æ•°æ®ç±»å‹ï¼š5ç§åŸºç¡€æ•°æ®ç±»å‹è¯¦è§£"><!---->Rediså…¥é—¨ - æ•°æ®ç±»å‹ï¼š5ç§åŸºç¡€æ•°æ®ç±»å‹è¯¦è§£<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/db-redis-data-type-special.html" class="nav-link sidebar-link sidebar-page" aria-label="Rediså…¥é—¨ - 3ç§ç‰¹æ®Šç±»å‹è¯¦è§£"><!---->Rediså…¥é—¨ - 3ç§ç‰¹æ®Šç±»å‹è¯¦è§£<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/db-redis-data-type-stream.html" class="nav-link sidebar-link sidebar-page" aria-label="Redisè¿›é˜¶ - æ•°æ®ç±»å‹ï¼šStreamè¯¦è§£"><!---->Redisè¿›é˜¶ - æ•°æ®ç±»å‹ï¼šStreamè¯¦è§£<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/db-redis-x-redis-object.html" class="nav-link sidebar-link sidebar-page" aria-label="Redisè¿›é˜¶ - æ•°æ®ç±»å‹ï¼šå¯¹è±¡æœºåˆ¶è¯¦è§£"><!---->Redisè¿›é˜¶ - æ•°æ®ç±»å‹ï¼šå¯¹è±¡æœºåˆ¶è¯¦è§£<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/db-redis-x-rdb-aof.html" class="nav-link sidebar-link sidebar-page" aria-label="Redisè¿›é˜¶ - æŒä¹…åŒ–ï¼šRDBå’ŒAOFæœºåˆ¶è¯¦è§£"><!---->Redisè¿›é˜¶ - æŒä¹…åŒ–ï¼šRDBå’ŒAOFæœºåˆ¶è¯¦è§£<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/db-redis-x-pub-sub.html" class="nav-link sidebar-link sidebar-page" aria-label="Redisè¿›é˜¶ - æ¶ˆæ¯ä¼ é€’ï¼šå‘å¸ƒè®¢é˜…æ¨¡å¼è¯¦è§£"><!---->Redisè¿›é˜¶ - æ¶ˆæ¯ä¼ é€’ï¼šå‘å¸ƒè®¢é˜…æ¨¡å¼è¯¦è§£<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/db-redis-x-event.html" class="nav-link sidebar-link sidebar-page" aria-label="Redisè¿›é˜¶ - äº‹ä»¶ï¼šRedisäº‹ä»¶æœºåˆ¶è¯¦è§£"><!---->Redisè¿›é˜¶ - äº‹ä»¶ï¼šRedisäº‹ä»¶æœºåˆ¶è¯¦è§£<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/db-redis-x-trans.html" class="nav-link sidebar-link sidebar-page" aria-label="Redisè¿›é˜¶ - äº‹åŠ¡ï¼šRedisäº‹åŠ¡è¯¦è§£"><!---->Redisè¿›é˜¶ - äº‹åŠ¡ï¼šRedisäº‹åŠ¡è¯¦è§£<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/db-redis-x-copy.html" class="nav-link sidebar-link sidebar-page" aria-label="Redisè¿›é˜¶ - é«˜å¯ç”¨ï¼šä¸»ä»å¤åˆ¶è¯¦è§£"><!---->Redisè¿›é˜¶ - é«˜å¯ç”¨ï¼šä¸»ä»å¤åˆ¶è¯¦è§£<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/db-redis-y-install-sentinel.html" class="nav-link sidebar-link sidebar-page" aria-label="Redisè¿›é˜¶ - é«˜å¯ç”¨ï¼šå“¨å…µæœºåˆ¶ï¼ˆRedis Sentinelï¼‰è¯¦è§£"><!---->Redisè¿›é˜¶ - é«˜å¯ç”¨ï¼šå“¨å…µæœºåˆ¶ï¼ˆRedis Sentinelï¼‰è¯¦è§£<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/db-redis-x-cluster.html" class="nav-link sidebar-link sidebar-page" aria-label="Redisè¿›é˜¶ - é«˜å¯æ‹“å±•ï¼šåˆ†ç‰‡æŠ€æœ¯ï¼ˆRedis Clusterï¼‰è¯¦è§£"><!---->Redisè¿›é˜¶ - é«˜å¯æ‹“å±•ï¼šåˆ†ç‰‡æŠ€æœ¯ï¼ˆRedis Clusterï¼‰è¯¦è§£<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/db-redis-x-consistency.html" class="nav-link sidebar-link sidebar-page" aria-label="Redisè¿›é˜¶ - å¦‚ä½•ä¿éšœMySQLå’ŒRedisçš„æ•°æ®ä¸€è‡´æ€§ï¼Ÿ"><!---->Redisè¿›é˜¶ - å¦‚ä½•ä¿éšœMySQLå’ŒRedisçš„æ•°æ®ä¸€è‡´æ€§ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/db-redis-x-cache.html" class="nav-link sidebar-link sidebar-page" aria-label="Redisè¿›é˜¶  -  Redisç¼“å­˜é—®é¢˜ï¼šä¸€è‡´æ€§, ç©¿å‡», ç©¿é€, é›ªå´©, æ±¡æŸ“ç­‰"><!---->Redisè¿›é˜¶  -  Redisç¼“å­˜é—®é¢˜ï¼šä¸€è‡´æ€§, ç©¿å‡», ç©¿é€, é›ªå´©, æ±¡æŸ“ç­‰<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/db-redis-x-hot-key.html" class="nav-link sidebar-link sidebar-page" aria-label="Redisè¿›é˜¶ - Redisçƒ­keyé—®é¢˜"><!---->Redisè¿›é˜¶ - Redisçƒ­keyé—®é¢˜<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="Redisè¿›é˜¶ - æ€§èƒ½è°ƒä¼˜ï¼šRedisæ€§èƒ½è°ƒä¼˜è¯¦è§£"><!---->Redisè¿›é˜¶ - æ€§èƒ½è°ƒä¼˜ï¼šRedisæ€§èƒ½è°ƒä¼˜è¯¦è§£<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_1-å‰è¨€" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1. å‰è¨€"><!---->1. å‰è¨€<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_2-redisçœŸçš„å˜æ…¢äº†å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2. RedisçœŸçš„å˜æ…¢äº†å—ï¼Ÿ"><!---->2. RedisçœŸçš„å˜æ…¢äº†å—ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_2-1-ä»€ä¹ˆæ˜¯åŸºå‡†æ€§èƒ½" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.1 ä»€ä¹ˆæ˜¯åŸºå‡†æ€§èƒ½ï¼Ÿ"><!---->2.1 ä»€ä¹ˆæ˜¯åŸºå‡†æ€§èƒ½ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_2-2-å…·ä½“å¦‚ä½•åš" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.2 å…·ä½“å¦‚ä½•åšï¼Ÿ"><!---->2.2 å…·ä½“å¦‚ä½•åšï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_3-ä½¿ç”¨å¤æ‚åº¦è¿‡é«˜çš„å‘½ä»¤" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3. ä½¿ç”¨å¤æ‚åº¦è¿‡é«˜çš„å‘½ä»¤"><!---->3. ä½¿ç”¨å¤æ‚åº¦è¿‡é«˜çš„å‘½ä»¤<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_4-æ“ä½œbigkey" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4. æ“ä½œbigkey"><!---->4. æ“ä½œbigkey<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_4-1-æŸ¥çœ‹bigkey-çš„åˆ†å¸ƒæƒ…å†µ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.1 æŸ¥çœ‹bigkey çš„åˆ†å¸ƒæƒ…å†µ"><!---->4.1 æŸ¥çœ‹bigkey çš„åˆ†å¸ƒæƒ…å†µ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_4-2-è§£å†³æ–¹æ¡ˆ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.2 è§£å†³æ–¹æ¡ˆ"><!---->4.2 è§£å†³æ–¹æ¡ˆ<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_5-é›†ä¸­è¿‡æœŸ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5. é›†ä¸­è¿‡æœŸ"><!---->5. é›†ä¸­è¿‡æœŸ<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_5-1-ä¸ºä»€ä¹ˆé›†ä¸­è¿‡æœŸä¼šå¯¼è‡´-redis-å»¶è¿Ÿå˜å¤§" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.1 ä¸ºä»€ä¹ˆé›†ä¸­è¿‡æœŸä¼šå¯¼è‡´ Redis å»¶è¿Ÿå˜å¤§ï¼Ÿ"><!---->5.1 ä¸ºä»€ä¹ˆé›†ä¸­è¿‡æœŸä¼šå¯¼è‡´ Redis å»¶è¿Ÿå˜å¤§ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_5-2-é‚£é‡åˆ°è¿™ç§æƒ…å†µ-å¦‚ä½•åˆ†æå’Œæ’æŸ¥" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.2 é‚£é‡åˆ°è¿™ç§æƒ…å†µï¼Œå¦‚ä½•åˆ†æå’Œæ’æŸ¥ï¼Ÿ"><!---->5.2 é‚£é‡åˆ°è¿™ç§æƒ…å†µï¼Œå¦‚ä½•åˆ†æå’Œæ’æŸ¥ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_5-3-è§„é¿é—®é¢˜" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.3 è§„é¿é—®é¢˜"><!---->5.3 è§„é¿é—®é¢˜<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_6-å®ä¾‹å†…å­˜è¾¾åˆ°ä¸Šé™" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="6. å®ä¾‹å†…å­˜è¾¾åˆ°ä¸Šé™"><!---->6. å®ä¾‹å†…å­˜è¾¾åˆ°ä¸Šé™<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_6-1-é—®é¢˜åŸå› " class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="6.1 é—®é¢˜åŸå› "><!---->6.1 é—®é¢˜åŸå› <!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_6-2-è§£å†³" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="6.2 è§£å†³"><!---->6.2 è§£å†³<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_7-forkè€—æ—¶ä¸¥é‡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="7. forkè€—æ—¶ä¸¥é‡"><!---->7. forkè€—æ—¶ä¸¥é‡<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_7-1-ä¼˜åŒ–æ–¹æ¡ˆ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="7.1 ä¼˜åŒ–æ–¹æ¡ˆ"><!---->7.1 ä¼˜åŒ–æ–¹æ¡ˆ<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_8-å¼€å¯å†…å­˜å¤§é¡µ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8. å¼€å¯å†…å­˜å¤§é¡µ"><!---->8. å¼€å¯å†…å­˜å¤§é¡µ<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_8-1-ä»€ä¹ˆæ˜¯å†…å­˜å¤§é¡µ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.1 ä»€ä¹ˆæ˜¯å†…å­˜å¤§é¡µï¼Ÿ"><!---->8.1 ä»€ä¹ˆæ˜¯å†…å­˜å¤§é¡µï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_8-2-è¿™å¯¹-redis-ä¼šæœ‰ä»€ä¹ˆå½±å“å‘¢" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.2 è¿™å¯¹ Redis ä¼šæœ‰ä»€ä¹ˆå½±å“å‘¢ï¼Ÿ"><!---->8.2 è¿™å¯¹ Redis ä¼šæœ‰ä»€ä¹ˆå½±å“å‘¢ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_8-3-é‚£å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.3 é‚£å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿ"><!---->8.3 é‚£å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_9-å¼€å¯aof" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="9. å¼€å¯AOF"><!---->9. å¼€å¯AOF<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_10-ç»‘å®šcpu" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="10. ç»‘å®šCPU"><!---->10. ç»‘å®šCPU<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_10-1-ä¸ºä»€ä¹ˆ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="10.1 ä¸ºä»€ä¹ˆï¼Ÿ"><!---->10.1 ä¸ºä»€ä¹ˆï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_10-2-é‚£å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="10.2 é‚£å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ"><!---->10.2 é‚£å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_10-3-å¦‚ä½•å†è¿›ä¸€æ­¥ä¼˜åŒ–" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="10.3 å¦‚ä½•å†è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Ÿ"><!---->10.3 å¦‚ä½•å†è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_11-ä½¿ç”¨swap" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="11. ä½¿ç”¨Swap"><!---->11. ä½¿ç”¨Swap<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_12-ç¢ç‰‡æ•´ç†" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="12. ç¢ç‰‡æ•´ç†"><!---->12. ç¢ç‰‡æ•´ç†<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_13-ç½‘ç»œå¸¦å®½è¿‡è½½" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="13. ç½‘ç»œå¸¦å®½è¿‡è½½"><!---->13. ç½‘ç»œå¸¦å®½è¿‡è½½<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_14-å…¶ä»–åŸå› " class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="14. å…¶ä»–åŸå› "><!---->14. å…¶ä»–åŸå› <!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_15-æ€»ç»“" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="15. æ€»ç»“"><!---->15. æ€»ç»“<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_16-åè®°" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="16. åè®°"><!---->16. åè®°<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#å‚è€ƒæ–‡ç« " class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å‚è€ƒæ–‡ç« "><!---->å‚è€ƒæ–‡ç« <!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/redis-z-interview-overview.html" class="nav-link sidebar-link sidebar-page" aria-label="Redisé¢è¯• - redisé—®é¢˜æ€»ç»“"><!---->Redisé¢è¯• - redisé—®é¢˜æ€»ç»“<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/redis-z-interview-overview-detail.html" class="nav-link sidebar-link sidebar-page" aria-label="Redisé¢è¯• - redisé—®é¢˜æ€»ç»“(ç­”æ¡ˆç‰ˆ)"><!---->Redisé¢è¯• - redisé—®é¢˜æ€»ç»“(ç­”æ¡ˆç‰ˆ)<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/redis-z-interview-basic.html" class="nav-link sidebar-link sidebar-page" aria-label="Redisé¢è¯• - å¸¸è§„é—®é¢˜"><!---->Redisé¢è¯• - å¸¸è§„é—®é¢˜<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/redis-z-interview-datatype.html" class="nav-link sidebar-link sidebar-page" aria-label="Redisé¢è¯• - æ•°æ®ç±»å‹å’Œæ•°æ®ç»“æ„"><!---->Redisé¢è¯• - æ•°æ®ç±»å‹å’Œæ•°æ®ç»“æ„<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/redis-z-interview-persistence.html" class="nav-link sidebar-link sidebar-page" aria-label="Redisé¢è¯• - æŒä¹…åŒ–å’Œå†…å­˜"><!---->Redisé¢è¯• - æŒä¹…åŒ–å’Œå†…å­˜<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/redis-z-interview-tran.html" class="nav-link sidebar-link sidebar-page" aria-label="Redisé¢è¯• - äº‹åŠ¡"><!---->Redisé¢è¯• - äº‹åŠ¡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/redis-z-interview-master-salve.html" class="nav-link sidebar-link sidebar-page" aria-label="Redisé¢è¯• - é›†ç¾¤-ä¸»ä»å¤åˆ¶"><!---->Redisé¢è¯• - é›†ç¾¤-ä¸»ä»å¤åˆ¶<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/redis-z-interview-sentinel.html" class="nav-link sidebar-link sidebar-page" aria-label="Redisé¢è¯• - é›†ç¾¤-å“¨å…µæœºåˆ¶"><!---->Redisé¢è¯• - é›†ç¾¤-å“¨å…µæœºåˆ¶<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/redis-z-interview-apply.html" class="nav-link sidebar-link sidebar-page" aria-label="Redisé¢è¯• - åº”ç”¨åœºæ™¯"><!---->Redisé¢è¯• - åº”ç”¨åœºæ™¯<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/redis-z-interview-cluster.html" class="nav-link sidebar-link sidebar-page" aria-label="Redisé¢è¯• - é›†ç¾¤-åˆ†ç‰‡æŠ€æœ¯"><!---->Redisé¢è¯• - é›†ç¾¤-åˆ†ç‰‡æŠ€æœ¯<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/redis-z-interview-new.html" class="nav-link sidebar-link sidebar-page" aria-label="Redisé¢è¯• - æ–°ç‰ˆæœ¬"><!---->Redisé¢è¯• - æ–°ç‰ˆæœ¬<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/redis-z-interview-other.html" class="nav-link sidebar-link sidebar-page" aria-label="Redisé¢è¯•  -  å…¶ä»–ç‰¹æ€§"><!---->Redisé¢è¯•  -  å…¶ä»–ç‰¹æ€§<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/redis-x-question-double-write.html" class="nav-link sidebar-link sidebar-page" aria-label="Redisä¿è¯ç¼“å­˜ä¸æ•°æ®åº“åŒå†™æ—¶çš„æ•°æ®ä¸€è‡´æ€§"><!---->Redisä¿è¯ç¼“å­˜ä¸æ•°æ®åº“åŒå†™æ—¶çš„æ•°æ®ä¸€è‡´æ€§<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/db-redis-y-install.html" class="nav-link sidebar-link sidebar-page" aria-label="Rediså®‰è£…"><!---->Rediså®‰è£…<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/redis-y-action-bloom.html" class="nav-link sidebar-link sidebar-page" aria-label="Rediså¸ƒéš†è¿‡æ»¤å™¨"><!---->Rediså¸ƒéš†è¿‡æ»¤å™¨<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/redis-x-cache-penetration.html" class="nav-link sidebar-link sidebar-page" aria-label="Redisç¼“å­˜ç©¿é€"><!---->Redisç¼“å­˜ç©¿é€<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/redis-x-question-ache-valanche.html" class="nav-link sidebar-link sidebar-page" aria-label="Redisç¼“å­˜é›ªå´©"><!---->Redisç¼“å­˜é›ªå´©<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/redis-x-questuin-cache-warm-up.html" class="nav-link sidebar-link sidebar-page" aria-label="Redisç¼“å­˜é¢„çƒ­"><!---->Redisç¼“å­˜é¢„çƒ­<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/redis-y-action-client.html" class="nav-link sidebar-link sidebar-page" aria-label="redisè¿æ¥å®¢æˆ·ç«¯é€‰æ‹©ï¼šJedis,Redisson,Lettuce"><!---->redisè¿æ¥å®¢æˆ·ç«¯é€‰æ‹©ï¼šJedis,Redisson,Lettuce<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/db-redis-hash.html" class="nav-link sidebar-link sidebar-page" aria-label="Redisé›†ç¾¤ï¼šhashå¯»å€ç®—æ³•"><!---->Redisé›†ç¾¤ï¼šhashå¯»å€ç®—æ³•<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/redis-x-sentinel-install.html" class="nav-link sidebar-link sidebar-page" aria-label="Redisé›†ç¾¤æ­å»ºè¯¦è§£"><!---->Redisé›†ç¾¤æ­å»ºè¯¦è§£<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/redis-y-action-springboot.html" class="nav-link sidebar-link sidebar-page" aria-label="Spring Booté›†æˆredisä½¿ç”¨"><!---->Spring Booté›†æˆredisä½¿ç”¨<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/redis-y-action.html" class="nav-link sidebar-link sidebar-page" aria-label="SpringBooté›†æˆredisé¡¹ç›®èŒƒä¾‹"><!---->SpringBooté›†æˆredisé¡¹ç›®èŒƒä¾‹<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/redis-x-quest-key.html" class="nav-link sidebar-link sidebar-page" aria-label="å¦‚ä½•è§£å†³ Redis çš„å¹¶å‘ç«äº‰ Key é—®é¢˜"><!---->å¦‚ä½•è§£å†³ Redis çš„å¹¶å‘ç«äº‰ Key é—®é¢˜<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/db-redis-y-install-remote.html" class="nav-link sidebar-link sidebar-page" aria-label="å¼€å¯è¿œç¨‹è®¿é—®"><!---->å¼€å¯è¿œç¨‹è®¿é—®<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java-study-gitbook/db/redis/redis-y-action-gen-test-data.html" class="nav-link sidebar-link sidebar-page" aria-label="æ‰¹é‡ç”Ÿæˆredisæµ‹è¯•æ•°æ®æ–¹æ³•"><!---->æ‰¹é‡ç”Ÿæˆredisæµ‹è¯•æ•°æ®æ–¹æ³•<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">MongoDB</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">ElasticSearch</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">æœç´¢å¼•æ“-Solr</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">Neo4j</span><span class="arrow right"></span></button><!----></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->Redisè¿›é˜¶ - æ€§èƒ½è°ƒä¼˜ï¼šRedisæ€§èƒ½è°ƒä¼˜è¯¦è§£</h1><div class="page-info"><span class="author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="author-item" href="https://java.isture.com" target="_blank" rel="noopener noreferrer">zszdevelop</a></span><span property="author" content="zszdevelop"></span></span><!----><span class="date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-02-20T13:42:31.000Z"></span><span class="category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><span class="category-item category6" role>æ•°æ®åº“</span><span class="category-item category3" role>Redis</span><meta property="articleSection" content="æ•°æ®åº“,Redis"></span><!----><span class="reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 41 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT41M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">æ­¤é¡µå†…å®¹</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_1-å‰è¨€" class="router-link-active router-link-exact-active toc-link level2">1. å‰è¨€</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_2-redisçœŸçš„å˜æ…¢äº†å—" class="router-link-active router-link-exact-active toc-link level2">2. RedisçœŸçš„å˜æ…¢äº†å—ï¼Ÿ</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_2-1-ä»€ä¹ˆæ˜¯åŸºå‡†æ€§èƒ½" class="router-link-active router-link-exact-active toc-link level3">2.1 ä»€ä¹ˆæ˜¯åŸºå‡†æ€§èƒ½ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_2-2-å…·ä½“å¦‚ä½•åš" class="router-link-active router-link-exact-active toc-link level3">2.2 å…·ä½“å¦‚ä½•åšï¼Ÿ</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_3-ä½¿ç”¨å¤æ‚åº¦è¿‡é«˜çš„å‘½ä»¤" class="router-link-active router-link-exact-active toc-link level2">3. ä½¿ç”¨å¤æ‚åº¦è¿‡é«˜çš„å‘½ä»¤</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_4-æ“ä½œbigkey" class="router-link-active router-link-exact-active toc-link level2">4. æ“ä½œbigkey</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_4-1-æŸ¥çœ‹bigkey-çš„åˆ†å¸ƒæƒ…å†µ" class="router-link-active router-link-exact-active toc-link level3">4.1 æŸ¥çœ‹bigkey çš„åˆ†å¸ƒæƒ…å†µ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_4-2-è§£å†³æ–¹æ¡ˆ" class="router-link-active router-link-exact-active toc-link level3">4.2 è§£å†³æ–¹æ¡ˆ</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_5-é›†ä¸­è¿‡æœŸ" class="router-link-active router-link-exact-active toc-link level2">5. é›†ä¸­è¿‡æœŸ</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_5-1-ä¸ºä»€ä¹ˆé›†ä¸­è¿‡æœŸä¼šå¯¼è‡´-redis-å»¶è¿Ÿå˜å¤§" class="router-link-active router-link-exact-active toc-link level3">5.1 ä¸ºä»€ä¹ˆé›†ä¸­è¿‡æœŸä¼šå¯¼è‡´ Redis å»¶è¿Ÿå˜å¤§ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_5-2-é‚£é‡åˆ°è¿™ç§æƒ…å†µ-å¦‚ä½•åˆ†æå’Œæ’æŸ¥" class="router-link-active router-link-exact-active toc-link level3">5.2 é‚£é‡åˆ°è¿™ç§æƒ…å†µï¼Œå¦‚ä½•åˆ†æå’Œæ’æŸ¥ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_5-3-è§„é¿é—®é¢˜" class="router-link-active router-link-exact-active toc-link level3">5.3 è§„é¿é—®é¢˜</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_6-å®ä¾‹å†…å­˜è¾¾åˆ°ä¸Šé™" class="router-link-active router-link-exact-active toc-link level2">6. å®ä¾‹å†…å­˜è¾¾åˆ°ä¸Šé™</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_6-1-é—®é¢˜åŸå› " class="router-link-active router-link-exact-active toc-link level3">6.1 é—®é¢˜åŸå› </a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_6-2-è§£å†³" class="router-link-active router-link-exact-active toc-link level3">6.2 è§£å†³</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_7-forkè€—æ—¶ä¸¥é‡" class="router-link-active router-link-exact-active toc-link level2">7. forkè€—æ—¶ä¸¥é‡</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_7-1-ä¼˜åŒ–æ–¹æ¡ˆ" class="router-link-active router-link-exact-active toc-link level3">7.1 ä¼˜åŒ–æ–¹æ¡ˆ</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_8-å¼€å¯å†…å­˜å¤§é¡µ" class="router-link-active router-link-exact-active toc-link level2">8. å¼€å¯å†…å­˜å¤§é¡µ</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_8-1-ä»€ä¹ˆæ˜¯å†…å­˜å¤§é¡µ" class="router-link-active router-link-exact-active toc-link level3">8.1 ä»€ä¹ˆæ˜¯å†…å­˜å¤§é¡µï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_8-2-è¿™å¯¹-redis-ä¼šæœ‰ä»€ä¹ˆå½±å“å‘¢" class="router-link-active router-link-exact-active toc-link level3">8.2 è¿™å¯¹ Redis ä¼šæœ‰ä»€ä¹ˆå½±å“å‘¢ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_8-3-é‚£å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜" class="router-link-active router-link-exact-active toc-link level3">8.3 é‚£å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿ</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_9-å¼€å¯aof" class="router-link-active router-link-exact-active toc-link level2">9. å¼€å¯AOF</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_10-ç»‘å®šcpu" class="router-link-active router-link-exact-active toc-link level2">10. ç»‘å®šCPU</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_10-1-ä¸ºä»€ä¹ˆ" class="router-link-active router-link-exact-active toc-link level3">10.1 ä¸ºä»€ä¹ˆï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_10-2-é‚£å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢" class="router-link-active router-link-exact-active toc-link level3">10.2 é‚£å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_10-3-å¦‚ä½•å†è¿›ä¸€æ­¥ä¼˜åŒ–" class="router-link-active router-link-exact-active toc-link level3">10.3 å¦‚ä½•å†è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Ÿ</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_11-ä½¿ç”¨swap" class="router-link-active router-link-exact-active toc-link level2">11. ä½¿ç”¨Swap</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_12-ç¢ç‰‡æ•´ç†" class="router-link-active router-link-exact-active toc-link level2">12. ç¢ç‰‡æ•´ç†</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_13-ç½‘ç»œå¸¦å®½è¿‡è½½" class="router-link-active router-link-exact-active toc-link level2">13. ç½‘ç»œå¸¦å®½è¿‡è½½</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_14-å…¶ä»–åŸå› " class="router-link-active router-link-exact-active toc-link level2">14. å…¶ä»–åŸå› </a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_15-æ€»ç»“" class="router-link-active router-link-exact-active toc-link level2">15. æ€»ç»“</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#_16-åè®°" class="router-link-active router-link-exact-active toc-link level2">16. åè®°</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java-study-gitbook/db/redis/db-redis-x-performance.html#å‚è€ƒæ–‡ç« " class="router-link-active router-link-exact-active toc-link level2">å‚è€ƒæ–‡ç« </a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h1 id="redisè¿›é˜¶-æ€§èƒ½è°ƒä¼˜-redisæ€§èƒ½è°ƒä¼˜è¯¦è§£" tabindex="-1"><a class="header-anchor" href="#redisè¿›é˜¶-æ€§èƒ½è°ƒä¼˜-redisæ€§èƒ½è°ƒä¼˜è¯¦è§£" aria-hidden="true">#</a> Redisè¿›é˜¶ - æ€§èƒ½è°ƒä¼˜ï¼šRedisæ€§èƒ½è°ƒä¼˜è¯¦è§£</h1><blockquote><p>Redis çš„æ€§èƒ½é—®é¢˜ï¼Œæ¶‰åŠåˆ°çš„çŸ¥è¯†ç‚¹éå¸¸å¹¿ï¼Œå‡ ä¹æ¶µç›–äº† CPUã€å†…å­˜ã€ç½‘ç»œã€ç”šè‡³ç£ç›˜çš„æ–¹æ–¹é¢é¢ï¼›åŒæ—¶è¿˜éœ€è¦å¯¹ä¸Šæ–‡ä¸­ä¸€äº›åŸºç¡€æˆ–åº•å±‚æœ‰è¯¦ç»†çš„äº†è§£ã€‚</p></blockquote><h2 id="_1-å‰è¨€" tabindex="-1"><a class="header-anchor" href="#_1-å‰è¨€" aria-hidden="true">#</a> 1. å‰è¨€</h2><blockquote><p>Redis ä½œä¸ºä¼˜ç§€çš„å†…å­˜æ•°æ®åº“ï¼Œå…¶æ‹¥æœ‰éå¸¸é«˜çš„æ€§èƒ½ï¼Œå•ä¸ªå®ä¾‹çš„ OPS èƒ½å¤Ÿè¾¾åˆ° 10W å·¦å³ã€‚ä½†ä¹Ÿæ­£å› æ­¤å¦‚æ­¤ï¼Œå½“æˆ‘ä»¬åœ¨ä½¿ç”¨ Redis æ—¶ï¼Œå¦‚æœå‘ç°æ“ä½œå»¶è¿Ÿå˜å¤§çš„æƒ…å†µï¼Œå°±ä¼šä¸æˆ‘ä»¬çš„é¢„æœŸä¸ç¬¦ã€‚</p></blockquote><p>ä½ ä¹Ÿè®¸æˆ–å¤šæˆ–å°‘åœ°ï¼Œä¹Ÿé‡åˆ°è¿‡ä»¥ä¸‹è¿™äº›åœºæ™¯ï¼š</p><ul><li>åœ¨ Redis ä¸Šæ‰§è¡ŒåŒæ ·çš„å‘½ä»¤ï¼Œä¸ºä»€ä¹ˆæœ‰æ—¶å“åº”å¾ˆå¿«ï¼Œæœ‰æ—¶å´å¾ˆæ…¢ï¼Ÿ</li><li>ä¸ºä»€ä¹ˆ Redis æ‰§è¡Œ SETã€DEL å‘½ä»¤è€—æ—¶ä¹Ÿå¾ˆä¹…ï¼Ÿ</li><li>ä¸ºä»€ä¹ˆæˆ‘çš„ Redis çªç„¶æ…¢äº†ä¸€æ³¢ï¼Œä¹‹ååˆæ¢å¤æ­£å¸¸äº†ï¼Ÿ</li><li>ä¸ºä»€ä¹ˆæˆ‘çš„ Redis ç¨³å®šè¿è¡Œäº†å¾ˆä¹…ï¼Œçªç„¶ä»æŸä¸ªæ—¶é—´ç‚¹å¼€å§‹å˜æ…¢äº†ï¼Ÿ</li><li>...</li></ul><p>å¦‚æœä½ å¹¶ä¸æ¸…æ¥š Redis å†…éƒ¨çš„å®ç°åŸç†ï¼Œé‚£ä¹ˆåœ¨æ’æŸ¥è¿™ç§å»¶è¿Ÿé—®é¢˜æ—¶å°±ä¼šä¸€å¤´é›¾æ°´ã€‚</p><p>å¦‚æœä½ ä¹Ÿé‡åˆ°äº†ä»¥ä¸Šæƒ…å†µï¼Œé‚£ä¹ˆï¼Œè¿™ç¯‡æ–‡ç« å°†ä¼šç»™ä½ ä¸€ä¸ªã€Œå…¨é¢ã€çš„é—®é¢˜æ’æŸ¥æ€è·¯ï¼Œå¹¶ä¸”é’ˆå¯¹è¿™äº›å¯¼è‡´å˜æ…¢çš„åœºæ™¯ï¼Œæˆ‘è¿˜ä¼šç»™ä½ ä¸€ä¸ªé«˜æ•ˆçš„è§£å†³æ–¹æ¡ˆã€‚</p><h2 id="_2-redisçœŸçš„å˜æ…¢äº†å—" tabindex="-1"><a class="header-anchor" href="#_2-redisçœŸçš„å˜æ…¢äº†å—" aria-hidden="true">#</a> 2. RedisçœŸçš„å˜æ…¢äº†å—ï¼Ÿ</h2><blockquote><p>é¦–å…ˆï¼Œåœ¨å¼€å§‹ä¹‹å‰ï¼Œä½ éœ€è¦å¼„æ¸…æ¥š Redis æ˜¯å¦çœŸçš„å˜æ…¢äº†ï¼Ÿ</p></blockquote><p>å¦‚æœä½ å‘ç°ä½ çš„ä¸šåŠ¡æœåŠ¡ API å“åº”å»¶è¿Ÿå˜é•¿ï¼Œé¦–å…ˆä½ éœ€è¦å…ˆæ’æŸ¥æœåŠ¡å†…éƒ¨ï¼Œç©¶ç«Ÿæ˜¯å“ªä¸ªç¯èŠ‚æ‹–æ…¢äº†æ•´ä¸ªæœåŠ¡ã€‚</p><p>æ¯”è¾ƒé«˜æ•ˆçš„åšæ³•æ˜¯ï¼Œåœ¨æœåŠ¡å†…éƒ¨é›†æˆé“¾è·¯è¿½è¸ªï¼Œä¹Ÿå°±æ˜¯åœ¨æœåŠ¡è®¿é—®å¤–éƒ¨ä¾èµ–çš„å‡ºå…¥å£ï¼Œè®°å½•ä¸‹æ¯æ¬¡è¯·æ±‚å¤–éƒ¨ä¾èµ–çš„å“åº”å»¶æ—¶ã€‚</p><img src="https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/image-20220627222146095.png" alt="image-20220627222146095"><p>å¦‚æœä½ å‘ç°ç¡®å®æ˜¯æ“ä½œ Redis çš„è¿™æ¡é“¾è·¯è€—æ—¶å˜é•¿äº†ï¼Œé‚£ä¹ˆæ­¤åˆ»ä½ éœ€è¦æŠŠç„¦ç‚¹å…³æ³¨åœ¨ä¸šåŠ¡æœåŠ¡åˆ° Redis è¿™æ¡é“¾è·¯ä¸Šã€‚</p><p>ä»ä½ çš„ä¸šåŠ¡æœåŠ¡åˆ° Redis è¿™æ¡é“¾è·¯å˜æ…¢çš„åŸå› å¯èƒ½ä¹Ÿæœ‰ 2 ä¸ªï¼š</p><ul><li>ä¸šåŠ¡æœåŠ¡å™¨åˆ° Redis æœåŠ¡å™¨ä¹‹é—´çš„ç½‘ç»œå­˜åœ¨é—®é¢˜ï¼Œä¾‹å¦‚ç½‘ç»œçº¿è·¯è´¨é‡ä¸ä½³ï¼Œç½‘ç»œæ•°æ®åŒ…åœ¨ä¼ è¾“æ—¶å­˜åœ¨å»¶è¿Ÿã€ä¸¢åŒ…ç­‰æƒ…å†µ</li><li>Redis æœ¬èº«å­˜åœ¨é—®é¢˜ï¼Œéœ€è¦è¿›ä¸€æ­¥æ’æŸ¥æ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´ Redis å˜æ…¢</li></ul><p>é€šå¸¸æ¥è¯´ï¼Œç¬¬ä¸€ç§æƒ…å†µå‘ç”Ÿçš„æ¦‚ç‡æ¯”è¾ƒå°ï¼Œå¦‚æœæ˜¯æœåŠ¡å™¨ä¹‹é—´ç½‘ç»œå­˜åœ¨é—®é¢˜ï¼Œé‚£éƒ¨ç½²åœ¨è¿™å°ä¸šåŠ¡æœåŠ¡å™¨ä¸Šçš„æ‰€æœ‰æœåŠ¡éƒ½ä¼šå‘ç”Ÿç½‘ç»œå»¶è¿Ÿçš„æƒ…å†µï¼Œæ­¤æ—¶ä½ éœ€è¦è”ç³»ç½‘ç»œè¿ç»´åŒäº‹ï¼Œè®©å…¶ååŠ©è§£å†³ç½‘ç»œé—®é¢˜ã€‚</p><p>æˆ‘ä»¬è¿™ç¯‡æ–‡ç« ï¼Œé‡ç‚¹å…³æ³¨çš„æ˜¯ç¬¬äºŒç§æƒ…å†µã€‚</p><p>ä¹Ÿå°±æ˜¯ä» Redis è§’åº¦æ¥æ’æŸ¥ï¼Œæ˜¯å¦å­˜åœ¨å¯¼è‡´å˜æ…¢çš„åœºæ™¯ï¼Œä»¥åŠéƒ½æœ‰å“ªäº›å› ç´ ä¼šå¯¼è‡´ Redis çš„å»¶è¿Ÿå¢åŠ ï¼Œç„¶åé’ˆå¯¹æ€§åœ°è¿›è¡Œä¼˜åŒ–ã€‚</p><p>æ’é™¤ç½‘ç»œåŸå› ï¼Œå¦‚ä½•ç¡®è®¤ä½ çš„ Redis æ˜¯å¦çœŸçš„å˜æ…¢äº†ï¼Ÿ</p><p>é¦–å…ˆï¼Œä½ éœ€è¦å¯¹ Redis è¿›è¡ŒåŸºå‡†æ€§èƒ½æµ‹è¯•ï¼Œäº†è§£ä½ çš„ Redis åœ¨ç”Ÿäº§ç¯å¢ƒæœåŠ¡å™¨ä¸Šçš„åŸºå‡†æ€§èƒ½ã€‚</p><h3 id="_2-1-ä»€ä¹ˆæ˜¯åŸºå‡†æ€§èƒ½" tabindex="-1"><a class="header-anchor" href="#_2-1-ä»€ä¹ˆæ˜¯åŸºå‡†æ€§èƒ½" aria-hidden="true">#</a> 2.1 <strong>ä»€ä¹ˆæ˜¯åŸºå‡†æ€§èƒ½</strong>ï¼Ÿ</h3><p>ç®€å•æ¥è®²ï¼ŒåŸºå‡†æ€§èƒ½å°±æ˜¯æŒ‡ Redis åœ¨ä¸€å°è´Ÿè½½æ­£å¸¸çš„æœºå™¨ä¸Šï¼Œå…¶æœ€å¤§çš„å“åº”å»¶è¿Ÿå’Œå¹³å‡å“åº”å»¶è¿Ÿåˆ†åˆ«æ˜¯æ€æ ·çš„ï¼Ÿ</p><p>ä¸ºä»€ä¹ˆè¦æµ‹è¯•åŸºå‡†æ€§èƒ½ï¼Ÿæˆ‘å‚è€ƒåˆ«äººæä¾›çš„å“åº”å»¶è¿Ÿï¼Œåˆ¤æ–­è‡ªå·±çš„ Redis æ˜¯å¦å˜æ…¢ä¸è¡Œå—ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯å¦å®šçš„ã€‚</p><p>å› ä¸º Redis åœ¨ä¸åŒçš„è½¯ç¡¬ä»¶ç¯å¢ƒä¸‹ï¼Œå®ƒçš„æ€§èƒ½æ˜¯å„ä¸ç›¸åŒçš„ã€‚</p><p>ä¾‹å¦‚ï¼Œæˆ‘çš„æœºå™¨é…ç½®æ¯”è¾ƒä½ï¼Œå½“å»¶è¿Ÿä¸º 2ms æ—¶ï¼Œæˆ‘å°±è®¤ä¸º Redis å˜æ…¢äº†ï¼Œä½†æ˜¯å¦‚æœä½ çš„ç¡¬ä»¶é…ç½®æ¯”è¾ƒé«˜ï¼Œé‚£ä¹ˆåœ¨ä½ çš„è¿è¡Œç¯å¢ƒä¸‹ï¼Œå¯èƒ½å»¶è¿Ÿæ˜¯ 0.5ms æ—¶å°±å¯ä»¥è®¤ä¸º Redis å˜æ…¢äº†ã€‚</p><p>æ‰€ä»¥ï¼Œä½ åªæœ‰äº†è§£äº†ä½ çš„ Redis åœ¨ç”Ÿäº§ç¯å¢ƒæœåŠ¡å™¨ä¸Šçš„åŸºå‡†æ€§èƒ½ï¼Œæ‰èƒ½è¿›ä¸€æ­¥è¯„ä¼°ï¼Œå½“å…¶å»¶è¿Ÿè¾¾åˆ°ä»€ä¹ˆç¨‹åº¦æ—¶ï¼Œæ‰è®¤ä¸º Redis ç¡®å®å˜æ…¢äº†ã€‚</p><h3 id="_2-2-å…·ä½“å¦‚ä½•åš" tabindex="-1"><a class="header-anchor" href="#_2-2-å…·ä½“å¦‚ä½•åš" aria-hidden="true">#</a> 2.2 <strong>å…·ä½“å¦‚ä½•åš</strong>ï¼Ÿ</h3><p>ä¸ºäº†é¿å…ä¸šåŠ¡æœåŠ¡å™¨åˆ° Redis æœåŠ¡å™¨ä¹‹é—´çš„ç½‘ç»œå»¶è¿Ÿï¼Œä½ éœ€è¦ç›´æ¥åœ¨ Redis æœåŠ¡å™¨ä¸Šæµ‹è¯•å®ä¾‹çš„å“åº”å»¶è¿Ÿæƒ…å†µã€‚æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå°±å¯ä»¥æµ‹è¯•å‡ºè¿™ä¸ªå®ä¾‹ 60 ç§’å†…çš„æœ€å¤§å“åº”å»¶è¿Ÿï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ redis-cli <span class="token parameter variable">-h</span> <span class="token number">127.0</span>.0.1 <span class="token parameter variable">-p</span> <span class="token number">6379</span> --intrinsic-latency <span class="token number">60</span>
Max latency so far: <span class="token number">1</span> microseconds.
Max latency so far: <span class="token number">15</span> microseconds.
Max latency so far: <span class="token number">17</span> microseconds.
Max latency so far: <span class="token number">18</span> microseconds.
Max latency so far: <span class="token number">31</span> microseconds.
Max latency so far: <span class="token number">32</span> microseconds.
Max latency so far: <span class="token number">59</span> microseconds.
Max latency so far: <span class="token number">72</span> microseconds.
 
<span class="token number">1428669267</span> total runs <span class="token punctuation">(</span>avg latency: <span class="token number">0.0420</span> microseconds / <span class="token number">42.00</span> nanoseconds per run<span class="token punctuation">)</span>.
Worst run took 1429x longer than the average latency.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»è¾“å‡ºç»“æœå¯ä»¥çœ‹åˆ°ï¼Œè¿™ 60 ç§’å†…çš„æœ€å¤§å“åº”å»¶è¿Ÿä¸º 72 å¾®ç§’ï¼ˆ0.072æ¯«ç§’ï¼‰ã€‚</p><p>ä½ è¿˜å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼ŒæŸ¥çœ‹ä¸€æ®µæ—¶é—´å†… Redis çš„æœ€å°ã€æœ€å¤§ã€å¹³å‡è®¿é—®å»¶è¿Ÿï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ redis-cli <span class="token parameter variable">-h</span> <span class="token number">127.0</span>.0.1 <span class="token parameter variable">-p</span> <span class="token number">6379</span> --latency-history <span class="token parameter variable">-i</span> <span class="token number">1</span>
min: <span class="token number">0</span>, max: <span class="token number">1</span>, avg: <span class="token number">0.13</span> <span class="token punctuation">(</span><span class="token number">100</span> samples<span class="token punctuation">)</span> -- <span class="token number">1.01</span> seconds range
min: <span class="token number">0</span>, max: <span class="token number">1</span>, avg: <span class="token number">0.12</span> <span class="token punctuation">(</span><span class="token number">99</span> samples<span class="token punctuation">)</span> -- <span class="token number">1.01</span> seconds range
min: <span class="token number">0</span>, max: <span class="token number">1</span>, avg: <span class="token number">0.13</span> <span class="token punctuation">(</span><span class="token number">99</span> samples<span class="token punctuation">)</span> -- <span class="token number">1.01</span> seconds range
min: <span class="token number">0</span>, max: <span class="token number">1</span>, avg: <span class="token number">0.10</span> <span class="token punctuation">(</span><span class="token number">99</span> samples<span class="token punctuation">)</span> -- <span class="token number">1.01</span> seconds range
min: <span class="token number">0</span>, max: <span class="token number">1</span>, avg: <span class="token number">0.13</span> <span class="token punctuation">(</span><span class="token number">98</span> samples<span class="token punctuation">)</span> -- <span class="token number">1.00</span> seconds range
min: <span class="token number">0</span>, max: <span class="token number">1</span>, avg: <span class="token number">0.08</span> <span class="token punctuation">(</span><span class="token number">99</span> samples<span class="token punctuation">)</span> -- <span class="token number">1.01</span> seconds range
<span class="token punctuation">..</span>.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šè¾“å‡ºç»“æœæ˜¯ï¼Œæ¯é—´éš” 1 ç§’ï¼Œé‡‡æ · Redis çš„å¹³å‡æ“ä½œè€—æ—¶ï¼Œå…¶ç»“æœåˆ†å¸ƒåœ¨ 0.08 ~ 0.13 æ¯«ç§’ä¹‹é—´ã€‚</p><p>äº†è§£äº†åŸºå‡†æ€§èƒ½æµ‹è¯•æ–¹æ³•ï¼Œé‚£ä¹ˆä½ å°±å¯ä»¥æŒ‰ç…§ä»¥ä¸‹å‡ æ­¥ï¼Œæ¥åˆ¤æ–­ä½ çš„ Redis æ˜¯å¦çœŸçš„å˜æ…¢äº†ï¼š</p><ul><li>åœ¨ç›¸åŒé…ç½®çš„æœåŠ¡å™¨ä¸Šï¼Œæµ‹è¯•ä¸€ä¸ªæ­£å¸¸ Redis å®ä¾‹çš„åŸºå‡†æ€§èƒ½</li><li>æ‰¾åˆ°ä½ è®¤ä¸ºå¯èƒ½å˜æ…¢çš„ Redis å®ä¾‹ï¼Œæµ‹è¯•è¿™ä¸ªå®ä¾‹çš„åŸºå‡†æ€§èƒ½</li><li>å¦‚æœä½ è§‚å¯Ÿåˆ°ï¼Œè¿™ä¸ªå®ä¾‹çš„è¿è¡Œå»¶è¿Ÿæ˜¯æ­£å¸¸ Redis åŸºå‡†æ€§èƒ½çš„ 2 å€ä»¥ä¸Šï¼Œå³å¯è®¤ä¸ºè¿™ä¸ª Redis å®ä¾‹ç¡®å®å˜æ…¢äº†</li></ul><p>ç¡®è®¤æ˜¯ Redis å˜æ…¢äº†ï¼Œé‚£å¦‚ä½•æ’æŸ¥æ˜¯å“ªé‡Œå‘ç”Ÿäº†é—®é¢˜å‘¢ï¼Ÿ</p><p>ä¸‹é¢è·Ÿç€æˆ‘çš„æ€è·¯ï¼Œæˆ‘ä»¬ä»æ˜“åˆ°éš¾ï¼Œä¸€æ­¥æ­¥æ¥åˆ†æå¯èƒ½å¯¼è‡´ Redis å˜æ…¢çš„å› ç´ ã€‚</p><h2 id="_3-ä½¿ç”¨å¤æ‚åº¦è¿‡é«˜çš„å‘½ä»¤" tabindex="-1"><a class="header-anchor" href="#_3-ä½¿ç”¨å¤æ‚åº¦è¿‡é«˜çš„å‘½ä»¤" aria-hidden="true">#</a> 3. ä½¿ç”¨å¤æ‚åº¦è¿‡é«˜çš„å‘½ä»¤</h2><blockquote><p>é¦–å…ˆï¼Œç¬¬ä¸€æ­¥ï¼Œä½ éœ€è¦å»æŸ¥çœ‹ä¸€ä¸‹ Redis çš„æ…¢æ—¥å¿—ï¼ˆslowlogï¼‰ã€‚</p></blockquote><p>Redis æä¾›äº†æ…¢æ—¥å¿—å‘½ä»¤çš„ç»Ÿè®¡åŠŸèƒ½ï¼Œå®ƒè®°å½•äº†æœ‰å“ªäº›å‘½ä»¤åœ¨æ‰§è¡Œæ—¶è€—æ—¶æ¯”è¾ƒä¹…ã€‚</p><p>æŸ¥çœ‹ Redis æ…¢æ—¥å¿—ä¹‹å‰ï¼Œä½ éœ€è¦è®¾ç½®æ…¢æ—¥å¿—çš„é˜ˆå€¼ã€‚ä¾‹å¦‚ï¼Œè®¾ç½®æ…¢æ—¥å¿—çš„é˜ˆå€¼ä¸º 5 æ¯«ç§’ï¼Œå¹¶ä¸”ä¿ç•™æœ€è¿‘ 500 æ¡æ…¢æ—¥å¿—è®°å½•ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment"># å‘½ä»¤æ‰§è¡Œè€—æ—¶è¶…è¿‡ 5 æ¯«ç§’ï¼Œè®°å½•æ…¢æ—¥å¿—</span>
CONFIG <span class="token keyword">SET</span> slowlog<span class="token operator">-</span>log<span class="token operator">-</span>slower<span class="token operator">-</span>than <span class="token number">5000</span>
<span class="token comment"># åªä¿ç•™æœ€è¿‘ 500 æ¡æ…¢æ—¥å¿—</span>
CONFIG <span class="token keyword">SET</span> slowlog<span class="token operator">-</span>max<span class="token operator">-</span>len <span class="token number">500</span>
  
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è®¾ç½®å®Œæˆä¹‹åï¼Œæ‰€æœ‰æ‰§è¡Œçš„å‘½ä»¤å¦‚æœæ“ä½œè€—æ—¶è¶…è¿‡äº† 5 æ¯«ç§’ï¼Œéƒ½ä¼šè¢« Redis è®°å½•ä¸‹æ¥ã€‚</p><p>æ­¤æ—¶ï¼Œä½ å¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå°±å¯ä»¥æŸ¥è¯¢åˆ°æœ€è¿‘è®°å½•çš„æ…¢æ—¥å¿—ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> SLOWLOG get <span class="token number">5</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">32693</span>       <span class="token comment"># æ…¢æ—¥å¿—ID</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1593763337</span>  <span class="token comment"># æ‰§è¡Œæ—¶é—´æˆ³</span>
   <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">5299</span>        <span class="token comment"># æ‰§è¡Œè€—æ—¶(å¾®ç§’)</span>
   <span class="token number">4</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;LRANGE&quot;</span>           <span class="token comment"># å…·ä½“æ‰§è¡Œçš„å‘½ä»¤å’Œå‚æ•°</span>
      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;user_list:2000&quot;</span>
      <span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;0&quot;</span>
      <span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;-1&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">32692</span>
   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1593763337</span>
   <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">5044</span>
   <span class="token number">4</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;GET&quot;</span>
      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;user_info:1000&quot;</span>
<span class="token punctuation">..</span>.

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡æŸ¥çœ‹æ…¢æ—¥å¿—ï¼Œæˆ‘ä»¬å°±å¯ä»¥çŸ¥é“åœ¨ä»€ä¹ˆæ—¶é—´ç‚¹ï¼Œæ‰§è¡Œäº†å“ªäº›å‘½ä»¤æ¯”è¾ƒè€—æ—¶ã€‚</p><p>å¦‚æœä½ çš„åº”ç”¨ç¨‹åºæ‰§è¡Œçš„ Redis å‘½ä»¤æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼Œé‚£ä¹ˆæœ‰å¯èƒ½ä¼šå¯¼è‡´æ“ä½œå»¶è¿Ÿå˜å¤§ï¼š</p><ul><li><strong>ç»å¸¸ä½¿ç”¨ O(N) ä»¥ä¸Šå¤æ‚åº¦çš„å‘½ä»¤ï¼Œä¾‹å¦‚ SORTã€SUNIONã€ZUNIONSTORE èšåˆç±»å‘½ä»¤</strong></li><li>ä½¿ç”¨ O(N) å¤æ‚åº¦çš„å‘½ä»¤ï¼Œä½† N çš„å€¼éå¸¸å¤§</li></ul><p><strong>ç¬¬ä¸€ç§æƒ…å†µå¯¼è‡´å˜æ…¢çš„åŸå› åœ¨äºï¼ŒRedis åœ¨æ“ä½œå†…å­˜æ•°æ®æ—¶ï¼Œæ—¶é—´å¤æ‚åº¦è¿‡é«˜ï¼Œè¦èŠ±è´¹æ›´å¤šçš„ CPU èµ„æºã€‚</strong></p><p><strong>ç¬¬äºŒç§æƒ…å†µå¯¼è‡´å˜æ…¢çš„åŸå› åœ¨äºï¼ŒRedis ä¸€æ¬¡éœ€è¦è¿”å›ç»™å®¢æˆ·ç«¯çš„æ•°æ®è¿‡å¤šï¼Œæ›´å¤šæ—¶é—´èŠ±è´¹åœ¨æ•°æ®åè®®çš„ç»„è£…å’Œç½‘ç»œä¼ è¾“è¿‡ç¨‹ä¸­ã€‚</strong></p><p>å¦å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä»èµ„æºä½¿ç”¨ç‡å±‚é¢æ¥åˆ†æï¼Œå¦‚æœä½ çš„åº”ç”¨ç¨‹åºæ“ä½œ Redis çš„ OPS ä¸æ˜¯å¾ˆå¤§ï¼Œä½† Redis å®ä¾‹çš„ CPU ä½¿ç”¨ç‡å´å¾ˆé«˜ï¼Œé‚£ä¹ˆå¾ˆæœ‰å¯èƒ½æ˜¯ä½¿ç”¨äº†å¤æ‚åº¦è¿‡é«˜çš„å‘½ä»¤å¯¼è‡´çš„ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒRedis æ˜¯å•çº¿ç¨‹å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚çš„ï¼Œå¦‚æœä½ ç»å¸¸ä½¿ç”¨ä»¥ä¸Šå‘½ä»¤ï¼Œé‚£ä¹ˆå½“ Redis å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚æ—¶ï¼Œä¸€æ—¦å‰é¢æŸä¸ªå‘½ä»¤å‘ç”Ÿè€—æ—¶ï¼Œå°±ä¼šå¯¼è‡´åé¢çš„è¯·æ±‚å‘ç”Ÿæ’é˜Ÿï¼Œå¯¹äºå®¢æˆ·ç«¯æ¥è¯´ï¼Œå“åº”å»¶è¿Ÿä¹Ÿä¼šå˜é•¿ã€‚</p><figure><img src="https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/image-20220627223154759.png" alt="image-20220627223154759" tabindex="0" loading="lazy"><figcaption>image-20220627223154759</figcaption></figure><p>é’ˆå¯¹è¿™ç§æƒ…å†µå¦‚ä½•è§£å†³å‘¢ï¼Ÿ</p><p>ç­”æ¡ˆå¾ˆç®€å•ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ä¼˜åŒ–ä½ çš„ä¸šåŠ¡ï¼š</p><ul><li>å°½é‡ä¸ä½¿ç”¨ O(N) ä»¥ä¸Šå¤æ‚åº¦è¿‡é«˜çš„å‘½ä»¤ï¼Œå¯¹äºæ•°æ®çš„èšåˆæ“ä½œï¼Œæ”¾åœ¨å®¢æˆ·ç«¯åš</li><li>æ‰§è¡Œ O(N) å‘½ä»¤ï¼Œä¿è¯ N å°½é‡çš„å°ï¼ˆæ¨è N &lt;= 300ï¼‰ï¼Œæ¯æ¬¡è·å–å°½é‡å°‘çš„æ•°æ®ï¼Œè®© Redis å¯ä»¥åŠæ—¶å¤„ç†è¿”å›</li></ul><h2 id="_4-æ“ä½œbigkey" tabindex="-1"><a class="header-anchor" href="#_4-æ“ä½œbigkey" aria-hidden="true">#</a> 4. æ“ä½œbigkey</h2><blockquote><p>å¦‚æœä½ æŸ¥è¯¢æ…¢æ—¥å¿—å‘ç°ï¼Œå¹¶ä¸æ˜¯å¤æ‚åº¦è¿‡é«˜çš„å‘½ä»¤å¯¼è‡´çš„ï¼Œè€Œéƒ½æ˜¯ SET / DEL è¿™ç§ç®€å•å‘½ä»¤å‡ºç°åœ¨æ…¢æ—¥å¿—ä¸­ï¼Œé‚£ä¹ˆä½ å°±è¦æ€€ç–‘ä½ çš„å®ä¾‹å¦å†™å…¥äº† bigkeyã€‚</p></blockquote><p>Redis åœ¨å†™å…¥æ•°æ®æ—¶ï¼Œéœ€è¦ä¸ºæ–°çš„æ•°æ®åˆ†é…å†…å­˜ï¼Œç›¸å¯¹åº”çš„ï¼Œå½“ä» Redis ä¸­åˆ é™¤æ•°æ®æ—¶ï¼Œå®ƒä¼šé‡Šæ”¾å¯¹åº”çš„å†…å­˜ç©ºé—´ã€‚</p><p><strong>å¦‚æœä¸€ä¸ª key å†™å…¥çš„ value éå¸¸å¤§ï¼Œé‚£ä¹ˆ Redis åœ¨åˆ†é…å†…å­˜æ—¶å°±ä¼šæ¯”è¾ƒè€—æ—¶</strong>ã€‚åŒæ ·çš„ï¼Œå½“åˆ é™¤è¿™ä¸ª key æ—¶ï¼Œé‡Šæ”¾å†…å­˜ä¹Ÿä¼šæ¯”è¾ƒè€—æ—¶ï¼Œè¿™ç§ç±»å‹çš„ key æˆ‘ä»¬ä¸€èˆ¬ç§°ä¹‹ä¸º bigkeyã€‚</p><p>æ­¤æ—¶ï¼Œä½ éœ€è¦æ£€æŸ¥ä½ çš„ä¸šåŠ¡ä»£ç ï¼Œæ˜¯å¦å­˜åœ¨å†™å…¥ bigkey çš„æƒ…å†µã€‚ä½ éœ€è¦è¯„ä¼°å†™å…¥ä¸€ä¸ª key çš„æ•°æ®å¤§å°ï¼Œå°½é‡é¿å…ä¸€ä¸ª key å­˜å…¥è¿‡å¤§çš„æ•°æ®ã€‚</p><h3 id="_4-1-æŸ¥çœ‹bigkey-çš„åˆ†å¸ƒæƒ…å†µ" tabindex="-1"><a class="header-anchor" href="#_4-1-æŸ¥çœ‹bigkey-çš„åˆ†å¸ƒæƒ…å†µ" aria-hidden="true">#</a> 4.1 æŸ¥çœ‹bigkey çš„åˆ†å¸ƒæƒ…å†µ</h3><p><strong>å¦‚æœå·²ç»å†™å…¥äº† bigkeyï¼Œé‚£æœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥æ‰«æå‡ºå®ä¾‹ä¸­ bigkey çš„åˆ†å¸ƒæƒ…å†µå‘¢</strong>ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯å¯ä»¥çš„ã€‚</p><p>Redis æä¾›äº†æ‰«æ bigkey çš„å‘½ä»¤ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å°±å¯ä»¥æ‰«æå‡ºï¼Œä¸€ä¸ªå®ä¾‹ä¸­ bigkey çš„åˆ†å¸ƒæƒ…å†µï¼Œè¾“å‡ºç»“æœæ˜¯ä»¥ç±»å‹ç»´åº¦å±•ç¤ºçš„ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ redis-cli <span class="token parameter variable">-h</span> <span class="token number">127.0</span>.0.1 <span class="token parameter variable">-p</span> <span class="token number">6379</span> <span class="token parameter variable">--bigkeys</span> <span class="token parameter variable">-i</span> <span class="token number">0.01</span>
 
<span class="token punctuation">..</span>.
-------- summary -------
 
Sampled <span class="token number">829675</span> keys <span class="token keyword">in</span> the keyspace<span class="token operator">!</span>
Total key length <span class="token keyword">in</span> bytes is <span class="token number">10059825</span> <span class="token punctuation">(</span>avg len <span class="token number">12.13</span><span class="token punctuation">)</span>
 
Biggest string found <span class="token string">&#39;key:291880&#39;</span> has <span class="token number">10</span> bytes
Biggest   list found <span class="token string">&#39;mylist:004&#39;</span> has <span class="token number">40</span> items
Biggest    <span class="token builtin class-name">set</span> found <span class="token string">&#39;myset:2386&#39;</span> has <span class="token number">38</span> members
Biggest   <span class="token builtin class-name">hash</span> found <span class="token string">&#39;myhash:3574&#39;</span> has <span class="token number">37</span> fields
Biggest   zset found <span class="token string">&#39;myzset:2704&#39;</span> has <span class="token number">42</span> members
 
<span class="token number">36313</span> strings with <span class="token number">363130</span> bytes <span class="token punctuation">(</span>04.38% of keys, avg size <span class="token number">10.00</span><span class="token punctuation">)</span>
<span class="token number">787393</span> lists with <span class="token number">896540</span> items <span class="token punctuation">(</span><span class="token number">94.90</span>% of keys, avg size <span class="token number">1.14</span><span class="token punctuation">)</span>
<span class="token number">1994</span> sets with <span class="token number">40052</span> members <span class="token punctuation">(</span>00.24% of keys, avg size <span class="token number">20.09</span><span class="token punctuation">)</span>
<span class="token number">1990</span> hashs with <span class="token number">39632</span> fields <span class="token punctuation">(</span>00.24% of keys, avg size <span class="token number">19.92</span><span class="token punctuation">)</span>
<span class="token number">1985</span> zsets with <span class="token number">39750</span> members <span class="token punctuation">(</span>00.24% of keys, avg size <span class="token number">20.03</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœæç¤º Couldn&#39;t determine DBSIZE!ï¼Œåˆ™éœ€è¦è¾“å…¥å¯†ç </p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>redis-cli <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.1.1 <span class="token parameter variable">-p</span> <span class="token number">6379</span> <span class="token parameter variable">-a</span> <span class="token string">&quot;123&quot;</span> <span class="token parameter variable">--bigkeys</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä»è¾“å‡ºç»“æœæˆ‘ä»¬å¯ä»¥å¾ˆæ¸…æ™°åœ°çœ‹åˆ°ï¼Œæ¯ç§æ•°æ®ç±»å‹æ‰€å ç”¨çš„æœ€å¤§å†…å­˜ / æ‹¥æœ‰æœ€å¤šå…ƒç´ çš„ key æ˜¯å“ªä¸€ä¸ªï¼Œä»¥åŠæ¯ç§æ•°æ®ç±»å‹åœ¨æ•´ä¸ªå®ä¾‹ä¸­çš„å æ¯”å’Œå¹³å‡å¤§å° / å…ƒç´ æ•°é‡ã€‚</p><p>å…¶å®ï¼Œä½¿ç”¨è¿™ä¸ªå‘½ä»¤çš„åŸç†ï¼Œå°±æ˜¯ Redis åœ¨å†…éƒ¨æ‰§è¡Œäº† SCAN å‘½ä»¤ï¼Œéå†æ•´ä¸ªå®ä¾‹ä¸­æ‰€æœ‰çš„ keyï¼Œç„¶åé’ˆå¯¹ key çš„ç±»å‹ï¼Œåˆ†åˆ«æ‰§è¡Œ STRLENã€LLENã€HLENã€SCARDã€ZCARD å‘½ä»¤ï¼Œæ¥è·å– String ç±»å‹çš„é•¿åº¦ã€å®¹å™¨ç±»å‹ï¼ˆListã€Hashã€Setã€ZSetï¼‰çš„å…ƒç´ ä¸ªæ•°ã€‚</p><p>è¿™é‡Œæˆ‘éœ€è¦æé†’ä½ çš„æ˜¯ï¼Œå½“æ‰§è¡Œè¿™ä¸ªå‘½ä»¤æ—¶ï¼Œè¦æ³¨æ„ 2 ä¸ªé—®é¢˜ï¼š</p><ul><li>å¯¹çº¿ä¸Šå®ä¾‹è¿›è¡Œ bigkey æ‰«ææ—¶ï¼ŒRedis çš„ OPS ä¼šçªå¢ï¼Œä¸ºäº†é™ä½æ‰«æè¿‡ç¨‹ä¸­å¯¹ Redis çš„å½±å“ï¼Œæœ€å¥½æ§åˆ¶ä¸€ä¸‹æ‰«æçš„é¢‘ç‡ï¼ŒæŒ‡å®š -i å‚æ•°å³å¯ï¼Œå®ƒè¡¨ç¤ºæ‰«æè¿‡ç¨‹ä¸­æ¯æ¬¡æ‰«æåä¼‘æ¯çš„æ—¶é—´é—´éš”ï¼Œå•ä½æ˜¯ç§’</li><li>æ‰«æç»“æœä¸­ï¼Œå¯¹äºå®¹å™¨ç±»å‹ï¼ˆListã€Hashã€Setã€ZSetï¼‰çš„ keyï¼Œåªèƒ½æ‰«æå‡ºå…ƒç´ æœ€å¤šçš„ keyã€‚ä½†ä¸€ä¸ª key çš„å…ƒç´ å¤šï¼Œä¸ä¸€å®šè¡¨ç¤ºå ç”¨å†…å­˜ä¹Ÿå¤šï¼Œä½ è¿˜éœ€è¦æ ¹æ®ä¸šåŠ¡æƒ…å†µï¼Œè¿›ä¸€æ­¥è¯„ä¼°å†…å­˜å ç”¨æƒ…å†µ</li></ul><h3 id="_4-2-è§£å†³æ–¹æ¡ˆ" tabindex="-1"><a class="header-anchor" href="#_4-2-è§£å†³æ–¹æ¡ˆ" aria-hidden="true">#</a> 4.2 è§£å†³æ–¹æ¡ˆ</h3><p><strong>é‚£é’ˆå¯¹ bigkey å¯¼è‡´å»¶è¿Ÿçš„é—®é¢˜ï¼Œæœ‰ä»€ä¹ˆå¥½çš„è§£å†³æ–¹æ¡ˆå‘¢</strong>ï¼Ÿ</p><p>è¿™é‡Œæœ‰ä¸¤ç‚¹å¯ä»¥ä¼˜åŒ–ï¼š</p><ul><li>ä¸šåŠ¡åº”ç”¨å°½é‡é¿å…å†™å…¥ bigkey</li><li>å¦‚æœä½ ä½¿ç”¨çš„ Redis æ˜¯ 4.0 ä»¥ä¸Šç‰ˆæœ¬ï¼Œç”¨ UNLINK å‘½ä»¤æ›¿ä»£ DELï¼Œæ­¤å‘½ä»¤å¯ä»¥æŠŠé‡Šæ”¾ key å†…å­˜çš„æ“ä½œï¼Œæ”¾åˆ°åå°çº¿ç¨‹ä¸­å»æ‰§è¡Œï¼Œä»è€Œé™ä½å¯¹ Redis çš„å½±å“</li><li>å¦‚æœä½ ä½¿ç”¨çš„ Redis æ˜¯ 6.0 ä»¥ä¸Šç‰ˆæœ¬ï¼Œå¯ä»¥å¼€å¯ lazy-free æœºåˆ¶ï¼ˆlazyfree-lazy-user-del = yesï¼‰ï¼Œåœ¨æ‰§è¡Œ DEL å‘½ä»¤æ—¶ï¼Œé‡Šæ”¾å†…å­˜ä¹Ÿä¼šæ”¾åˆ°åå°çº¿ç¨‹ä¸­æ‰§è¡Œ</li></ul><p>ä½†å³ä¾¿å¯ä»¥ä½¿ç”¨æ–¹æ¡ˆ 2ï¼Œæˆ‘ä¹Ÿä¸å»ºè®®ä½ åœ¨å®ä¾‹ä¸­å­˜å…¥ bigkeyã€‚</p><p>è¿™æ˜¯å› ä¸º bigkey åœ¨å¾ˆå¤šåœºæ™¯ä¸‹ï¼Œä¾æ—§ä¼šäº§ç”Ÿæ€§èƒ½é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œbigkey åœ¨åˆ†ç‰‡é›†ç¾¤æ¨¡å¼ä¸‹ï¼Œå¯¹äºæ•°æ®çš„è¿ç§»ä¹Ÿä¼šæœ‰æ€§èƒ½å½±å“ï¼Œä»¥åŠæˆ‘åé¢å³å°†è®²åˆ°çš„æ•°æ®è¿‡æœŸã€æ•°æ®æ·˜æ±°ã€é€æ˜å¤§é¡µï¼Œéƒ½ä¼šå—åˆ° bigkey çš„å½±å“ã€‚</p><h2 id="_5-é›†ä¸­è¿‡æœŸ" tabindex="-1"><a class="header-anchor" href="#_5-é›†ä¸­è¿‡æœŸ" aria-hidden="true">#</a> 5. é›†ä¸­è¿‡æœŸ</h2><blockquote><p>å¦‚æœä½ å‘ç°ï¼Œå¹³æ—¶åœ¨æ“ä½œ Redis æ—¶ï¼Œå¹¶æ²¡æœ‰å»¶è¿Ÿå¾ˆå¤§çš„æƒ…å†µå‘ç”Ÿï¼Œä½†åœ¨æŸä¸ªæ—¶é—´ç‚¹çªç„¶å‡ºç°ä¸€æ³¢å»¶æ—¶ï¼Œå…¶ç°è±¡è¡¨ç°ä¸ºï¼š<strong>å˜æ…¢çš„æ—¶é—´ç‚¹å¾ˆæœ‰è§„å¾‹ï¼Œä¾‹å¦‚æŸä¸ªæ•´ç‚¹ï¼Œæˆ–è€…æ¯é—´éš”å¤šä¹…å°±ä¼šå‘ç”Ÿä¸€æ³¢å»¶è¿Ÿ</strong>ã€‚å¦‚æœæ˜¯å‡ºç°è¿™ç§æƒ…å†µï¼Œé‚£ä¹ˆä½ éœ€è¦æ’æŸ¥ä¸€ä¸‹ï¼Œä¸šåŠ¡ä»£ç ä¸­æ˜¯å¦å­˜åœ¨è®¾ç½®å¤§é‡ key é›†ä¸­è¿‡æœŸçš„æƒ…å†µã€‚</p></blockquote><p>å¦‚æœæœ‰å¤§é‡çš„ key åœ¨æŸä¸ªå›ºå®šæ—¶é—´ç‚¹é›†ä¸­è¿‡æœŸï¼Œåœ¨è¿™ä¸ªæ—¶é—´ç‚¹è®¿é—® Redis æ—¶ï¼Œå°±æœ‰å¯èƒ½å¯¼è‡´å»¶æ—¶å˜å¤§ã€‚</p><h3 id="_5-1-ä¸ºä»€ä¹ˆé›†ä¸­è¿‡æœŸä¼šå¯¼è‡´-redis-å»¶è¿Ÿå˜å¤§" tabindex="-1"><a class="header-anchor" href="#_5-1-ä¸ºä»€ä¹ˆé›†ä¸­è¿‡æœŸä¼šå¯¼è‡´-redis-å»¶è¿Ÿå˜å¤§" aria-hidden="true">#</a> 5.1 <strong>ä¸ºä»€ä¹ˆé›†ä¸­è¿‡æœŸä¼šå¯¼è‡´ Redis å»¶è¿Ÿå˜å¤§</strong>ï¼Ÿ</h3><p>è¿™å°±éœ€è¦æˆ‘ä»¬äº†è§£ Redis çš„è¿‡æœŸç­–ç•¥æ˜¯æ€æ ·çš„ã€‚</p><p>Redis çš„è¿‡æœŸæ•°æ®é‡‡ç”¨è¢«åŠ¨è¿‡æœŸ + ä¸»åŠ¨è¿‡æœŸä¸¤ç§ç­–ç•¥ï¼š</p><ul><li><strong>è¢«åŠ¨è¿‡æœŸ</strong>ï¼šåªæœ‰å½“è®¿é—®æŸä¸ª key æ—¶ï¼Œæ‰åˆ¤æ–­è¿™ä¸ª key æ˜¯å¦å·²è¿‡æœŸï¼Œå¦‚æœå·²è¿‡æœŸï¼Œåˆ™ä»å®ä¾‹ä¸­åˆ é™¤</li><li><strong>ä¸»åŠ¨è¿‡æœŸ</strong>ï¼šRedis å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œé»˜è®¤æ¯éš” 100 æ¯«ç§’ï¼ˆ1ç§’10æ¬¡ï¼‰å°±ä¼šä»å…¨å±€çš„è¿‡æœŸå“ˆå¸Œè¡¨ä¸­éšæœºå–å‡º 20 ä¸ª keyï¼Œç„¶ååˆ é™¤å…¶ä¸­è¿‡æœŸçš„ keyï¼Œå¦‚æœè¿‡æœŸ key çš„æ¯”ä¾‹è¶…è¿‡äº† 25%ï¼Œåˆ™ç»§ç»­é‡å¤æ­¤è¿‡ç¨‹ï¼Œç›´åˆ°è¿‡æœŸ key çš„æ¯”ä¾‹ä¸‹é™åˆ° 25% ä»¥ä¸‹ï¼Œæˆ–è€…è¿™æ¬¡ä»»åŠ¡çš„æ‰§è¡Œè€—æ—¶è¶…è¿‡äº† 25 æ¯«ç§’ï¼Œæ‰ä¼šé€€å‡ºå¾ªç¯</li></ul><p>æ³¨æ„ï¼Œ<strong>è¿™ä¸ªä¸»åŠ¨è¿‡æœŸ key çš„å®šæ—¶ä»»åŠ¡ï¼Œæ˜¯åœ¨ Redis ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œçš„</strong>ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´å¦‚æœåœ¨æ‰§è¡Œä¸»åŠ¨è¿‡æœŸçš„è¿‡ç¨‹ä¸­ï¼Œå‡ºç°äº†éœ€è¦å¤§é‡åˆ é™¤è¿‡æœŸ key çš„æƒ…å†µï¼Œé‚£ä¹ˆæ­¤æ—¶åº”ç”¨ç¨‹åºåœ¨è®¿é—® Redis æ—¶ï¼Œå¿…é¡»è¦ç­‰å¾…è¿™ä¸ªè¿‡æœŸä»»åŠ¡æ‰§è¡Œç»“æŸï¼ŒRedis æ‰å¯ä»¥æœåŠ¡è¿™ä¸ªå®¢æˆ·ç«¯è¯·æ±‚ã€‚</p><p>æ­¤æ—¶å°±ä¼šå‡ºç°ï¼Œåº”ç”¨è®¿é—® Redis å»¶æ—¶å˜å¤§ã€‚</p><p>å¦‚æœæ­¤æ—¶éœ€è¦è¿‡æœŸåˆ é™¤çš„æ˜¯ä¸€ä¸ª bigkeyï¼Œé‚£ä¹ˆè¿™ä¸ªè€—æ—¶ä¼šæ›´ä¹…ã€‚è€Œä¸”ï¼Œè¿™ä¸ªæ“ä½œå»¶è¿Ÿçš„å‘½ä»¤å¹¶ä¸ä¼šè®°å½•åœ¨æ…¢æ—¥å¿—ä¸­ã€‚</p><p>å› ä¸ºæ…¢æ—¥å¿—ä¸­åªè®°å½•ä¸€ä¸ªå‘½ä»¤çœŸæ­£æ“ä½œå†…å­˜æ•°æ®çš„è€—æ—¶ï¼Œè€Œ Redis ä¸»åŠ¨åˆ é™¤è¿‡æœŸ key çš„é€»è¾‘ï¼Œæ˜¯åœ¨å‘½ä»¤çœŸæ­£æ‰§è¡Œä¹‹å‰æ‰§è¡Œçš„ã€‚</p><p>æ‰€ä»¥ï¼Œæ­¤æ—¶ä½ ä¼šçœ‹åˆ°ï¼Œ<strong>æ…¢æ—¥å¿—ä¸­æ²¡æœ‰æ“ä½œè€—æ—¶çš„å‘½ä»¤ï¼Œä½†æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå´æ„ŸçŸ¥åˆ°äº†å»¶è¿Ÿå˜å¤§ï¼Œå…¶å®æ—¶é—´éƒ½èŠ±è´¹åœ¨äº†åˆ é™¤è¿‡æœŸ key ä¸Š</strong>ï¼Œè¿™ç§æƒ…å†µæˆ‘ä»¬éœ€è¦å°¤ä¸ºæ³¨æ„ã€‚</p><figure><img src="https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/image-20220627224145071.png" alt="image-20220627224145071" tabindex="0" loading="lazy"><figcaption>image-20220627224145071</figcaption></figure><h3 id="_5-2-é‚£é‡åˆ°è¿™ç§æƒ…å†µ-å¦‚ä½•åˆ†æå’Œæ’æŸ¥" tabindex="-1"><a class="header-anchor" href="#_5-2-é‚£é‡åˆ°è¿™ç§æƒ…å†µ-å¦‚ä½•åˆ†æå’Œæ’æŸ¥" aria-hidden="true">#</a> 5.2 <strong>é‚£é‡åˆ°è¿™ç§æƒ…å†µï¼Œå¦‚ä½•åˆ†æå’Œæ’æŸ¥</strong>ï¼Ÿ</h3><p>æ­¤æ—¶ï¼Œä½ éœ€è¦æ£€æŸ¥ä½ çš„ä¸šåŠ¡ä»£ç ï¼Œæ˜¯å¦å­˜åœ¨é›†ä¸­è¿‡æœŸ key çš„é€»è¾‘ã€‚</p><p>ä¸€èˆ¬é›†ä¸­è¿‡æœŸä½¿ç”¨çš„æ˜¯ expireat / pexpireat å‘½ä»¤ï¼Œä½ éœ€è¦åœ¨ä»£ç ä¸­æœç´¢è¿™ä¸ªå…³é”®å­—ã€‚</p><p>æ’æŸ¥ä»£ç åï¼Œå¦‚æœç¡®å®å­˜åœ¨é›†ä¸­è¿‡æœŸ key çš„é€»è¾‘å­˜åœ¨ï¼Œä½†è¿™ç§é€»è¾‘åˆæ˜¯ä¸šåŠ¡æ‰€å¿…é¡»çš„ï¼Œé‚£æ­¤æ—¶å¦‚ä½•ä¼˜åŒ–ï¼ŒåŒæ—¶åˆä¸å¯¹ Redis æœ‰æ€§èƒ½å½±å“å‘¢ï¼Ÿ</p><h3 id="_5-3-è§„é¿é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#_5-3-è§„é¿é—®é¢˜" aria-hidden="true">#</a> 5.3 è§„é¿é—®é¢˜</h3><p>ä¸€èˆ¬æœ‰ä¸¤ç§æ–¹æ¡ˆæ¥è§„é¿è¿™ä¸ªé—®é¢˜ï¼š</p><ul><li>é›†ä¸­è¿‡æœŸ key å¢åŠ ä¸€ä¸ªéšæœºè¿‡æœŸæ—¶é—´ï¼ŒæŠŠé›†ä¸­è¿‡æœŸçš„æ—¶é—´æ‰“æ•£ï¼Œé™ä½ Redis æ¸…ç†è¿‡æœŸ key çš„å‹åŠ›</li><li>å¦‚æœä½ ä½¿ç”¨çš„ Redis æ˜¯ 4.0 ä»¥ä¸Šç‰ˆæœ¬ï¼Œå¯ä»¥å¼€å¯ lazy-free æœºåˆ¶ï¼Œå½“åˆ é™¤è¿‡æœŸ key æ—¶ï¼ŒæŠŠé‡Šæ”¾å†…å­˜çš„æ“ä½œæ”¾åˆ°åå°çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œé¿å…é˜»å¡ä¸»çº¿ç¨‹</li></ul><p>ç¬¬ä¸€ç§æ–¹æ¡ˆï¼Œåœ¨è®¾ç½® key çš„è¿‡æœŸæ—¶é—´æ—¶ï¼Œå¢åŠ ä¸€ä¸ªéšæœºæ—¶é—´ï¼Œä¼ªä»£ç å¯ä»¥è¿™ä¹ˆå†™ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># åœ¨è¿‡æœŸæ—¶é—´ç‚¹ä¹‹åçš„ 5 åˆ†é’Ÿå†…éšæœºè¿‡æœŸæ‰</span>
redis.expireat<span class="token punctuation">(</span>key, expire_time + random<span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">))</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ ·ä¸€æ¥ï¼ŒRedis åœ¨å¤„ç†è¿‡æœŸæ—¶ï¼Œä¸ä¼šå› ä¸ºé›†ä¸­åˆ é™¤è¿‡å¤šçš„ key å¯¼è‡´å‹åŠ›è¿‡å¤§ï¼Œä»è€Œé¿å…é˜»å¡ä¸»çº¿ç¨‹ã€‚</p><p>ç¬¬äºŒç§æ–¹æ¡ˆï¼ŒRedis 4.0 ä»¥ä¸Šç‰ˆæœ¬ï¼Œå¼€å¯ lazy-free æœºåˆ¶ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># é‡Šæ”¾è¿‡æœŸ key çš„å†…å­˜ï¼Œæ”¾åˆ°åå°çº¿ç¨‹æ‰§è¡Œ</span>
lazyfree-lazy-expire <span class="token function">yes</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦å¤–ï¼Œé™¤äº†ä¸šåŠ¡å±‚é¢çš„ä¼˜åŒ–å’Œä¿®æ”¹é…ç½®ä¹‹å¤–ï¼Œä½ è¿˜å¯ä»¥é€šè¿‡è¿ç»´æ‰‹æ®µåŠæ—¶å‘ç°è¿™ç§æƒ…å†µã€‚</p><p>è¿ç»´å±‚é¢ï¼Œä½ éœ€è¦æŠŠ Redis çš„å„é¡¹è¿è¡ŒçŠ¶æ€æ•°æ®ç›‘æ§èµ·æ¥ï¼Œåœ¨ Redis ä¸Šæ‰§è¡Œ INFO å‘½ä»¤å°±å¯ä»¥æ‹¿åˆ°è¿™ä¸ªå®ä¾‹æ‰€æœ‰çš„è¿è¡ŒçŠ¶æ€æ•°æ®ã€‚</p><p>åœ¨è¿™é‡Œæˆ‘ä»¬éœ€è¦é‡ç‚¹å…³æ³¨ expired_keys è¿™ä¸€é¡¹ï¼Œå®ƒä»£è¡¨æ•´ä¸ªå®ä¾‹åˆ°ç›®å‰ä¸ºæ­¢ï¼Œç´¯è®¡åˆ é™¤è¿‡æœŸ key çš„æ•°é‡ã€‚</p><p>ä½ éœ€è¦æŠŠè¿™ä¸ªæŒ‡æ ‡ç›‘æ§èµ·æ¥ï¼Œ<strong>å½“è¿™ä¸ªæŒ‡æ ‡åœ¨å¾ˆçŸ­æ—¶é—´å†…å‡ºç°äº†çªå¢ï¼Œéœ€è¦åŠæ—¶æŠ¥è­¦å‡ºæ¥</strong>ï¼Œç„¶åä¸ä¸šåŠ¡åº”ç”¨æŠ¥æ…¢çš„æ—¶é—´ç‚¹è¿›è¡Œå¯¹æ¯”åˆ†æï¼Œç¡®è®¤æ—¶é—´æ˜¯å¦ä¸€è‡´ï¼Œå¦‚æœä¸€è‡´ï¼Œåˆ™å¯ä»¥ç¡®è®¤ç¡®å®æ˜¯å› ä¸ºé›†ä¸­è¿‡æœŸ key å¯¼è‡´çš„å»¶è¿Ÿå˜å¤§ã€‚</p><h2 id="_6-å®ä¾‹å†…å­˜è¾¾åˆ°ä¸Šé™" tabindex="-1"><a class="header-anchor" href="#_6-å®ä¾‹å†…å­˜è¾¾åˆ°ä¸Šé™" aria-hidden="true">#</a> 6. å®ä¾‹å†…å­˜è¾¾åˆ°ä¸Šé™</h2><blockquote><p>å¦‚æœä½ çš„ Redis å®ä¾‹è®¾ç½®äº†å†…å­˜ä¸Šé™ maxmemoryï¼Œé‚£ä¹ˆä¹Ÿæœ‰å¯èƒ½å¯¼è‡´ Redis å˜æ…¢ã€‚</p></blockquote><p>å½“æˆ‘ä»¬æŠŠ Redis å½“åšçº¯ç¼“å­˜ä½¿ç”¨æ—¶ï¼Œé€šå¸¸ä¼šç»™è¿™ä¸ªå®ä¾‹è®¾ç½®ä¸€ä¸ªå†…å­˜ä¸Šé™ maxmemoryï¼Œç„¶åè®¾ç½®ä¸€ä¸ªæ•°æ®æ·˜æ±°ç­–ç•¥ã€‚</p><p>è€Œå½“å®ä¾‹çš„å†…å­˜è¾¾åˆ°äº† maxmemory åï¼Œä½ å¯èƒ½ä¼šå‘ç°ï¼Œåœ¨æ­¤ä¹‹åæ¯æ¬¡å†™å…¥æ–°æ•°æ®ï¼Œæ“ä½œå»¶è¿Ÿå˜å¤§äº†ã€‚</p><p>è¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ</p><h3 id="_6-1-é—®é¢˜åŸå› " tabindex="-1"><a class="header-anchor" href="#_6-1-é—®é¢˜åŸå› " aria-hidden="true">#</a> 6.1 é—®é¢˜åŸå› </h3><p>åŸå› åœ¨äºï¼Œå½“ Redis å†…å­˜è¾¾åˆ° maxmemory åï¼Œæ¯æ¬¡å†™å…¥æ–°çš„æ•°æ®ä¹‹å‰ï¼Œ<strong>Redis å¿…é¡»å…ˆä»å®ä¾‹ä¸­è¸¢å‡ºä¸€éƒ¨åˆ†æ•°æ®ï¼Œè®©æ•´ä¸ªå®ä¾‹çš„å†…å­˜ç»´æŒåœ¨ maxmemory ä¹‹ä¸‹ï¼Œç„¶åæ‰èƒ½æŠŠæ–°æ•°æ®å†™è¿›æ¥</strong>ã€‚</p><p>è¿™ä¸ªè¸¢å‡ºæ—§æ•°æ®çš„é€»è¾‘ä¹Ÿæ˜¯éœ€è¦æ¶ˆè€—æ—¶é—´çš„ï¼Œè€Œå…·ä½“è€—æ—¶çš„é•¿çŸ­ï¼Œè¦å–å†³äºä½ é…ç½®çš„æ·˜æ±°ç­–ç•¥ï¼š</p><ul><li><code>allkeys-lru</code>ï¼šä¸ç®¡ key æ˜¯å¦è®¾ç½®äº†è¿‡æœŸï¼Œæ·˜æ±°æœ€è¿‘æœ€å°‘è®¿é—®çš„ key</li><li><code>volatile-lru</code>ï¼šåªæ·˜æ±°æœ€è¿‘æœ€å°‘è®¿é—®ã€å¹¶è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„ key</li><li><code>allkeys-random</code>ï¼šä¸ç®¡ key æ˜¯å¦è®¾ç½®äº†è¿‡æœŸï¼Œéšæœºæ·˜æ±° key</li><li><code>volatile-random</code>ï¼šåªéšæœºæ·˜æ±°è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„ key</li><li><code>allkeys-ttl</code>ï¼šä¸ç®¡ key æ˜¯å¦è®¾ç½®äº†è¿‡æœŸï¼Œæ·˜æ±°å³å°†è¿‡æœŸçš„ key</li><li><code>noeviction</code>ï¼šä¸æ·˜æ±°ä»»ä½• keyï¼Œå®ä¾‹å†…å­˜è¾¾åˆ° maxmeory åï¼Œå†å†™å…¥æ–°æ•°æ®ç›´æ¥è¿”å›é”™è¯¯</li><li><code>allkeys-lfu</code>ï¼šä¸ç®¡ key æ˜¯å¦è®¾ç½®äº†è¿‡æœŸï¼Œæ·˜æ±°è®¿é—®é¢‘ç‡æœ€ä½çš„ keyï¼ˆ4.0+ç‰ˆæœ¬æ”¯æŒï¼‰</li><li><code>volatile-lfu</code>ï¼šåªæ·˜æ±°è®¿é—®é¢‘ç‡æœ€ä½ã€å¹¶è®¾ç½®äº†è¿‡æœŸæ—¶é—´ keyï¼ˆ4.0+ç‰ˆæœ¬æ”¯æŒï¼‰</li></ul><p>å…·ä½“ä½¿ç”¨å“ªç§ç­–ç•¥ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®å…·ä½“çš„ä¸šåŠ¡åœºæ™¯æ¥é…ç½®ã€‚</p><p>ä¸€èˆ¬æœ€å¸¸ä½¿ç”¨çš„æ˜¯ allkeys-lru / volatile-lru æ·˜æ±°ç­–ç•¥ï¼Œå®ƒä»¬çš„å¤„ç†é€»è¾‘æ˜¯ï¼Œæ¯æ¬¡ä»å®ä¾‹ä¸­éšæœºå–å‡ºä¸€æ‰¹ keyï¼ˆè¿™ä¸ªæ•°é‡å¯é…ç½®ï¼‰ï¼Œç„¶åæ·˜æ±°ä¸€ä¸ªæœ€å°‘è®¿é—®çš„ keyï¼Œä¹‹åæŠŠå‰©ä¸‹çš„ key æš‚å­˜åˆ°ä¸€ä¸ªæ± å­ä¸­ï¼Œç»§ç»­éšæœºå–ä¸€æ‰¹ keyï¼Œå¹¶ä¸ä¹‹å‰æ± å­ä¸­çš„ key æ¯”è¾ƒï¼Œå†æ·˜æ±°ä¸€ä¸ªæœ€å°‘è®¿é—®çš„ keyã€‚ä»¥æ­¤å¾€å¤ï¼Œç›´åˆ°å®ä¾‹å†…å­˜é™åˆ° maxmemory ä¹‹ä¸‹ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒRedis çš„æ·˜æ±°æ•°æ®çš„é€»è¾‘ä¸åˆ é™¤è¿‡æœŸ key çš„ä¸€æ ·ï¼Œä¹Ÿæ˜¯åœ¨å‘½ä»¤çœŸæ­£æ‰§è¡Œä¹‹å‰æ‰§è¡Œçš„ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä¹Ÿä¼šå¢åŠ æˆ‘ä»¬æ“ä½œ Redis çš„å»¶è¿Ÿï¼Œè€Œä¸”ï¼Œå†™ OPS è¶Šé«˜ï¼Œå»¶è¿Ÿä¹Ÿä¼šè¶Šæ˜æ˜¾ã€‚</p><figure><img src="https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/image-20220627224651167.png" alt="image-20220627224651167" tabindex="0" loading="lazy"><figcaption>image-20220627224651167</figcaption></figure><p>å¦å¤–ï¼Œå¦‚æœæ­¤æ—¶ä½ çš„ Redis å®ä¾‹ä¸­è¿˜å­˜å‚¨äº† bigkeyï¼Œé‚£ä¹ˆåœ¨æ·˜æ±°åˆ é™¤ bigkey é‡Šæ”¾å†…å­˜æ—¶ï¼Œä¹Ÿä¼šè€—æ—¶æ¯”è¾ƒä¹…ã€‚</p><p>çœ‹åˆ°äº†ä¹ˆï¼Ÿbigkey çš„å±å®³åˆ°å¤„éƒ½æ˜¯ï¼Œè¿™ä¹Ÿæ˜¯å‰é¢æˆ‘æé†’ä½ å°½é‡ä¸å­˜å‚¨ bigkey çš„åŸå› ã€‚</p><h3 id="_6-2-è§£å†³" tabindex="-1"><a class="header-anchor" href="#_6-2-è§£å†³" aria-hidden="true">#</a> 6.2 è§£å†³</h3><p><strong>é’ˆå¯¹è¿™ç§æƒ…å†µï¼Œå¦‚ä½•è§£å†³å‘¢</strong>ï¼Ÿ</p><p>æˆ‘ç»™ä½  4 ä¸ªæ–¹é¢çš„ä¼˜åŒ–å»ºè®®ï¼š</p><ul><li>é¿å…å­˜å‚¨ bigkeyï¼Œé™ä½é‡Šæ”¾å†…å­˜çš„è€—æ—¶</li><li>æ·˜æ±°ç­–ç•¥æ”¹ä¸ºéšæœºæ·˜æ±°ï¼Œéšæœºæ·˜æ±°æ¯” LRU è¦å¿«å¾ˆå¤šï¼ˆè§†ä¸šåŠ¡æƒ…å†µè°ƒæ•´ï¼‰</li><li>æ‹†åˆ†å®ä¾‹ï¼ŒæŠŠæ·˜æ±° key çš„å‹åŠ›åˆ†æ‘Šåˆ°å¤šä¸ªå®ä¾‹ä¸Š</li><li>å¦‚æœä½¿ç”¨çš„æ˜¯ Redis 4.0 ä»¥ä¸Šç‰ˆæœ¬ï¼Œå¼€å¯ layz-free æœºåˆ¶ï¼ŒæŠŠæ·˜æ±° key é‡Šæ”¾å†…å­˜çš„æ“ä½œæ”¾åˆ°åå°çº¿ç¨‹ä¸­æ‰§è¡Œï¼ˆé…ç½® lazyfree-lazy-eviction = yesï¼‰</li></ul><h2 id="_7-forkè€—æ—¶ä¸¥é‡" tabindex="-1"><a class="header-anchor" href="#_7-forkè€—æ—¶ä¸¥é‡" aria-hidden="true">#</a> 7. forkè€—æ—¶ä¸¥é‡</h2><blockquote><p>ä¸ºäº†ä¿è¯ Redis æ•°æ®çš„å®‰å…¨æ€§ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå¼€å¯åå°å®šæ—¶ RDB å’Œ AOF rewrite åŠŸèƒ½ã€‚ä½†å¦‚æœä½ å‘ç°ï¼Œæ“ä½œ Redis å»¶è¿Ÿå˜å¤§ï¼Œéƒ½å‘ç”Ÿåœ¨ Redis åå° RDB å’Œ AOF rewrite æœŸé—´ï¼Œé‚£ä½ å°±éœ€è¦æ’æŸ¥ï¼Œåœ¨è¿™æœŸé—´æœ‰å¯èƒ½å¯¼è‡´å˜æ…¢çš„æƒ…å†µã€‚</p></blockquote><p>å½“ Redis å¼€å¯äº†åå° RDB å’Œ AOF rewrite åï¼Œåœ¨æ‰§è¡Œæ—¶ï¼Œå®ƒä»¬éƒ½éœ€è¦ä¸»è¿›ç¨‹åˆ›å»ºå‡ºä¸€ä¸ªå­è¿›ç¨‹è¿›è¡Œæ•°æ®çš„æŒä¹…åŒ–ã€‚</p><p><strong>ä¸»è¿›ç¨‹åˆ›å»ºå­è¿›ç¨‹ï¼Œä¼šè°ƒç”¨æ“ä½œç³»ç»Ÿæä¾›çš„ fork å‡½æ•°</strong>ã€‚</p><p>è€Œ fork åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œä¸»è¿›ç¨‹éœ€è¦æ‹·è´è‡ªå·±çš„å†…å­˜é¡µè¡¨ç»™å­è¿›ç¨‹ï¼Œå¦‚æœè¿™ä¸ªå®ä¾‹å¾ˆå¤§ï¼Œé‚£ä¹ˆè¿™ä¸ªæ‹·è´çš„è¿‡ç¨‹ä¹Ÿä¼šæ¯”è¾ƒè€—æ—¶ã€‚</p><p>è€Œä¸”è¿™ä¸ª fork è¿‡ç¨‹ä¼šæ¶ˆè€—å¤§é‡çš„ CPU èµ„æºï¼Œåœ¨å®Œæˆ fork ä¹‹å‰ï¼Œæ•´ä¸ª Redis å®ä¾‹ä¼šè¢«é˜»å¡ä½ï¼Œæ— æ³•å¤„ç†ä»»ä½•å®¢æˆ·ç«¯è¯·æ±‚ã€‚</p><p>å¦‚æœæ­¤æ—¶ä½ çš„ CPU èµ„æºæœ¬æ¥å°±å¾ˆç´§å¼ ï¼Œé‚£ä¹ˆ fork çš„è€—æ—¶ä¼šæ›´é•¿ï¼Œç”šè‡³è¾¾åˆ°ç§’çº§ï¼Œè¿™ä¼šä¸¥é‡å½±å“ Redis çš„æ€§èƒ½ã€‚</p><p>é‚£å¦‚ä½•ç¡®è®¤ç¡®å®æ˜¯å› ä¸º fork è€—æ—¶å¯¼è‡´çš„ Redis å»¶è¿Ÿå˜å¤§å‘¢ï¼Ÿ</p><p>ä½ å¯ä»¥åœ¨ Redis ä¸Šæ‰§è¡Œ INFO å‘½ä»¤ï¼ŒæŸ¥çœ‹ latest_fork_usec é¡¹ï¼Œå•ä½å¾®ç§’ã€‚</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># ä¸Šä¸€æ¬¡ fork è€—æ—¶ï¼Œå•ä½å¾®ç§’</span>
latest_fork_usec:59477
 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªæ—¶é—´å°±æ˜¯ä¸»è¿›ç¨‹åœ¨ fork å­è¿›ç¨‹æœŸé—´ï¼Œæ•´ä¸ªå®ä¾‹é˜»å¡æ— æ³•å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚çš„æ—¶é—´ã€‚</p><p>å¦‚æœä½ å‘ç°è¿™ä¸ªè€—æ—¶å¾ˆä¹…ï¼Œå°±è¦è­¦æƒ•èµ·æ¥äº†ï¼Œè¿™æ„å‘³åœ¨è¿™æœŸé—´ï¼Œä½ çš„æ•´ä¸ª Redis å®ä¾‹éƒ½å¤„äºä¸å¯ç”¨çš„çŠ¶æ€ã€‚</p><p>é™¤äº†æ•°æ®æŒä¹…åŒ–ä¼šç”Ÿæˆ RDB ä¹‹å¤–ï¼Œå½“ä¸»ä»èŠ‚ç‚¹ç¬¬ä¸€æ¬¡å»ºç«‹æ•°æ®åŒæ­¥æ—¶ï¼Œä¸»èŠ‚ç‚¹ä¹Ÿåˆ›å»ºå­è¿›ç¨‹ç”Ÿæˆ RDBï¼Œç„¶åå‘ç»™ä»èŠ‚ç‚¹è¿›è¡Œä¸€æ¬¡å…¨é‡åŒæ­¥ï¼Œæ‰€ä»¥ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¹Ÿä¼šå¯¹ Redis äº§ç”Ÿæ€§èƒ½å½±å“ã€‚</p><figure><img src="https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/image-20220627225032103.png" alt="image-20220627225032103" tabindex="0" loading="lazy"><figcaption>image-20220627225032103</figcaption></figure><h3 id="_7-1-ä¼˜åŒ–æ–¹æ¡ˆ" tabindex="-1"><a class="header-anchor" href="#_7-1-ä¼˜åŒ–æ–¹æ¡ˆ" aria-hidden="true">#</a> 7.1 ä¼˜åŒ–æ–¹æ¡ˆ</h3><p>è¦æƒ³é¿å…è¿™ç§æƒ…å†µï¼Œä½ å¯ä»¥é‡‡å–ä»¥ä¸‹æ–¹æ¡ˆè¿›è¡Œä¼˜åŒ–ï¼š</p><ul><li>æ§åˆ¶ Redis å®ä¾‹çš„å†…å­˜ï¼šå°½é‡åœ¨ 10G ä»¥ä¸‹ï¼Œæ‰§è¡Œ fork çš„è€—æ—¶ä¸å®ä¾‹å¤§å°æœ‰å…³ï¼Œå®ä¾‹è¶Šå¤§ï¼Œè€—æ—¶è¶Šä¹…</li><li>åˆç†é…ç½®æ•°æ®æŒä¹…åŒ–ç­–ç•¥ï¼šåœ¨ slave èŠ‚ç‚¹æ‰§è¡Œ RDB å¤‡ä»½ï¼Œæ¨èåœ¨ä½å³°æœŸæ‰§è¡Œï¼Œè€Œå¯¹äºä¸¢å¤±æ•°æ®ä¸æ•æ„Ÿçš„ä¸šåŠ¡ï¼ˆä¾‹å¦‚æŠŠ Redis å½“åšçº¯ç¼“å­˜ä½¿ç”¨ï¼‰ï¼Œå¯ä»¥å…³é—­ AOF å’Œ AOF rewrite</li><li>Redis å®ä¾‹ä¸è¦éƒ¨ç½²åœ¨è™šæ‹Ÿæœºä¸Šï¼šfork çš„è€—æ—¶ä¹Ÿä¸ç³»ç»Ÿä¹Ÿæœ‰å…³ï¼Œè™šæ‹Ÿæœºæ¯”ç‰©ç†æœºè€—æ—¶æ›´ä¹…</li><li>é™ä½ä¸»ä»åº“å…¨é‡åŒæ­¥çš„æ¦‚ç‡ï¼šé€‚å½“è°ƒå¤§ repl-backlog-size å‚æ•°ï¼Œé¿å…ä¸»ä»å…¨é‡åŒæ­¥</li></ul><h2 id="_8-å¼€å¯å†…å­˜å¤§é¡µ" tabindex="-1"><a class="header-anchor" href="#_8-å¼€å¯å†…å­˜å¤§é¡µ" aria-hidden="true">#</a> 8. å¼€å¯å†…å­˜å¤§é¡µ</h2><blockquote><p>é™¤äº†ä¸Šé¢è®²åˆ°çš„å­è¿›ç¨‹ RDB å’Œ AOF rewrite æœŸé—´ï¼Œfork è€—æ—¶å¯¼è‡´çš„å»¶æ—¶å˜å¤§ä¹‹å¤–ï¼Œè¿™é‡Œè¿˜æœ‰ä¸€ä¸ªæ–¹é¢ä¹Ÿä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ï¼Œè¿™å°±æ˜¯æ“ä½œç³»ç»Ÿæ˜¯å¦å¼€å¯äº†å†…å­˜å¤§é¡µæœºåˆ¶ã€‚</p></blockquote><h3 id="_8-1-ä»€ä¹ˆæ˜¯å†…å­˜å¤§é¡µ" tabindex="-1"><a class="header-anchor" href="#_8-1-ä»€ä¹ˆæ˜¯å†…å­˜å¤§é¡µ" aria-hidden="true">#</a> 8.1 <strong>ä»€ä¹ˆæ˜¯å†…å­˜å¤§é¡µ</strong>ï¼Ÿ</h3><p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œåº”ç”¨ç¨‹åºå‘æ“ä½œç³»ç»Ÿç”³è¯·å†…å­˜æ—¶ï¼Œæ˜¯æŒ‰å†…å­˜é¡µè¿›è¡Œç”³è¯·çš„ï¼Œè€Œå¸¸è§„çš„å†…å­˜é¡µå¤§å°æ˜¯ 4KBã€‚</p><p>Linux å†…æ ¸ä» 2.6.38 å¼€å§‹ï¼Œæ”¯æŒäº†å†…å­˜å¤§é¡µæœºåˆ¶ï¼Œè¯¥æœºåˆ¶å…è®¸åº”ç”¨ç¨‹åºä»¥ 2MB å¤§å°ä¸ºå•ä½ï¼Œå‘æ“ä½œç³»ç»Ÿç”³è¯·å†…å­˜ã€‚</p><p>åº”ç”¨ç¨‹åºæ¯æ¬¡å‘æ“ä½œç³»ç»Ÿç”³è¯·çš„å†…å­˜å•ä½å˜å¤§äº†ï¼Œä½†è¿™ä¹Ÿæ„å‘³ç€ç”³è¯·å†…å­˜çš„è€—æ—¶å˜é•¿ã€‚</p><h3 id="_8-2-è¿™å¯¹-redis-ä¼šæœ‰ä»€ä¹ˆå½±å“å‘¢" tabindex="-1"><a class="header-anchor" href="#_8-2-è¿™å¯¹-redis-ä¼šæœ‰ä»€ä¹ˆå½±å“å‘¢" aria-hidden="true">#</a> 8.2 <strong>è¿™å¯¹ Redis ä¼šæœ‰ä»€ä¹ˆå½±å“å‘¢</strong>ï¼Ÿ</h3><p>å½“ Redis åœ¨æ‰§è¡Œåå° RDB å’Œ AOF rewrite æ—¶ï¼Œé‡‡ç”¨ fork å­è¿›ç¨‹çš„æ–¹å¼æ¥å¤„ç†ã€‚ä½†ä¸»è¿›ç¨‹ fork å­è¿›ç¨‹åï¼Œæ­¤æ—¶çš„ä¸»è¿›ç¨‹ä¾æ—§æ˜¯å¯ä»¥æ¥æ”¶å†™è¯·æ±‚çš„ï¼Œè€Œè¿›æ¥çš„å†™è¯·æ±‚ï¼Œä¼šé‡‡ç”¨ Copy On Writeï¼ˆå†™æ—¶å¤åˆ¶ï¼‰çš„æ–¹å¼æ“ä½œå†…å­˜æ•°æ®ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸»è¿›ç¨‹ä¸€æ—¦æœ‰æ•°æ®éœ€è¦ä¿®æ”¹ï¼ŒRedis å¹¶ä¸ä¼šç›´æ¥ä¿®æ”¹ç°æœ‰å†…å­˜ä¸­çš„æ•°æ®ï¼Œè€Œæ˜¯å…ˆå°†è¿™å—å†…å­˜æ•°æ®æ‹·è´å‡ºæ¥ï¼Œå†ä¿®æ”¹è¿™å—æ–°å†…å­˜çš„æ•°æ®ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„ã€Œå†™æ—¶å¤åˆ¶ã€ã€‚</p><p>å†™æ—¶å¤åˆ¶ä½ ä¹Ÿå¯ä»¥ç†è§£æˆï¼Œè°éœ€è¦å‘ç”Ÿå†™æ“ä½œï¼Œè°å°±éœ€è¦å…ˆæ‹·è´ï¼Œå†ä¿®æ”¹ã€‚</p><p>è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œçˆ¶è¿›ç¨‹æœ‰ä»»ä½•å†™æ“ä½œï¼Œå¹¶ä¸ä¼šå½±å“å­è¿›ç¨‹çš„æ•°æ®æŒä¹…åŒ–ï¼ˆå­è¿›ç¨‹åªæŒä¹…åŒ– fork è¿™ä¸€ç¬é—´æ•´ä¸ªå®ä¾‹ä¸­çš„æ‰€æœ‰æ•°æ®å³å¯ï¼Œä¸å…³å¿ƒæ–°çš„æ•°æ®å˜æ›´ï¼Œå› ä¸ºå­è¿›ç¨‹åªéœ€è¦ä¸€ä»½å†…å­˜å¿«ç…§ï¼Œç„¶åæŒä¹…åŒ–åˆ°ç£ç›˜ä¸Šï¼‰ã€‚</p><p>ä½†æ˜¯è¯·æ³¨æ„ï¼Œ<strong>ä¸»è¿›ç¨‹åœ¨æ‹·è´å†…å­˜æ•°æ®æ—¶ï¼Œè¿™ä¸ªé˜¶æ®µå°±æ¶‰åŠåˆ°æ–°å†…å­˜çš„ç”³è¯·ï¼Œå¦‚æœæ­¤æ—¶æ“ä½œç³»ç»Ÿå¼€å¯äº†å†…å­˜å¤§é¡µï¼Œé‚£ä¹ˆåœ¨æ­¤æœŸé—´ï¼Œå®¢æˆ·ç«¯å³ä¾¿åªä¿®æ”¹ 10B çš„æ•°æ®ï¼ŒRedis åœ¨ç”³è¯·å†…å­˜æ—¶ä¹Ÿä¼šä»¥ 2MB ä¸ºå•ä½å‘æ“ä½œç³»ç»Ÿç”³è¯·ï¼Œç”³è¯·å†…å­˜çš„è€—æ—¶å˜é•¿ï¼Œè¿›è€Œå¯¼è‡´æ¯ä¸ªå†™è¯·æ±‚çš„å»¶è¿Ÿå¢åŠ ï¼Œå½±å“åˆ° Redis æ€§èƒ½</strong>ã€‚</p><p>åŒæ ·åœ°ï¼Œå¦‚æœè¿™ä¸ªå†™è¯·æ±‚æ“ä½œçš„æ˜¯ä¸€ä¸ª bigkeyï¼Œé‚£ä¸»è¿›ç¨‹åœ¨æ‹·è´è¿™ä¸ª bigkey å†…å­˜å—æ—¶ï¼Œä¸€æ¬¡ç”³è¯·çš„å†…å­˜ä¼šæ›´å¤§ï¼Œæ—¶é—´ä¹Ÿä¼šæ›´ä¹…ã€‚å¯è§ï¼Œbigkey åœ¨è¿™é‡Œåˆä¸€æ¬¡å½±å“åˆ°äº†æ€§èƒ½ã€‚</p><figure><img src="https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/image-20220627225331549.png" alt="image-20220627225331549" tabindex="0" loading="lazy"><figcaption>image-20220627225331549</figcaption></figure><h3 id="_8-3-é‚£å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜" tabindex="-1"><a class="header-anchor" href="#_8-3-é‚£å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜" aria-hidden="true">#</a> 8.3 <strong>é‚£å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜</strong>ï¼Ÿ</h3><p>å¾ˆç®€å•ï¼Œä½ åªéœ€è¦å…³é—­å†…å­˜å¤§é¡µæœºåˆ¶å°±å¯ä»¥äº†ã€‚</p><p>é¦–å…ˆï¼Œä½ éœ€è¦æŸ¥çœ‹ Redis æœºå™¨æ˜¯å¦å¼€å¯äº†å†…å­˜å¤§é¡µï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ <span class="token function">cat</span> /sys/kernel/mm/transparent_hugepage/enabled
<span class="token punctuation">[</span>always<span class="token punctuation">]</span> madvise never
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœè¾“å‡ºé€‰é¡¹æ˜¯ alwaysï¼Œå°±è¡¨ç¤ºç›®å‰å¼€å¯äº†å†…å­˜å¤§é¡µæœºåˆ¶ï¼Œæˆ‘ä»¬éœ€è¦å…³æ‰å®ƒï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ <span class="token builtin class-name">echo</span> never <span class="token operator">&gt;</span> /sys/kernel/mm/transparent_hugepage/enabled
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å…¶å®ï¼Œæ“ä½œç³»ç»Ÿæä¾›çš„å†…å­˜å¤§é¡µæœºåˆ¶ï¼Œå…¶ä¼˜åŠ¿æ˜¯ï¼Œå¯ä»¥åœ¨ä¸€å®šç¨‹åºä¸Šé™ä½åº”ç”¨ç¨‹åºç”³è¯·å†…å­˜çš„æ¬¡æ•°ã€‚</p><p>ä½†æ˜¯å¯¹äº Redis è¿™ç§å¯¹æ€§èƒ½å’Œå»¶è¿Ÿæå…¶æ•æ„Ÿçš„æ•°æ®åº“æ¥è¯´ï¼Œæˆ‘ä»¬å¸Œæœ› Redis åœ¨æ¯æ¬¡ç”³è¯·å†…å­˜æ—¶ï¼Œè€—æ—¶å°½é‡çŸ­ï¼Œæ‰€ä»¥æˆ‘ä¸å»ºè®®ä½ åœ¨ Redis æœºå™¨ä¸Šå¼€å¯è¿™ä¸ªæœºåˆ¶ã€‚</p><h2 id="_9-å¼€å¯aof" tabindex="-1"><a class="header-anchor" href="#_9-å¼€å¯aof" aria-hidden="true">#</a> 9. å¼€å¯AOF</h2><blockquote><p>å‰é¢æˆ‘ä»¬åˆ†æäº† RDB å’Œ AOF rewrite å¯¹ Redis æ€§èƒ½çš„å½±å“ï¼Œä¸»è¦å…³æ³¨ç‚¹åœ¨ fork ä¸Šã€‚</p></blockquote><p>å…¶å®ï¼Œå…³äºæ•°æ®æŒä¹…åŒ–æ–¹é¢ï¼Œè¿˜æœ‰å½±å“ Redis æ€§èƒ½çš„å› ç´ ï¼Œè¿™æ¬¡æˆ‘ä»¬é‡ç‚¹æ¥çœ‹ AOF æ•°æ®æŒä¹…åŒ–ã€‚</p><p>å¦‚æœä½ çš„ AOF é…ç½®ä¸åˆç†ï¼Œè¿˜æ˜¯æœ‰å¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚</p><p>å½“ Redis å¼€å¯ AOF åï¼Œå…¶å·¥ä½œåŸç†å¦‚ä¸‹ï¼š</p><ul><li>Redis æ‰§è¡Œå†™å‘½ä»¤åï¼ŒæŠŠè¿™ä¸ªå‘½ä»¤å†™å…¥åˆ° AOF æ–‡ä»¶å†…å­˜ä¸­ï¼ˆwrite ç³»ç»Ÿè°ƒç”¨ï¼‰</li><li>Redis æ ¹æ®é…ç½®çš„ AOF åˆ·ç›˜ç­–ç•¥ï¼ŒæŠŠ AOF å†…å­˜æ•°æ®åˆ·åˆ°ç£ç›˜ä¸Šï¼ˆfsync ç³»ç»Ÿè°ƒç”¨ï¼‰</li></ul><p>ä¸ºäº†ä¿è¯ AOF æ–‡ä»¶æ•°æ®çš„å®‰å…¨æ€§ï¼ŒRedis æä¾›äº† 3 ç§åˆ·ç›˜æœºåˆ¶ï¼š</p><ul><li>appendfsync alwaysï¼šä¸»çº¿ç¨‹æ¯æ¬¡æ‰§è¡Œå†™æ“ä½œåç«‹å³åˆ·ç›˜ï¼Œæ­¤æ–¹æ¡ˆä¼šå ç”¨æ¯”è¾ƒå¤§çš„ç£ç›˜ IO èµ„æºï¼Œä½†æ•°æ®å®‰å…¨æ€§æœ€é«˜</li><li>appendfsync noï¼šä¸»çº¿ç¨‹æ¯æ¬¡å†™æ“ä½œåªå†™å†…å­˜å°±è¿”å›ï¼Œå†…å­˜æ•°æ®ä»€ä¹ˆæ—¶å€™åˆ·åˆ°ç£ç›˜ï¼Œäº¤ç”±æ“ä½œç³»ç»Ÿå†³å®šï¼Œæ­¤æ–¹æ¡ˆå¯¹æ€§èƒ½å½±å“æœ€å°ï¼Œä½†æ•°æ®å®‰å…¨æ€§ä¹Ÿæœ€ä½ï¼ŒRedis å®•æœºæ—¶ä¸¢å¤±çš„æ•°æ®å–å†³äºæ“ä½œç³»ç»Ÿåˆ·ç›˜æ—¶æœº</li><li>appendfsync everysecï¼šä¸»çº¿ç¨‹æ¯æ¬¡å†™æ“ä½œåªå†™å†…å­˜å°±è¿”å›ï¼Œç„¶åç”±åå°çº¿ç¨‹æ¯éš” 1 ç§’æ‰§è¡Œä¸€æ¬¡åˆ·ç›˜æ“ä½œï¼ˆè§¦å‘fsyncç³»ç»Ÿè°ƒç”¨ï¼‰ï¼Œæ­¤æ–¹æ¡ˆå¯¹æ€§èƒ½å½±å“ç›¸å¯¹è¾ƒå°ï¼Œä½†å½“ Redis å®•æœºæ—¶ä¼šä¸¢å¤± 1 ç§’çš„æ•°æ®</li></ul><p>ä¸‹é¢æˆ‘ä»¬ä¾æ¬¡æ¥åˆ†æï¼Œè¿™å‡ ä¸ªæœºåˆ¶å¯¹æ€§èƒ½çš„å½±å“ã€‚</p><p>å¦‚æœä½ çš„ AOF é…ç½®ä¸º appendfsync alwaysï¼Œé‚£ä¹ˆ Redis æ¯å¤„ç†ä¸€æ¬¡å†™æ“ä½œï¼Œéƒ½ä¼šæŠŠè¿™ä¸ªå‘½ä»¤å†™å…¥åˆ°ç£ç›˜ä¸­æ‰è¿”å›ï¼Œæ•´ä¸ªè¿‡ç¨‹éƒ½æ˜¯åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œçš„ï¼Œè¿™ä¸ªè¿‡ç¨‹å¿…ç„¶ä¼šåŠ é‡ Redis å†™è´Ÿæ‹…ã€‚</p><p>åŸå› ä¹Ÿå¾ˆç®€å•ï¼Œæ“ä½œç£ç›˜è¦æ¯”æ“ä½œå†…å­˜æ…¢å‡ ç™¾å€ï¼Œé‡‡ç”¨è¿™ä¸ªé…ç½®ä¼šä¸¥é‡æ‹–æ…¢ Redis çš„æ€§èƒ½ï¼Œå› æ­¤æˆ‘ä¸å»ºè®®ä½ æŠŠ AOF åˆ·ç›˜æ–¹å¼é…ç½®ä¸º alwaysã€‚</p><p>æˆ‘ä»¬æ¥ç€æ¥çœ‹ appendfsync no é…ç½®é¡¹ã€‚</p><p>åœ¨è¿™ç§é…ç½®ä¸‹ï¼ŒRedis æ¯æ¬¡å†™æ“ä½œåªå†™å†…å­˜ï¼Œä»€ä¹ˆæ—¶å€™æŠŠå†…å­˜ä¸­çš„æ•°æ®åˆ·åˆ°ç£ç›˜ï¼Œäº¤ç»™æ“ä½œç³»ç»Ÿå†³å®šï¼Œæ­¤æ–¹æ¡ˆå¯¹ Redis çš„æ€§èƒ½å½±å“æœ€å°ï¼Œä½†å½“ Redis å®•æœºæ—¶ï¼Œä¼šä¸¢å¤±ä¸€éƒ¨åˆ†æ•°æ®ï¼Œä¸ºäº†æ•°æ®çš„å®‰å…¨æ€§ï¼Œä¸€èˆ¬æˆ‘ä»¬ä¹Ÿä¸é‡‡å–è¿™ç§é…ç½®ã€‚</p><blockquote><p>å¦‚æœä½ çš„ Redis åªç”¨ä½œçº¯ç¼“å­˜ï¼Œå¯¹äºæ•°æ®ä¸¢å¤±ä¸æ•æ„Ÿï¼Œé‡‡ç”¨é…ç½® appendfsync no ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p></blockquote><p>çœ‹åˆ°è¿™é‡Œï¼Œæˆ‘çŒœä½ è‚¯å®šå’Œå¤§å¤šæ•°äººçš„æƒ³æ³•ä¸€æ ·ï¼Œé€‰æ¯”è¾ƒæŠ˜ä¸­çš„æ–¹æ¡ˆ appendfsync everysec å°±æ²¡é—®é¢˜äº†å§ï¼Ÿ</p><p>è¿™ä¸ªæ–¹æ¡ˆä¼˜åŠ¿åœ¨äºï¼ŒRedis ä¸»çº¿ç¨‹å†™å®Œå†…å­˜åå°±è¿”å›ï¼Œå…·ä½“çš„åˆ·ç›˜æ“ä½œæ˜¯æ”¾åˆ°åå°çº¿ç¨‹ä¸­æ‰§è¡Œçš„ï¼Œåå°çº¿ç¨‹æ¯éš” 1 ç§’æŠŠå†…å­˜ä¸­çš„æ•°æ®åˆ·åˆ°ç£ç›˜ä¸­ã€‚</p><p>è¿™ç§æ–¹æ¡ˆæ—¢å…¼é¡¾äº†æ€§èƒ½ï¼Œåˆå°½å¯èƒ½åœ°ä¿è¯äº†æ•°æ®å®‰å…¨ï¼Œæ˜¯ä¸æ˜¯è§‰å¾—å¾ˆå®Œç¾ï¼Ÿ</p><p><strong>ä½†æ˜¯ï¼Œè¿™é‡Œæˆ‘è¦ç»™ä½ æ³¼ä¸€ç›†å†·æ°´äº†ï¼Œé‡‡ç”¨è¿™ç§æ–¹æ¡ˆä½ ä¹Ÿè¦è­¦æƒ•ä¸€ä¸‹ï¼Œå› ä¸ºè¿™ç§æ–¹æ¡ˆè¿˜æ˜¯å­˜åœ¨å¯¼è‡´ Redis å»¶è¿Ÿå˜å¤§çš„æƒ…å†µå‘ç”Ÿï¼Œç”šè‡³ä¼šé˜»å¡æ•´ä¸ª Redis</strong>ã€‚</p><p>è¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿæˆ‘æŠŠ AOF æœ€è€—æ—¶çš„åˆ·ç›˜æ“ä½œï¼Œæ”¾åˆ°åå°çº¿ç¨‹ä¸­ä¹Ÿä¼šå½±å“åˆ° Redis ä¸»çº¿ç¨‹ï¼Ÿ</p><p>ä½ è¯•æƒ³è¿™æ ·ä¸€ç§æƒ…å†µï¼šå½“ Redis åå°çº¿ç¨‹åœ¨æ‰§è¡Œ AOF æ–‡ä»¶åˆ·ç›˜æ—¶ï¼Œå¦‚æœæ­¤æ—¶ç£ç›˜çš„ IO è´Ÿè½½å¾ˆé«˜ï¼Œé‚£è¿™ä¸ªåå°çº¿ç¨‹åœ¨æ‰§è¡Œåˆ·ç›˜æ“ä½œï¼ˆfsyncç³»ç»Ÿè°ƒç”¨ï¼‰æ—¶å°±ä¼šè¢«é˜»å¡ä½ã€‚</p><p>æ­¤æ—¶çš„ä¸»çº¿ç¨‹ä¾æ—§ä¼šæ¥æ”¶å†™è¯·æ±‚ï¼Œç´§æ¥ç€ï¼Œä¸»çº¿ç¨‹åˆéœ€è¦æŠŠæ•°æ®å†™åˆ°æ–‡ä»¶å†…å­˜ä¸­ï¼ˆwrite ç³»ç»Ÿè°ƒç”¨ï¼‰ï¼Œ<strong>ä½†æ­¤æ—¶çš„åå°å­çº¿ç¨‹ç”±äºç£ç›˜è´Ÿè½½è¿‡é«˜ï¼Œå¯¼è‡´ fsync å‘ç”Ÿé˜»å¡ï¼Œè¿Ÿè¿Ÿä¸èƒ½è¿”å›ï¼Œé‚£ä¸»çº¿ç¨‹åœ¨æ‰§è¡Œ write ç³»ç»Ÿè°ƒç”¨æ—¶ï¼Œä¹Ÿä¼šè¢«é˜»å¡ä½ï¼Œç›´åˆ°åå°çº¿ç¨‹ fsync æ‰§è¡Œå®Œæˆåï¼Œä¸»çº¿ç¨‹æ‰§è¡Œ write æ‰èƒ½æˆåŠŸè¿”å›</strong>ã€‚</p><p>çœ‹åˆ°äº†ä¹ˆï¼Ÿåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¸»çº¿ç¨‹ä¾æ—§æœ‰é˜»å¡çš„é£é™©</p><figure><img src="https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/image-20220627225820723.png" alt="image-20220627225820723" tabindex="0" loading="lazy"><figcaption>image-20220627225820723</figcaption></figure><p>æ‰€ä»¥ï¼Œå°½ç®¡ä½ çš„ AOF é…ç½®ä¸º appendfsync everysecï¼Œä¹Ÿä¸èƒ½æ‰ä»¥è½»å¿ƒï¼Œè¦è­¦æƒ•ç£ç›˜å‹åŠ›è¿‡å¤§å¯¼è‡´çš„ Redis æœ‰æ€§èƒ½é—®é¢˜ã€‚</p><p>é‚£ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¯¼è‡´ç£ç›˜ IO è´Ÿè½½è¿‡å¤§ï¼Ÿä»¥åŠå¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ</p><p>æˆ‘æ€»ç»“äº†ä»¥ä¸‹å‡ ç§æƒ…å†µï¼Œä½ å¯ä»¥å‚è€ƒè¿›è¡Œé—®é¢˜æ’æŸ¥ï¼š</p><ul><li>å­è¿›ç¨‹æ­£åœ¨æ‰§è¡Œ AOF rewriteï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šå ç”¨å¤§é‡çš„ç£ç›˜ IO èµ„æº</li><li>æœ‰å…¶ä»–åº”ç”¨ç¨‹åºåœ¨æ‰§è¡Œå¤§é‡çš„å†™æ–‡ä»¶æ“ä½œï¼Œä¹Ÿä¼šå ç”¨ç£ç›˜ IO èµ„æº</li></ul><p>å¯¹äºæƒ…å†µ1ï¼Œè¯´ç™½äº†å°±æ˜¯ï¼ŒRedis çš„ AOF åå°å­çº¿ç¨‹åˆ·ç›˜æ“ä½œï¼Œæ’ä¸Šäº†å­è¿›ç¨‹ AOF rewriteï¼</p><p>è¿™æ€ä¹ˆåŠï¼Ÿéš¾é“è¦å…³é—­ AOF rewrite æ‰è¡Œï¼Ÿ</p><p>å¹¸è¿çš„æ˜¯ï¼ŒRedis æä¾›äº†ä¸€ä¸ªé…ç½®é¡¹ï¼Œå½“å­è¿›ç¨‹åœ¨ AOF rewrite æœŸé—´ï¼Œå¯ä»¥è®©åå°å­çº¿ç¨‹ä¸æ‰§è¡Œåˆ·ç›˜ï¼ˆä¸è§¦å‘ fsync ç³»ç»Ÿè°ƒç”¨ï¼‰æ“ä½œã€‚</p><p>è¿™ç›¸å½“äºåœ¨ AOF rewrite æœŸé—´ï¼Œä¸´æ—¶æŠŠ appendfsync è®¾ç½®ä¸ºäº† noneï¼Œé…ç½®å¦‚ä¸‹ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># AOF rewrite æœŸé—´ï¼ŒAOF åå°å­çº¿ç¨‹ä¸è¿›è¡Œåˆ·ç›˜æ“ä½œ</span>
<span class="token comment"># ç›¸å½“äºåœ¨è¿™æœŸé—´ï¼Œä¸´æ—¶æŠŠ appendfsync è®¾ç½®ä¸ºäº† none</span>
no-appendfsync-on-rewrite <span class="token function">yes</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“ç„¶ï¼Œå¼€å¯è¿™ä¸ªé…ç½®é¡¹ï¼Œåœ¨ AOF rewrite æœŸé—´ï¼Œå¦‚æœå®ä¾‹å‘ç”Ÿå®•æœºï¼Œé‚£ä¹ˆæ­¤æ—¶ä¼šä¸¢å¤±æ›´å¤šçš„æ•°æ®ï¼Œæ€§èƒ½å’Œæ•°æ®å®‰å…¨æ€§ï¼Œä½ éœ€è¦æƒè¡¡åè¿›è¡Œé€‰æ‹©ã€‚</p><p>å¦‚æœå ç”¨ç£ç›˜èµ„æºçš„æ˜¯å…¶ä»–åº”ç”¨ç¨‹åºï¼Œé‚£å°±æ¯”è¾ƒç®€å•äº†ï¼Œä½ éœ€è¦å®šä½åˆ°æ˜¯å“ªä¸ªåº”ç”¨ç¨‹åºåœ¨å¤§é‡å†™ç£ç›˜ï¼Œç„¶åæŠŠè¿™ä¸ªåº”ç”¨ç¨‹åºè¿ç§»åˆ°å…¶ä»–æœºå™¨ä¸Šæ‰§è¡Œå°±å¥½äº†ï¼Œé¿å…å¯¹ Redis äº§ç”Ÿå½±å“ã€‚</p><p>å½“ç„¶ï¼Œå¦‚æœä½ å¯¹ Redis çš„æ€§èƒ½å’Œæ•°æ®å®‰å…¨éƒ½æœ‰å¾ˆé«˜çš„è¦æ±‚ï¼Œé‚£ä¹ˆæˆ‘å»ºè®®ä»ç¡¬ä»¶å±‚é¢æ¥ä¼˜åŒ–ï¼Œæ›´æ¢ä¸º SSD ç£ç›˜ï¼Œæé«˜ç£ç›˜çš„ IO èƒ½åŠ›ï¼Œä¿è¯ AOF æœŸé—´æœ‰å……è¶³çš„ç£ç›˜èµ„æºå¯ä»¥ä½¿ç”¨ã€‚</p><h2 id="_10-ç»‘å®šcpu" tabindex="-1"><a class="header-anchor" href="#_10-ç»‘å®šcpu" aria-hidden="true">#</a> 10. ç»‘å®šCPU</h2><blockquote><p>å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬åœ¨éƒ¨ç½²æœåŠ¡æ—¶ï¼Œä¸ºäº†æé«˜æœåŠ¡æ€§èƒ½ï¼Œé™ä½åº”ç”¨ç¨‹åºåœ¨å¤šä¸ª CPU æ ¸å¿ƒä¹‹é—´çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å¸¦æ¥çš„æ€§èƒ½æŸè€—ï¼Œé€šå¸¸é‡‡ç”¨çš„æ–¹æ¡ˆæ˜¯è¿›ç¨‹ç»‘å®š CPU çš„æ–¹å¼æé«˜æ€§èƒ½ã€‚</p></blockquote><p>ä½†åœ¨éƒ¨ç½² Redis æ—¶ï¼Œå¦‚æœä½ éœ€è¦ç»‘å®š CPU æ¥æé«˜å…¶æ€§èƒ½ï¼Œæˆ‘å»ºè®®ä½ ä»”ç»†æ–Ÿé…Œåå†åšæ“ä½œã€‚</p><h3 id="_10-1-ä¸ºä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#_10-1-ä¸ºä»€ä¹ˆ" aria-hidden="true">#</a> 10.1 <strong>ä¸ºä»€ä¹ˆ</strong>ï¼Ÿ</h3><p>å› ä¸º Redis åœ¨ç»‘å®š CPU æ—¶ï¼Œæ˜¯æœ‰å¾ˆå¤šè€ƒç©¶çš„ï¼Œå¦‚æœä½ ä¸äº†è§£ Redis çš„è¿è¡ŒåŸç†ï¼Œéšæ„ç»‘å®š CPU ä¸ä»…ä¸ä¼šæé«˜æ€§èƒ½ï¼Œç”šè‡³æœ‰å¯èƒ½ä¼šå¸¦æ¥ç›¸åçš„æ•ˆæœã€‚</p><p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œä¸€èˆ¬ç°ä»£çš„æœåŠ¡å™¨ä¼šæœ‰å¤šä¸ª CPUï¼Œè€Œæ¯ä¸ª CPU åˆåŒ…å«å¤šä¸ªç‰©ç†æ ¸å¿ƒï¼Œæ¯ä¸ªç‰©ç†æ ¸å¿ƒåˆåˆ†ä¸ºå¤šä¸ªé€»è¾‘æ ¸å¿ƒï¼Œæ¯ä¸ªç‰©ç†æ ¸ä¸‹çš„é€»è¾‘æ ¸å…±ç”¨ L1/L2 Cacheã€‚</p><p>è€Œ Redis Server é™¤äº†ä¸»çº¿ç¨‹æœåŠ¡å®¢æˆ·ç«¯è¯·æ±‚ä¹‹å¤–ï¼Œè¿˜ä¼šåˆ›å»ºå­è¿›ç¨‹ã€å­çº¿ç¨‹ã€‚</p><p>å…¶ä¸­å­è¿›ç¨‹ç”¨äºæ•°æ®æŒä¹…åŒ–ï¼Œè€Œå­çº¿ç¨‹ç”¨äºæ‰§è¡Œä¸€äº›æ¯”è¾ƒè€—æ—¶æ“ä½œï¼Œä¾‹å¦‚å¼‚æ­¥é‡Šæ”¾ fdã€å¼‚æ­¥ AOF åˆ·ç›˜ã€å¼‚æ­¥ lazy-free ç­‰ç­‰ã€‚</p><p>å¦‚æœä½ æŠŠ Redis è¿›ç¨‹åªç»‘å®šäº†ä¸€ä¸ª CPU é€»è¾‘æ ¸å¿ƒä¸Šï¼Œé‚£ä¹ˆå½“ Redis åœ¨è¿›è¡Œæ•°æ®æŒä¹…åŒ–æ—¶ï¼Œfork å‡ºçš„å­è¿›ç¨‹ä¼šç»§æ‰¿çˆ¶è¿›ç¨‹çš„ CPU ä½¿ç”¨åå¥½ã€‚</p><p>è€Œæ­¤æ—¶çš„å­è¿›ç¨‹ä¼šæ¶ˆè€—å¤§é‡çš„ CPU èµ„æºè¿›è¡Œæ•°æ®æŒä¹…åŒ–ï¼ˆæŠŠå®ä¾‹æ•°æ®å…¨éƒ¨æ‰«æå‡ºæ¥éœ€è¦è€—è´¹CPUï¼‰ï¼Œè¿™å°±ä¼šå¯¼è‡´å­è¿›ç¨‹ä¼šä¸ä¸»è¿›ç¨‹å‘ç”Ÿ CPU äº‰æŠ¢ï¼Œè¿›è€Œå½±å“åˆ°ä¸»è¿›ç¨‹æœåŠ¡å®¢æˆ·ç«¯è¯·æ±‚ï¼Œè®¿é—®å»¶è¿Ÿå˜å¤§ã€‚</p><p>è¿™å°±æ˜¯ Redis ç»‘å®š CPU å¸¦æ¥çš„æ€§èƒ½é—®é¢˜ã€‚</p><h3 id="_10-2-é‚£å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢" tabindex="-1"><a class="header-anchor" href="#_10-2-é‚£å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢" aria-hidden="true">#</a> 10.2 <strong>é‚£å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢</strong>ï¼Ÿ</h3><p>å¦‚æœä½ ç¡®å®æƒ³è¦ç»‘å®š CPUï¼Œå¯ä»¥ä¼˜åŒ–çš„æ–¹æ¡ˆæ˜¯ï¼Œä¸è¦è®© Redis è¿›ç¨‹åªç»‘å®šåœ¨ä¸€ä¸ª CPU é€»è¾‘æ ¸ä¸Šï¼Œè€Œæ˜¯ç»‘å®šåœ¨å¤šä¸ªé€»è¾‘æ ¸å¿ƒä¸Šï¼Œè€Œä¸”ï¼Œç»‘å®šçš„å¤šä¸ªé€»è¾‘æ ¸å¿ƒæœ€å¥½æ˜¯åŒä¸€ä¸ªç‰©ç†æ ¸å¿ƒï¼Œè¿™æ ·å®ƒä»¬è¿˜å¯ä»¥å…±ç”¨ L1/L2 Cacheã€‚</p><p>å½“ç„¶ï¼Œå³ä¾¿æˆ‘ä»¬æŠŠ Redis ç»‘å®šåœ¨å¤šä¸ªé€»è¾‘æ ¸å¿ƒä¸Šï¼Œä¹Ÿåªèƒ½åœ¨ä¸€å®šç¨‹åº¦ä¸Šç¼“è§£ä¸»çº¿ç¨‹ã€å­è¿›ç¨‹ã€åå°çº¿ç¨‹åœ¨ CPU èµ„æºä¸Šçš„ç«äº‰ã€‚</p><p>å› ä¸ºè¿™äº›å­è¿›ç¨‹ã€å­çº¿ç¨‹è¿˜æ˜¯ä¼šåœ¨è¿™å¤šä¸ªé€»è¾‘æ ¸å¿ƒä¸Šè¿›è¡Œåˆ‡æ¢ï¼Œå­˜åœ¨æ€§èƒ½æŸè€—ã€‚</p><h3 id="_10-3-å¦‚ä½•å†è¿›ä¸€æ­¥ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#_10-3-å¦‚ä½•å†è¿›ä¸€æ­¥ä¼˜åŒ–" aria-hidden="true">#</a> 10.3 <strong>å¦‚ä½•å†è¿›ä¸€æ­¥ä¼˜åŒ–</strong>ï¼Ÿ</h3><p>å¯èƒ½ä½ å·²ç»æƒ³åˆ°äº†ï¼Œæˆ‘ä»¬æ˜¯å¦å¯ä»¥è®©ä¸»çº¿ç¨‹ã€å­è¿›ç¨‹ã€åå°çº¿ç¨‹ï¼Œåˆ†åˆ«ç»‘å®šåœ¨å›ºå®šçš„ CPU æ ¸å¿ƒä¸Šï¼Œä¸è®©å®ƒä»¬æ¥å›åˆ‡æ¢ï¼Œè¿™æ ·ä¸€æ¥ï¼Œä»–ä»¬å„è‡ªä½¿ç”¨çš„ CPU èµ„æºäº’ä¸å½±å“ã€‚</p><p>å…¶å®ï¼Œè¿™ä¸ªæ–¹æ¡ˆ Redis å®˜æ–¹å·²ç»æƒ³åˆ°äº†ã€‚</p><p>Redis åœ¨ 6.0 ç‰ˆæœ¬å·²ç»æ¨å‡ºäº†è¿™ä¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹é…ç½®ï¼Œå¯¹ä¸»çº¿ç¨‹ã€åå°çº¿ç¨‹ã€åå° RDB è¿›ç¨‹ã€AOF rewrite è¿›ç¨‹ï¼Œç»‘å®šå›ºå®šçš„ CPU é€»è¾‘æ ¸å¿ƒï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># Redis Server å’Œ IO çº¿ç¨‹ç»‘å®šåˆ° CPUæ ¸å¿ƒ 0,2,4,6</span>
server_cpulist <span class="token number">0</span>-7:2
 
<span class="token comment"># åå°å­çº¿ç¨‹ç»‘å®šåˆ° CPUæ ¸å¿ƒ 1,3</span>
bio_cpulist <span class="token number">1,3</span>
 
<span class="token comment"># åå° AOF rewrite è¿›ç¨‹ç»‘å®šåˆ° CPU æ ¸å¿ƒ 8,9,10,11</span>
aof_rewrite_cpulist <span class="token number">8</span>-11
 
<span class="token comment"># åå° RDB è¿›ç¨‹ç»‘å®šåˆ° CPU æ ¸å¿ƒ 1,10,11</span>
<span class="token comment"># bgsave_cpulist 1,10-1</span>

  
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœä½ ä½¿ç”¨çš„æ­£å¥½æ˜¯ Redis 6.0 ç‰ˆæœ¬ï¼Œå°±å¯ä»¥é€šè¿‡ä»¥ä¸Šé…ç½®ï¼Œæ¥è¿›ä¸€æ­¥æé«˜ Redis æ€§èƒ½ã€‚</p><p>è¿™é‡Œæˆ‘éœ€è¦æé†’ä½ çš„æ˜¯ï¼Œä¸€èˆ¬æ¥è¯´ï¼ŒRedis çš„æ€§èƒ½å·²ç»è¶³å¤Ÿä¼˜ç§€ï¼Œé™¤éä½ å¯¹ Redis çš„æ€§èƒ½æœ‰æ›´åŠ ä¸¥è‹›çš„è¦æ±‚ï¼Œå¦åˆ™ä¸å»ºè®®ä½ ç»‘å®š CPUã€‚</p><p>ä»ä¸Šé¢çš„åˆ†æä½ ä¹Ÿèƒ½çœ‹å‡ºï¼Œç»‘å®š CPU éœ€è¦ä½ å¯¹è®¡ç®—æœºä½“ç³»ç»“æ„æœ‰éå¸¸æ¸…æ™°çš„äº†è§£ï¼Œå¦åˆ™è°¨æ…æ“ä½œã€‚</p><p>æˆ‘ä»¬ç»§ç»­åˆ†æè¿˜æœ‰ä»€ä¹ˆåœºæ™¯ä¼šå¯¼è‡´ Redis å˜æ…¢ã€‚</p><h2 id="_11-ä½¿ç”¨swap" tabindex="-1"><a class="header-anchor" href="#_11-ä½¿ç”¨swap" aria-hidden="true">#</a> 11. ä½¿ç”¨Swap</h2><p>å¦‚æœä½ å‘ç° Redis çªç„¶å˜å¾—éå¸¸æ…¢ï¼Œ<strong>æ¯æ¬¡çš„æ“ä½œè€—æ—¶éƒ½è¾¾åˆ°äº†å‡ ç™¾æ¯«ç§’ç”šè‡³ç§’çº§</strong>ï¼Œé‚£æ­¤æ—¶ä½ å°±éœ€è¦æ£€æŸ¥ Redis æ˜¯å¦ä½¿ç”¨åˆ°äº† Swapï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ Redis åŸºæœ¬ä¸Šå·²ç»æ— æ³•æä¾›é«˜æ€§èƒ½çš„æœåŠ¡äº†ã€‚</p><p>ä»€ä¹ˆæ˜¯ Swapï¼Ÿä¸ºä»€ä¹ˆä½¿ç”¨ Swap ä¼šå¯¼è‡´ Redis çš„æ€§èƒ½ä¸‹é™ï¼Ÿ</p><p>å¦‚æœä½ å¯¹æ“ä½œç³»ç»Ÿæœ‰äº›äº†è§£ï¼Œå°±ä¼šçŸ¥é“æ“ä½œç³»ç»Ÿä¸ºäº†ç¼“è§£å†…å­˜ä¸è¶³å¯¹åº”ç”¨ç¨‹åºçš„å½±å“ï¼Œå…è®¸æŠŠä¸€éƒ¨åˆ†å†…å­˜ä¸­çš„æ•°æ®æ¢åˆ°ç£ç›˜ä¸Šï¼Œä»¥è¾¾åˆ°åº”ç”¨ç¨‹åºå¯¹å†…å­˜ä½¿ç”¨çš„ç¼“å†²ï¼Œè¿™äº›å†…å­˜æ•°æ®è¢«æ¢åˆ°ç£ç›˜ä¸Šçš„åŒºåŸŸï¼Œå°±æ˜¯ Swapã€‚</p><p>é—®é¢˜å°±åœ¨äºï¼Œå½“å†…å­˜ä¸­çš„æ•°æ®è¢«æ¢åˆ°ç£ç›˜ä¸Šåï¼ŒRedis å†è®¿é—®è¿™äº›æ•°æ®æ—¶ï¼Œå°±éœ€è¦ä»ç£ç›˜ä¸Šè¯»å–ï¼Œè®¿é—®ç£ç›˜çš„é€Ÿåº¦è¦æ¯”è®¿é—®å†…å­˜æ…¢å‡ ç™¾å€ï¼</p><p><strong>å°¤å…¶æ˜¯é’ˆå¯¹ Redis è¿™ç§å¯¹æ€§èƒ½è¦æ±‚æé«˜ã€æ€§èƒ½æå…¶æ•æ„Ÿçš„æ•°æ®åº“æ¥è¯´ï¼Œè¿™ä¸ªæ“ä½œå»¶æ—¶æ˜¯æ— æ³•æ¥å—çš„</strong>ã€‚</p><p>æ­¤æ—¶ï¼Œä½ éœ€è¦æ£€æŸ¥ Redis æœºå™¨çš„å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œç¡®è®¤æ˜¯å¦å­˜åœ¨ä½¿ç”¨äº† Swapã€‚</p><p>ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ¥æŸ¥çœ‹ Redis è¿›ç¨‹æ˜¯å¦ä½¿ç”¨åˆ°äº† Swapï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># å…ˆæ‰¾åˆ° Redis çš„è¿›ç¨‹ ID</span>
$ <span class="token function">ps</span> <span class="token parameter variable">-aux</span> <span class="token operator">|</span> <span class="token function">grep</span> redis-server
 
<span class="token comment"># æŸ¥çœ‹ Redis Swap ä½¿ç”¨æƒ…å†µ</span>
$ <span class="token function">cat</span> /proc/<span class="token variable">$pid</span>/smaps <span class="token operator">|</span> <span class="token function">egrep</span> <span class="token string">&#39;^(Swap|Size)&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>Size:               <span class="token number">1256</span> kB
Swap:                  <span class="token number">0</span> kB
Size:                  <span class="token number">4</span> kB
Swap:                  <span class="token number">0</span> kB
Size:                <span class="token number">132</span> kB
Swap:                  <span class="token number">0</span> kB
Size:              <span class="token number">63488</span> kB
Swap:                  <span class="token number">0</span> kB
Size:                <span class="token number">132</span> kB
Swap:                  <span class="token number">0</span> kB
Size:              <span class="token number">65404</span> kB
Swap:                  <span class="token number">0</span> kB
Size:            <span class="token number">1921024</span> kB
Swap:                  <span class="token number">0</span> kB
<span class="token punctuation">..</span>.

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªç»“æœä¼šåˆ—å‡º Redis è¿›ç¨‹çš„å†…å­˜ä½¿ç”¨æƒ…å†µã€‚</p><p>æ¯ä¸€è¡Œ Size è¡¨ç¤º Redis æ‰€ç”¨çš„ä¸€å—å†…å­˜å¤§å°ï¼ŒSize ä¸‹é¢çš„ Swap å°±è¡¨ç¤ºè¿™å— Size å¤§å°çš„å†…å­˜ï¼Œæœ‰å¤šå°‘æ•°æ®å·²ç»è¢«æ¢åˆ°ç£ç›˜ä¸Šäº†ï¼Œå¦‚æœè¿™ä¸¤ä¸ªå€¼ç›¸ç­‰ï¼Œè¯´æ˜è¿™å—å†…å­˜çš„æ•°æ®éƒ½å·²ç»å®Œå…¨è¢«æ¢åˆ°ç£ç›˜ä¸Šäº†ã€‚</p><p>å¦‚æœåªæ˜¯å°‘é‡æ•°æ®è¢«æ¢åˆ°ç£ç›˜ä¸Šï¼Œä¾‹å¦‚æ¯ä¸€å— Swap å å¯¹åº” Size çš„æ¯”ä¾‹å¾ˆå°ï¼Œé‚£å½±å“å¹¶ä¸æ˜¯å¾ˆå¤§ã€‚<strong>å¦‚æœæ˜¯å‡ ç™¾å…†ç”šè‡³ä¸Š GB çš„å†…å­˜è¢«æ¢åˆ°äº†ç£ç›˜ä¸Šï¼Œé‚£ä¹ˆä½ å°±éœ€è¦è­¦æƒ•äº†ï¼Œè¿™ç§æƒ…å†µ Redis çš„æ€§èƒ½è‚¯å®šä¼šæ€¥å‰§ä¸‹é™</strong>ã€‚</p><p>æ­¤æ—¶çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼š</p><ul><li>å¢åŠ æœºå™¨çš„å†…å­˜ï¼Œè®© Redis æœ‰è¶³å¤Ÿçš„å†…å­˜å¯ä»¥ä½¿ç”¨</li><li>æ•´ç†å†…å­˜ç©ºé—´ï¼Œé‡Šæ”¾å‡ºè¶³å¤Ÿçš„å†…å­˜ä¾› Redis ä½¿ç”¨ï¼Œç„¶åé‡Šæ”¾ Redis çš„ Swapï¼Œè®© Redis é‡æ–°ä½¿ç”¨å†…å­˜</li></ul><p>é‡Šæ”¾ Redis çš„ Swap è¿‡ç¨‹é€šå¸¸è¦é‡å¯å®ä¾‹ï¼Œä¸ºäº†é¿å…é‡å¯å®ä¾‹å¯¹ä¸šåŠ¡çš„å½±å“ï¼Œä¸€èˆ¬ä¼šå…ˆè¿›è¡Œä¸»ä»åˆ‡æ¢ï¼Œç„¶åé‡Šæ”¾æ—§ä¸»èŠ‚ç‚¹çš„ Swapï¼Œé‡å¯æ—§ä¸»èŠ‚ç‚¹å®ä¾‹ï¼Œå¾…ä»åº“æ•°æ®åŒæ­¥å®Œæˆåï¼Œå†è¿›è¡Œä¸»ä»åˆ‡æ¢å³å¯ã€‚</p><p>å¯è§ï¼Œå½“ Redis ä½¿ç”¨åˆ° Swap åï¼Œæ­¤æ—¶çš„ Redis æ€§èƒ½åŸºæœ¬å·²è¾¾ä¸åˆ°é«˜æ€§èƒ½çš„è¦æ±‚ï¼ˆä½ å¯ä»¥ç†è§£ä¸ºæ­¦åŠŸè¢«åºŸï¼‰ï¼Œæ‰€ä»¥ä½ ä¹Ÿéœ€è¦æå‰é¢„é˜²è¿™ç§æƒ…å†µã€‚</p><p>é¢„é˜²çš„åŠæ³•å°±æ˜¯ï¼Œä½ éœ€è¦å¯¹ Redis æœºå™¨çš„å†…å­˜å’Œ Swap ä½¿ç”¨æƒ…å†µè¿›è¡Œç›‘æ§ï¼Œåœ¨å†…å­˜ä¸è¶³æˆ–ä½¿ç”¨åˆ° Swap æ—¶æŠ¥è­¦å‡ºæ¥ï¼ŒåŠæ—¶å¤„ç†ã€‚</p><h2 id="_12-ç¢ç‰‡æ•´ç†" tabindex="-1"><a class="header-anchor" href="#_12-ç¢ç‰‡æ•´ç†" aria-hidden="true">#</a> 12. ç¢ç‰‡æ•´ç†</h2><blockquote><p>Redis çš„æ•°æ®éƒ½å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œå½“æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºé¢‘ç¹ä¿®æ”¹ Redis ä¸­çš„æ•°æ®æ—¶ï¼Œå°±æœ‰å¯èƒ½ä¼šå¯¼è‡´ Redis äº§ç”Ÿå†…å­˜ç¢ç‰‡ã€‚</p></blockquote><p>å†…å­˜ç¢ç‰‡ä¼šé™ä½ Redis çš„å†…å­˜ä½¿ç”¨ç‡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰§è¡Œ INFO å‘½ä»¤ï¼Œå¾—åˆ°è¿™ä¸ªå®ä¾‹çš„å†…å­˜ç¢ç‰‡ç‡ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># Memory</span>
used_memory:5709194824
used_memory_human:5.32G
used_memory_rss:8264855552
used_memory_rss_human:7.70G
<span class="token punctuation">..</span>.
mem_fragmentation_ratio:1.45
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>è¿™ä¸ªå†…å­˜ç¢ç‰‡ç‡æ˜¯æ€ä¹ˆè®¡ç®—çš„</strong>ï¼Ÿ</p><p>å¾ˆç®€å•ï¼Œmem_fragmentation_ratio = used_memory_rss / used_memoryã€‚</p><p>å…¶ä¸­ used_memory è¡¨ç¤º Redis å­˜å‚¨æ•°æ®çš„å†…å­˜å¤§å°ï¼Œè€Œ used_memory_rss è¡¨ç¤ºæ“ä½œç³»ç»Ÿå®é™…åˆ†é…ç»™ Redis è¿›ç¨‹çš„å¤§å°ã€‚</p><p>å¦‚æœ mem_fragmentation_ratio &gt; 1.5ï¼Œè¯´æ˜å†…å­˜ç¢ç‰‡ç‡å·²ç»è¶…è¿‡äº† 50%ï¼Œè¿™æ—¶æˆ‘ä»¬å°±éœ€è¦é‡‡å–ä¸€äº›æªæ–½æ¥é™ä½å†…å­˜ç¢ç‰‡äº†ã€‚</p><p>è§£å†³çš„æ–¹æ¡ˆä¸€èˆ¬å¦‚ä¸‹ï¼š</p><ul><li>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ Redis 4.0 ä»¥ä¸‹ç‰ˆæœ¬ï¼Œåªèƒ½é€šè¿‡é‡å¯å®ä¾‹æ¥è§£å†³</li><li>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ Redis 4.0 ç‰ˆæœ¬ï¼Œå®ƒæ­£å¥½æä¾›äº†è‡ªåŠ¨ç¢ç‰‡æ•´ç†çš„åŠŸèƒ½ï¼Œå¯ä»¥é€šè¿‡é…ç½®å¼€å¯ç¢ç‰‡è‡ªåŠ¨æ•´ç†</li></ul><p>ä½†æ˜¯ï¼Œå¼€å¯å†…å­˜ç¢ç‰‡æ•´ç†ï¼Œå®ƒä¹Ÿæœ‰å¯èƒ½ä¼šå¯¼è‡´ Redis æ€§èƒ½ä¸‹é™ã€‚</p><p>åŸå› åœ¨äºï¼ŒRedis çš„ç¢ç‰‡æ•´ç†å·¥ä½œæ˜¯ä¹Ÿåœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œçš„ï¼Œå½“å…¶è¿›è¡Œç¢ç‰‡æ•´ç†æ—¶ï¼Œå¿…ç„¶ä¼šæ¶ˆè€— CPU èµ„æºï¼Œäº§ç”Ÿæ›´å¤šçš„è€—æ—¶ï¼Œä»è€Œå½±å“åˆ°å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚</p><p>æ‰€ä»¥ï¼Œå½“ä½ éœ€è¦å¼€å¯è¿™ä¸ªåŠŸèƒ½æ—¶ï¼Œæœ€å¥½æå‰æµ‹è¯•è¯„ä¼°å®ƒå¯¹ Redis çš„å½±å“ã€‚</p><p>Redis ç¢ç‰‡æ•´ç†çš„å‚æ•°é…ç½®å¦‚ä¸‹ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># å¼€å¯è‡ªåŠ¨å†…å­˜ç¢ç‰‡æ•´ç†ï¼ˆæ€»å¼€å…³ï¼‰</span>
activedefrag <span class="token function">yes</span>
 
<span class="token comment"># å†…å­˜ä½¿ç”¨ 100MB ä»¥ä¸‹ï¼Œä¸è¿›è¡Œç¢ç‰‡æ•´ç†</span>
active-defrag-ignore-bytes 100mb
 
<span class="token comment"># å†…å­˜ç¢ç‰‡ç‡è¶…è¿‡ 10%ï¼Œå¼€å§‹ç¢ç‰‡æ•´ç†</span>
active-defrag-threshold-lower <span class="token number">10</span>
<span class="token comment"># å†…å­˜ç¢ç‰‡ç‡è¶…è¿‡ 100%ï¼Œå°½æœ€å¤§åŠªåŠ›ç¢ç‰‡æ•´ç†</span>
active-defrag-threshold-upper <span class="token number">100</span>
 
<span class="token comment"># å†…å­˜ç¢ç‰‡æ•´ç†å ç”¨ CPU èµ„æºæœ€å°ç™¾åˆ†æ¯”</span>
active-defrag-cycle-min <span class="token number">1</span>
<span class="token comment"># å†…å­˜ç¢ç‰‡æ•´ç†å ç”¨ CPU èµ„æºæœ€å¤§ç™¾åˆ†æ¯”</span>
active-defrag-cycle-max <span class="token number">25</span>
 
<span class="token comment"># ç¢ç‰‡æ•´ç†æœŸé—´ï¼Œå¯¹äº List/Set/Hash/ZSet ç±»å‹å…ƒç´ ä¸€æ¬¡ Scan çš„æ•°é‡</span>
active-defrag-max-scan-fields <span class="token number">1000</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½ éœ€è¦ç»“åˆ Redis æœºå™¨çš„è´Ÿè½½æƒ…å†µï¼Œä»¥åŠåº”ç”¨ç¨‹åºå¯æ¥å—çš„å»¶è¿ŸèŒƒå›´è¿›è¡Œè¯„ä¼°ï¼Œåˆç†è°ƒæ•´ç¢ç‰‡æ•´ç†çš„å‚æ•°ï¼Œå°½å¯èƒ½é™ä½ç¢ç‰‡æ•´ç†æœŸé—´å¯¹ Redis çš„å½±å“ã€‚</p><h2 id="_13-ç½‘ç»œå¸¦å®½è¿‡è½½" tabindex="-1"><a class="header-anchor" href="#_13-ç½‘ç»œå¸¦å®½è¿‡è½½" aria-hidden="true">#</a> 13. ç½‘ç»œå¸¦å®½è¿‡è½½</h2><blockquote><p>å¦‚æœä»¥ä¸Šäº§ç”Ÿæ€§èƒ½é—®é¢˜çš„åœºæ™¯ï¼Œä½ éƒ½è§„é¿æ‰äº†ï¼Œè€Œä¸” Redis ä¹Ÿç¨³å®šè¿è¡Œäº†å¾ˆé•¿æ—¶é—´ï¼Œä½†åœ¨æŸä¸ªæ—¶é—´ç‚¹ä¹‹åå¼€å§‹ï¼Œæ“ä½œ Redis çªç„¶å¼€å§‹å˜æ…¢äº†ï¼Œè€Œä¸”ä¸€ç›´æŒç»­ä¸‹å»ï¼Œè¿™ç§æƒ…å†µåˆæ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´ï¼Ÿ</p></blockquote><p>æ­¤æ—¶ä½ éœ€è¦æ’æŸ¥ä¸€ä¸‹ Redis æœºå™¨çš„ç½‘ç»œå¸¦å®½æ˜¯å¦è¿‡è½½ï¼Œæ˜¯å¦å­˜åœ¨æŸä¸ªå®ä¾‹æŠŠæ•´ä¸ªæœºå™¨çš„ç½‘è·¯å¸¦å®½å æ»¡çš„æƒ…å†µã€‚</p><p>ç½‘ç»œå¸¦å®½è¿‡è½½çš„æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨åœ¨ TCP å±‚å’Œç½‘ç»œå±‚å°±ä¼šå‡ºç°æ•°æ®åŒ…å‘é€å»¶è¿Ÿã€ä¸¢åŒ…ç­‰æƒ…å†µã€‚</p><p>Redis çš„é«˜æ€§èƒ½ï¼Œé™¤äº†æ“ä½œå†…å­˜ä¹‹å¤–ï¼Œå°±åœ¨äºç½‘ç»œ IO äº†ï¼Œå¦‚æœç½‘ç»œ IO å­˜åœ¨ç“¶é¢ˆï¼Œé‚£ä¹ˆä¹Ÿä¼šä¸¥é‡å½±å“ Redis çš„æ€§èƒ½ã€‚</p><p>å¦‚æœç¡®å®å‡ºç°è¿™ç§æƒ…å†µï¼Œä½ éœ€è¦åŠæ—¶ç¡®è®¤å æ»¡ç½‘ç»œå¸¦å®½ Redis å®ä¾‹ï¼Œå¦‚æœå±äºæ­£å¸¸çš„ä¸šåŠ¡è®¿é—®ï¼Œé‚£å°±éœ€è¦åŠæ—¶æ‰©å®¹æˆ–è¿ç§»å®ä¾‹äº†ï¼Œé¿å…å› ä¸ºè¿™ä¸ªå®ä¾‹æµé‡è¿‡å¤§ï¼Œå½±å“è¿™ä¸ªæœºå™¨çš„å…¶ä»–å®ä¾‹ã€‚</p><p>è¿ç»´å±‚é¢ï¼Œä½ éœ€è¦å¯¹ Redis æœºå™¨çš„å„é¡¹æŒ‡æ ‡å¢åŠ ç›‘æ§ï¼ŒåŒ…æ‹¬ç½‘ç»œæµé‡ï¼Œåœ¨ç½‘ç»œæµé‡è¾¾åˆ°ä¸€å®šé˜ˆå€¼æ—¶æå‰æŠ¥è­¦ï¼ŒåŠæ—¶ç¡®è®¤å’Œæ‰©å®¹ã€‚</p><h2 id="_14-å…¶ä»–åŸå› " tabindex="-1"><a class="header-anchor" href="#_14-å…¶ä»–åŸå› " aria-hidden="true">#</a> 14. å…¶ä»–åŸå› </h2><p>å¥½äº†ï¼Œä»¥ä¸Šè¿™äº›æ–¹é¢å°±æ˜¯å¦‚ä½•æ’æŸ¥ Redis å»¶è¿Ÿé—®é¢˜çš„æ€è·¯å’Œè·¯å¾„ã€‚</p><p>é™¤äº†ä»¥ä¸Šè¿™äº›ï¼Œè¿˜æœ‰ä¸€äº›æ¯”è¾ƒå°çš„ç‚¹ï¼Œä½ ä¹Ÿéœ€è¦æ³¨æ„ä¸€ä¸‹ï¼š</p><ul><li><strong>é¢‘ç¹çŸ­è¿æ¥</strong></li></ul><p>ä½ çš„ä¸šåŠ¡åº”ç”¨ï¼Œåº”è¯¥ä½¿ç”¨é•¿è¿æ¥æ“ä½œ Redisï¼Œé¿å…é¢‘ç¹çš„çŸ­è¿æ¥ã€‚</p><p>é¢‘ç¹çš„çŸ­è¿æ¥ä¼šå¯¼è‡´ Redis å¤§é‡æ—¶é—´è€—è´¹åœ¨è¿æ¥çš„å»ºç«‹å’Œé‡Šæ”¾ä¸Šï¼ŒTCP çš„ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹åŒæ ·ä¹Ÿä¼šå¢åŠ è®¿é—®å»¶è¿Ÿã€‚</p><ul><li><strong>è¿ç»´ç›‘æ§</strong></li></ul><p>å‰é¢æˆ‘ä¹Ÿæåˆ°äº†ï¼Œè¦æƒ³æå‰é¢„çŸ¥ Redis å˜æ…¢çš„æƒ…å†µå‘ç”Ÿï¼Œå¿…ä¸å¯å°‘çš„å°±æ˜¯åšå¥½å®Œå–„çš„ç›‘æ§ã€‚</p><p>ç›‘æ§å…¶å®å°±æ˜¯å¯¹é‡‡é›† Redis çš„å„é¡¹è¿è¡Œæ—¶æŒ‡æ ‡ï¼Œé€šå¸¸çš„åšæ³•æ˜¯ç›‘æ§ç¨‹åºå®šæ—¶é‡‡é›† Redis çš„ INFO ä¿¡æ¯ï¼Œç„¶åæ ¹æ® INFO ä¿¡æ¯ä¸­çš„çŠ¶æ€æ•°æ®åšæ•°æ®å±•ç¤ºå’ŒæŠ¥è­¦ã€‚</p><p>è¿™é‡Œæˆ‘éœ€è¦æé†’ä½ çš„æ˜¯ï¼Œåœ¨å†™ä¸€äº›ç›‘æ§è„šæœ¬ï¼Œæˆ–ä½¿ç”¨å¼€æºçš„ç›‘æ§ç»„ä»¶æ—¶ï¼Œä¹Ÿä¸èƒ½æ‰ä»¥è½»å¿ƒã€‚</p><p>åœ¨å†™ç›‘æ§è„šæœ¬è®¿é—® Redis æ—¶ï¼Œå°½é‡é‡‡ç”¨é•¿è¿æ¥çš„æ–¹å¼é‡‡é›†çŠ¶æ€ä¿¡æ¯ï¼Œé¿å…é¢‘ç¹çŸ­è¿æ¥ã€‚åŒæ—¶ï¼Œä½ è¿˜è¦æ³¨æ„æ§åˆ¶è®¿é—® Redis çš„é¢‘ç‡ï¼Œé¿å…å½±å“åˆ°ä¸šåŠ¡è¯·æ±‚ã€‚</p><p>åœ¨ä½¿ç”¨ä¸€äº›å¼€æºçš„ç›‘æ§ç»„ä»¶æ—¶ï¼Œæœ€å¥½äº†è§£ä¸€ä¸‹è¿™äº›ç»„ä»¶çš„å®ç°åŸç†ï¼Œä»¥åŠæ­£ç¡®é…ç½®è¿™äº›ç»„ä»¶ï¼Œé˜²æ­¢å‡ºç°ç›‘æ§ç»„ä»¶å‘ç”Ÿ Bugï¼Œå¯¼è‡´çŸ­æ—¶å¤§é‡æ“ä½œ Redisï¼Œå½±å“ Redis æ€§èƒ½çš„æƒ…å†µå‘ç”Ÿã€‚</p><p>æˆ‘ä»¬å½“æ—¶å°±å‘ç”Ÿè¿‡ï¼ŒDBA åœ¨ä½¿ç”¨ä¸€äº›å¼€æºç»„ä»¶æ—¶ï¼Œå› ä¸ºé…ç½®å’Œä½¿ç”¨é—®é¢˜ï¼Œå¯¼è‡´ç›‘æ§ç¨‹åºé¢‘ç¹åœ°ä¸ Redis å»ºç«‹å’Œæ–­å¼€è¿æ¥ï¼Œå¯¼è‡´ Redis å“åº”å˜æ…¢ã€‚</p><ul><li><strong>å…¶å®ƒç¨‹åºäº‰æŠ¢èµ„æº</strong></li></ul><p>æœ€åéœ€è¦æé†’ä½ çš„æ˜¯ï¼Œä½ çš„ Redis æœºå™¨æœ€å¥½ä¸“é¡¹ä¸“ç”¨ï¼Œåªç”¨æ¥éƒ¨ç½² Redis å®ä¾‹ï¼Œä¸è¦éƒ¨ç½²å…¶ä»–åº”ç”¨ç¨‹åºï¼Œå°½é‡ç»™ Redis æä¾›ä¸€ä¸ªç›¸å¯¹ã€Œå®‰é™ã€çš„ç¯å¢ƒï¼Œé¿å…å…¶å®ƒç¨‹åºå ç”¨ CPUã€å†…å­˜ã€ç£ç›˜èµ„æºï¼Œå¯¼è‡´åˆ†é…ç»™ Redis çš„èµ„æºä¸è¶³è€Œå—åˆ°å½±å“ã€‚</p><h2 id="_15-æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#_15-æ€»ç»“" aria-hidden="true">#</a> 15. æ€»ç»“</h2><blockquote><p>å¥½äº†ï¼Œä»¥ä¸Šå°±æ˜¯æˆ‘æ€»ç»“çš„åœ¨ä½¿ç”¨ Redis è¿‡ç¨‹ä¸­ï¼Œå¸¸è§çš„å¯èƒ½å¯¼è‡´å»¶è¿Ÿã€ç”šè‡³é˜»å¡çš„é—®é¢˜åœºæ™¯ï¼Œä»¥åŠå¦‚ä½•å¿«é€Ÿå®šä½å’Œåˆ†æè¿™äº›é—®é¢˜ï¼Œå¹¶ä¸”é’ˆå¯¹æ€§åœ°æä¾›äº†è§£å†³æ–¹æ¡ˆã€‚</p></blockquote><p>è¿™é‡Œæˆ‘ä¹Ÿæ±‡æ€»æˆäº†æ€ç»´å¯¼å›¾ï¼Œæ–¹ä¾¿ä½ åœ¨æ’æŸ¥ Redis æ€§èƒ½é—®é¢˜æ—¶ï¼Œå¿«é€Ÿåœ°å»åˆ†æå’Œå®šä½ã€‚</p><figure><img src="https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/image-20220627230852860.png" alt="image-20220627230852860" tabindex="0" loading="lazy"><figcaption>image-20220627230852860</figcaption></figure><p>è¿™é‡Œå†ç®€å•æ€»ç»“ä¸€ä¸‹ï¼ŒRedis çš„æ€§èƒ½é—®é¢˜ï¼Œæ—¢æ¶‰åŠåˆ°äº†ä¸šåŠ¡å¼€å‘äººå‘˜çš„ä½¿ç”¨æ–¹é¢ï¼Œä¹Ÿæ¶‰åŠåˆ°äº† DBA çš„è¿ç»´æ–¹é¢ã€‚</p><p>ä½œä¸ºä¸šåŠ¡å¼€å‘äººå‘˜ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£ Redis çš„åŸºæœ¬åŸç†ï¼Œä¾‹å¦‚å„ä¸ªå‘½ä»¤æ‰§è¡Œçš„æ—¶é—´å¤æ‚åº¦ã€æ•°æ®è¿‡æœŸç­–ç•¥ã€æ•°æ®æ·˜æ±°ç­–ç•¥ç­‰ï¼Œä»è€Œæ›´åˆç†åœ°ä½¿ç”¨ Redis å‘½ä»¤ï¼Œå¹¶ä¸”ç»“åˆä¸šåŠ¡åœºæ™¯è¿›è¡Œä¼˜åŒ–ã€‚</p><p>ä½œä¸º DBA å’Œè¿ç»´äººå‘˜ï¼Œéœ€è¦äº†è§£ Redis è¿è¡Œæœºåˆ¶ï¼Œä¾‹å¦‚æ•°æ®æŒä¹…åŒ–ã€å†…å­˜ç¢ç‰‡æ•´ç†ã€è¿›ç¨‹ç»‘æ ¸é…ç½®ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜éœ€è¦äº†è§£æ“ä½œç³»ç»Ÿç›¸å…³çŸ¥è¯†ï¼Œä¾‹å¦‚å†™æ—¶å¤åˆ¶ã€å†…å­˜å¤§é¡µã€Swap æœºåˆ¶ç­‰ç­‰ã€‚</p><p>åŒæ—¶ï¼ŒDBA åœ¨éƒ¨ç½² Redis æ—¶ï¼Œéœ€è¦æå‰å¯¹è¿›è¡Œå®¹é‡è§„åˆ’ï¼Œé¢„ç•™è¶³å¤Ÿçš„æœºå™¨èµ„æºï¼Œè¿˜è¦å¯¹ Redis æœºå™¨å’Œå®ä¾‹åšå¥½å®Œå–„çš„ç›‘æ§ï¼Œè¿™æ ·æ‰èƒ½å°½å¯èƒ½åœ°ä¿è¯ Redis çš„ç¨³å®šè¿è¡Œã€‚</p><h2 id="_16-åè®°" tabindex="-1"><a class="header-anchor" href="#_16-åè®°" aria-hidden="true">#</a> 16. åè®°</h2><blockquote><p>å¦‚æœä½ èƒ½è€å¿ƒåœ°çœ‹åˆ°è¿™é‡Œï¼Œæƒ³å¿…ä½ è‚¯å®šå·²ç»å¯¹ Redis çš„æ€§èƒ½è°ƒä¼˜æœ‰äº†å¾ˆå¤§çš„æ”¶è·ã€‚</p></blockquote><p>ä½ åº”è¯¥ä¹Ÿå‘ç°äº†ï¼ŒRedis çš„æ€§èƒ½é—®é¢˜ï¼Œæ¶‰åŠåˆ°çš„çŸ¥è¯†ç‚¹éå¸¸å¹¿ï¼Œå‡ ä¹æ¶µç›–äº† CPUã€å†…å­˜ã€ç½‘ç»œã€ç”šè‡³ç£ç›˜çš„æ–¹æ–¹é¢é¢ï¼ŒåŒæ—¶ï¼Œä½ è¿˜éœ€è¦äº†è§£è®¡ç®—æœºçš„ä½“ç³»ç»“æ„ï¼Œä»¥åŠæ“ä½œç³»ç»Ÿçš„å„ç§æœºåˆ¶ã€‚</p><p>ä»èµ„æºä½¿ç”¨è§’åº¦æ¥çœ‹ï¼ŒåŒ…å«çš„çŸ¥è¯†ç‚¹å¦‚ä¸‹ï¼š</p><ul><li><strong>CPU ç›¸å…³</strong>ï¼šä½¿ç”¨å¤æ‚åº¦è¿‡é«˜å‘½ä»¤ã€æ•°æ®çš„æŒä¹…åŒ–ï¼Œéƒ½ä¸è€—è´¹è¿‡å¤šçš„ CPU èµ„æºæœ‰å…³</li><li><strong>å†…å­˜ç›¸å…³</strong>ï¼šbigkey å†…å­˜çš„ç”³è¯·å’Œé‡Šæ”¾ã€æ•°æ®è¿‡æœŸã€æ•°æ®æ·˜æ±°ã€ç¢ç‰‡æ•´ç†ã€å†…å­˜å¤§é¡µã€å†…å­˜å†™æ—¶å¤åˆ¶éƒ½ä¸å†…å­˜æ¯æ¯ç›¸å…³</li><li><strong>ç£ç›˜ç›¸å…³</strong>ï¼šæ•°æ®æŒä¹…åŒ–ã€AOF åˆ·ç›˜ç­–ç•¥ï¼Œä¹Ÿä¼šå—åˆ°ç£ç›˜çš„å½±å“</li><li><strong>ç½‘ç»œç›¸å…³</strong>ï¼šçŸ­è¿æ¥ã€å®ä¾‹æµé‡è¿‡è½½ã€ç½‘ç»œæµé‡è¿‡è½½ï¼Œä¹Ÿä¼šé™ä½ Redis æ€§èƒ½</li><li><strong>è®¡ç®—æœºç³»ç»Ÿ</strong>ï¼šCPU ç»“æ„ã€å†…å­˜åˆ†é…ï¼Œéƒ½å±äºæœ€åŸºç¡€çš„è®¡ç®—æœºç³»ç»ŸçŸ¥è¯†</li><li><strong>æ“ä½œç³»ç»Ÿ</strong>ï¼šå†™æ—¶å¤åˆ¶ã€å†…å­˜å¤§é¡µã€Swapã€CPU ç»‘å®šï¼Œéƒ½å±äºæ“ä½œç³»ç»Ÿå±‚é¢çš„çŸ¥è¯†</li></ul><p>æ²¡æƒ³åˆ°å§ï¼ŸRedis ä¸ºäº†æŠŠæ€§èƒ½åšåˆ°æè‡´ï¼Œæ¶‰åŠåˆ°äº†è¿™ä¹ˆå¤šé¡¹ä¼˜åŒ–ã€‚</p><h2 id="å‚è€ƒæ–‡ç« " tabindex="-1"><a class="header-anchor" href="#å‚è€ƒæ–‡ç« " aria-hidden="true">#</a> å‚è€ƒæ–‡ç« </h2><p><a href="https://pdai.tech/md/db/nosql-redis/db-redis-x-performance.html" target="_blank" rel="noopener noreferrer"><strong>Redisè¿›é˜¶ - æ€§èƒ½è°ƒä¼˜ï¼šRedisæ€§èƒ½è°ƒä¼˜è¯¦è§£</strong><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/zszdevelop/java-study-gitbook/edit/main/docs/db/redis/db-redis-x-performance.md" rel="noopener noreferrer" target="_blank" aria-label="ç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->ç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="meta-item contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: zszdevelop@163.com">zszdevelop</span><!--]--><!--]--></div></footer><nav class="page-nav"><a href="/java-study-gitbook/db/redis/db-redis-x-hot-key.html" class="nav-link prev" aria-label="Redisè¿›é˜¶ - Redisçƒ­keyé—®é¢˜"><div class="hint"><span class="arrow left"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->Redisè¿›é˜¶ - Redisçƒ­keyé—®é¢˜</div></a><a href="/java-study-gitbook/db/redis/redis-z-interview-overview.html" class="nav-link next" aria-label="Redisé¢è¯• - redisé—®é¢˜æ€»ç»“"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow right"></span></div><div class="link">Redisé¢è¯• - redisé—®é¢˜æ€»ç»“<!----></div></a></nav><div class="giscus-wrapper input-top" style="display:block;"><div style="text-align:center">Loading...</div></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer"><a href='https://beian.miit.gov.cn' target='_blank' style='color: var(--c-text-lighter);>é—½ICPå¤‡18001806å·-1</a></div><div class="copyright">Copyright Â© 2023 zszdevelop</div></footer><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/java-study-gitbook/assets/app-d7a104d1.js" defer></script>
  </body>
</html>
