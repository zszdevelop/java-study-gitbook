(window.webpackJsonp=window.webpackJsonp||[]).push([[304],{1259:function(t,s,a){"use strict";a.r(s);var n=a(42),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"p6spy记录数据库日志"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#p6spy记录数据库日志"}},[t._v("#")]),t._v(" P6Spy记录数据库日志")]),t._v(" "),a("h2",{attrs:{id:"_1-简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-简介"}},[t._v("#")]),t._v(" 1. 简介")]),t._v(" "),a("p",[t._v("P6Spy 是一个框架，可以"),a("strong",[t._v("无缝得拦截和记录数据库活动")]),t._v("，无需更改现有程序代码。")]),t._v(" "),a("p",[t._v("一般使用"),a("strong",[t._v("p6spy打印我们最后执行的sql语句")]),t._v("。")]),t._v(" "),a("h3",{attrs:{id:"_1-1-优势"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-优势"}},[t._v("#")]),t._v(" 1.1 优势")]),t._v(" "),a("p",[t._v("常用的数据框架也会自带打印sql的功能，比如jpa,mybatis等，但是一般都会有缺陷，"),a("strong",[t._v("比如打印的sql是不带执行参数拼接的sql")]),t._v("，这种sql不完整，"),a("strong",[t._v("不具有直接可执行性")])]),t._v(" "),a("h2",{attrs:{id:"_2-集成使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-集成使用"}},[t._v("#")]),t._v(" 2. 集成使用")]),t._v(" "),a("h3",{attrs:{id:"_2-1-导入pom依赖"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-导入pom依赖"}},[t._v("#")]),t._v(" 2.1 导入Pom依赖")]),t._v(" "),a("div",{staticClass:"language-xml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("p6spy"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("p6spy"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("3.8.5"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("h3",{attrs:{id:"_2-2-配置spy-properties"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-配置spy-properties"}},[t._v("#")]),t._v(" 2.2 配置spy.properties")]),t._v(" "),a("div",{staticClass:"language-properties extra-class"},[a("pre",{pre:!0,attrs:{class:"language-properties"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定 Log 的 appender，取值：")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("appender")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("com.p6spy.engine.spy.appender.Slf4JLogger")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定日志输出样式")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("logMessageFormat")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("com.zszdevelop.chinahrss.server.system.configure.P6spySqlFormatConfigure")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#P6Outage 模块是否记录较长时间运行的语句 默认false")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("outagedetection")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# P6Outage 模块执行时间设置，整数值 （以秒为单位)），只有当超过这个时间才进行记录 Log。 默认30s")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("outagedetectioninterval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("2")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#是否开启日志过滤 默认false， 这项配置是否生效前提是配置了 include/exclude/sqlexpression")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 过滤 Log 时所排除的表名列表，以逗号分隔 默认为空")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("exclude")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[t._v("select 1")]),t._v("\n")])])]),a("h3",{attrs:{id:"_2-3-自定义日志输出格式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-自定义日志输出格式"}},[t._v("#")]),t._v(" 2.3 自定义日志输出格式")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("P6spySqlFormatConfigure")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MessageFormattingStrategy")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("formatMessage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" connectionId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" now"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" elapsed"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" category"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" prepared"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" sql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("StringUtils")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("isNotBlank")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DateUtil")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("formatFullTime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LocalDateTime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("now")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DateUtil")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FULL_TIME_SPLIT_PATTERN"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('" | 耗时 "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" elapsed "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('" ms | SQL 语句："')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("StringUtils")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("LF "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" sql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("replaceAll")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"[\\\\s]+"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("StringUtils")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SPACE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('";"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("StringUtils")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EMPTY"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h2",{attrs:{id:"_3-完整的配置参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-完整的配置参考"}},[t._v("#")]),t._v(" 3. 完整的配置参考")]),t._v(" "),a("div",{staticClass:"language-properties extra-class"},[a("pre",{pre:!0,attrs:{class:"language-properties"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定应用的日志拦截模块,默认为com.p6spy.engine.spy.P6SpyFactory ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#modulelist=com.p6spy.engine.spy.P6SpyFactory,com.p6spy.engine.logging.P6LogFactory,com.p6spy.engine.outage.P6OutageFactory")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 真实JDBC driver , 多个以 逗号 分割 默认为空")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#driverlist=")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 是否自动刷新 默认 flase")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#autoflush=false")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 配置SimpleDateFormat日期格式 默认为空")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#dateformat=")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 打印堆栈跟踪信息 默认flase")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#stacktrace=false")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果 stacktrace=true，则可以指定具体的类名来进行过滤。")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#stacktraceclass=")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 监测属性配置文件是否进行重新加载")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#reloadproperties=false")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 属性配置文件重新加载的时间间隔，单位:秒 默认60s")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#reloadpropertiesinterval=60")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定 Log 的 appender，取值：")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#appender=com.p6spy.engine.spy.appender.Slf4JLogger")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#appender=com.p6spy.engine.spy.appender.StdoutLogger")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#appender=com.p6spy.engine.spy.appender.FileLogger")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定 Log 的文件名 默认 spy.log")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#logfile=spy.log")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定是否每次是增加 Log，设置为 false 则每次都会先进行清空 默认true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#append=true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定日志输出样式  默认为com.p6spy.engine.spy.appender.SingleLineFormat , 单行输出 不格式化语句")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#logMessageFormat=com.p6spy.engine.spy.appender.SingleLineFormat")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 也可以采用  com.p6spy.engine.spy.appender.CustomLineFormat 来自定义输出样式, 默认值是%(currentTime)|%(executionTime)|%(category)|connection%(connectionId)|%(sqlSingleLine)")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 可用的变量为:")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#   %(connectionId)            connection id")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#   %(currentTime)             当前时间")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#   %(executionTime)           执行耗时")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#   %(category)                执行分组")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#   %(effectiveSql)            提交的SQL 换行")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#   %(effectiveSqlSingleLine)  提交的SQL 不换行显示")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#   %(sql)                     执行的真实SQL语句，已替换占位")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#   %(sqlSingleLine)           执行的真实SQL语句，已替换占位 不换行显示")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#customLogMessageFormat=%(currentTime)|%(executionTime)|%(category)|connection%(connectionId)|%(sqlSingleLine)")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# date类型字段记录日志时使用的日期格式 默认dd-MMM-yy")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#databaseDialectDateFormat=dd-MMM-yy")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# boolean类型字段记录日志时使用的日期格式 默认boolean 可选值numeric")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#databaseDialectBooleanFormat=boolean")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 是否通过jmx暴露属性 默认true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#jmx=true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果jmx设置为true 指定通过jmx暴露属性时的前缀 默认为空")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# com.p6spy(.)?:name=#jmxPrefix=")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 是否显示纳秒 默认false")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#useNanoTime=false")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 实际数据源 JNDI")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#realdatasource=/RealMySqlDS")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 实际数据源 datasource class")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#realdatasourceclass=com.mysql.jdbc.jdbc2.optional.MysqlDataSource")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 实际数据源所携带的配置参数 以 k=v 方式指定 以 分号 分割")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#realdatasourceproperties=port;3306,serverName;myhost,databaseName;jbossdb,foo;bar")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# jndi数据源配置 ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置 JNDI 数据源的 NamingContextFactory。 ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#jndicontextfactory=org.jnp.interfaces.NamingContextFactory")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置 JNDI 数据源的提供者的 URL。 ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#jndicontextproviderurl=localhost:1099")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置 JNDI 数据源的一些定制信息，以分号分隔。 ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#jndicontextcustom=java.naming.factory.url.pkgs;org.jboss.naming:org.jnp.interfaces")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 是否开启日志过滤 默认false， 这项配置是否生效前提是配置了 include/exclude/sqlexpression")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#filter=false")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 过滤 Log 时所包含的表名列表，以逗号分隔 默认为空")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#include=")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 过滤 Log 时所排除的表名列表，以逗号分隔 默认为空")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#exclude=")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 过滤 Log 时的 SQL 正则表达式名称  默认为空")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#sqlexpression=")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#显示指定过滤 Log 时排队的分类列表，取值: error, info, batch, debug, statement,")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#commit, rollback, result and resultset are valid values")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# (默认 info,debug,result,resultset,batch)")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#excludecategories=info,debug,result,resultset,batch")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 是否过滤二进制字段")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# (default is false)")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#excludebinary=false")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# P6Log 模块执行时间设置，整数值 (以毫秒为单位)，只有当超过这个时间才进行记录 Log。 默认为0")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#executionThreshold=")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# P6Outage 模块是否记录较长时间运行的语句 默认false")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# outagedetection=true|false")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# P6Outage 模块执行时间设置，整数值 （以秒为单位)），只有当超过这个时间才进行记录 Log。 默认30s")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# outagedetectioninterval=integer time (seconds)")]),t._v("\n")])])]),a("h2",{attrs:{id:"参考文章"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[t._v("#")]),t._v(" 参考文章")]),t._v(" "),a("p",[a("a",{attrs:{href:"http://www.kailing.pub/article/index/arcid/265.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("spring boot集成p6spy的最佳实践-p6spy-spring-boot-starter"),a("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=e.exports}}]);